const{AbortException:t,AnnotationEditorLayer:e,AnnotationEditorParamsType:i,AnnotationEditorType:n,AnnotationEditorUIManager:s,AnnotationLayer:a,AnnotationMode:r,AnnotationType:o,build:l,ColorPicker:d,createValidAbsoluteUrl:h,DOMSVGFactory:c,DrawLayer:u,FeatureTest:g,fetchData:p,getDocument:m,getFilenameFromUrl:f,getPdfFilenameFromUrl:b,getUuid:v,getXfaPageViewport:w,GlobalWorkerOptions:y,ImageKind:C,InvalidPDFException:P,isDataScheme:S,isPdfFile:E,isValidExplicitDest:_,MathClamp:x,noContextMenu:T,normalizeUnicode:A,OPS:L,OutputScale:I,PasswordResponses:M,PDFDataRangeTransport:k,PDFDateString:B,PDFWorker:D,PermissionFlag:N,PixelsPerInch:V,RenderingCancelledException:O,ResponseException:j,setLayerDimensions:F,shadow:R,SignatureExtractor:U,stopEvent:H,SupportedImageMimeTypes:z,TextLayer:W,TouchManager:$,updateUrlHash:G,Util:X,VerbosityLevel:Z,version:K,XfaLayer:q}=globalThis.pdfjsLib,Y="auto",Q={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},J=0,tt=1,et=2,it=3,nt=-1,st=0,at=1,rt=2,ot=3,lt=4,dt=0,ht=1,ct=2,ut={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},gt={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2},pt=0,mt=1,ft=/\bprint\s*\(/;function bt(t,e,i=!1){let n=t.offsetParent;if(!n)return;let s=t.offsetTop+t.clientTop,a=t.offsetLeft+t.clientLeft;for(;n.clientHeight===n.scrollHeight&&n.clientWidth===n.scrollWidth||i&&(n.classList.contains("markedContent")||"hidden"===getComputedStyle(n).overflow);)if(s+=n.offsetTop,a+=n.offsetLeft,n=n.offsetParent,!n)return;e&&(void 0!==e.top&&(s+=e.top),void 0!==e.left&&(a+=e.left,n.scrollLeft=a)),n.scrollTop=s}function vt(t,e,i=void 0){const n=function(i){a||(a=window.requestAnimationFrame((function(){a=null;const i=t.scrollLeft,n=s.lastX;i!==n&&(s.right=i>n),s.lastX=i;const r=t.scrollTop,o=s.lastY;r!==o&&(s.down=r>o),s.lastY=r,e(s)})))},s={right:!0,down:!0,lastX:t.scrollLeft,lastY:t.scrollTop,_eventHandler:n};let a=null;return t.addEventListener("scroll",n,{useCapture:!0,signal:i}),i?.addEventListener("abort",(()=>window.cancelAnimationFrame(a)),{once:!0}),s}function wt(t){const e=new Map;for(const[i,n]of new URLSearchParams(t))e.set(i.toLowerCase(),n);return e}const yt=/[\x00-\x1F]/g;function Ct(t,e=!1){return yt.test(t)?e?t.replaceAll(yt,(t=>"\0"===t?"":" ")):t.replaceAll("\0",""):t}function Pt(t,e,i=0){let n=i,s=t.length-1;if(s<0||!e(t[s]))return t.length;if(e(t[n]))return n;for(;n<s;){const i=n+s>>1;e(t[i])?s=i:n=i+1}return n}function St(t){if(Math.floor(t)===t)return[t,1];const e=1/t;if(e>8)return[1,8];if(Math.floor(e)===e)return[1,e];const i=t>1?e:t;let n,s=0,a=1,r=1,o=1;for(;;){const t=s+r,e=a+o;if(e>8)break;i<=t/e?(r=t,o=e):(s=t,a=e)}return n=i-s/a<r/o-i?i===t?[s,a]:[a,s]:i===t?[r,o]:[o,r],n}function Et(t,e){return t-t%e}function _t({view:t,userUnit:e,rotate:i}){const[n,s,a,r]=t,o=i%180!=0,l=(a-n)/72*e,d=(r-s)/72*e;return{width:o?d:l,height:o?l:d}}function xt({scrollEl:t,views:e,sortByVisibility:i=!1,horizontal:n=!1,rtl:s=!1}){const a=t.scrollTop,r=a+t.clientHeight,o=t.scrollLeft,l=o+t.clientWidth;const d=[],h=new Set,c=e.length;let u=Pt(e,n?function(t){const e=t.div,i=e.offsetLeft+e.clientLeft,n=i+e.clientWidth;return s?i<l:n>o}:function(t){const e=t.div;return e.offsetTop+e.clientTop+e.clientHeight>a});u>0&&u<c&&!n&&(u=function(t,e,i){if(t<2)return t;let n=e[t].div,s=n.offsetTop+n.clientTop;s>=i&&(n=e[t-1].div,s=n.offsetTop+n.clientTop);for(let i=t-2;i>=0&&(n=e[i].div,!(n.offsetTop+n.clientTop+n.clientHeight<=s));--i)t=i;return t}(u,e,a));let g=n?l:-1;for(let t=u;t<c;t++){const i=e[t],s=i.div,c=s.offsetLeft+s.clientLeft,u=s.offsetTop+s.clientTop,p=s.clientWidth,m=s.clientHeight,f=c+p,b=u+m;if(-1===g)b>=r&&(g=b);else if((n?c:u)>g)break;if(b<=a||u>=r||f<=o||c>=l)continue;const v=Math.max(0,a-u),w=Math.max(0,o-c),y=v+Math.max(0,b-r),C=(p-(w+Math.max(0,f-l)))/p,P=(m-y)/m*C*100|0;d.push({id:i.id,x:c,y:u,visibleArea:100===P?null:{minX:w,minY:v,maxX:Math.min(f,l)-c,maxY:Math.min(b,r)-u},view:i,percent:P,widthPercent:100*C|0}),h.add(i.id)}const p=d[0],m=d.at(-1);return i&&d.sort((function(t,e){const i=t.percent-e.percent;return Math.abs(i)>.001?-i:t.id-e.id})),{first:p,last:m,views:d,ids:h}}function Tt(t){let e=Math.hypot(t.deltaX,t.deltaY);const i=Math.atan2(t.deltaY,t.deltaX);return-.25*Math.PI<i&&i<.75*Math.PI&&(e=-e),e}function At(t){return Number.isInteger(t)&&t%90==0}function Lt(t){return Number.isInteger(t)&&Object.values(ut).includes(t)&&t!==ut.UNKNOWN}function It(t){return Number.isInteger(t)&&Object.values(gt).includes(t)&&t!==gt.UNKNOWN}function Mt(t){return t.width<=t.height}const kt=new Promise((function(t){window.requestAnimationFrame(t)})),Bt=document.documentElement.style;class Dt{#t=null;#e=null;#i=0;#n=null;#s=!0;constructor(t){this.#t=t.classList,this.#n=t.style}get percent(){return this.#i}set percent(t){this.#i=x(t,0,100),isNaN(t)?this.#t.add("indeterminate"):(this.#t.remove("indeterminate"),this.#n.setProperty("--progressBar-percent",`${this.#i}%`))}setWidth(t){if(!t)return;const e=t.parentNode.offsetWidth-t.offsetWidth;e>0&&this.#n.setProperty("--progressBar-end-offset",`${e}px`)}setDisableAutoFetch(t=5e3){100===this.#i||isNaN(this.#i)||(this.#e&&clearTimeout(this.#e),this.show(),this.#e=setTimeout((()=>{this.#e=null,this.hide()}),t))}hide(){this.#s&&(this.#s=!1,this.#t.add("hidden"))}show(){this.#s||(this.#s=!0,this.#t.remove("hidden"))}}function Nt(){let t=document,e=t.activeElement||t.querySelector(":focus");for(;e?.shadowRoot;)t=e.shadowRoot,e=t.activeElement||t.querySelector(":focus");return e}function Vt(t){let e=ut.VERTICAL,i=gt.NONE;switch(t){case"SinglePage":e=ut.PAGE;break;case"OneColumn":break;case"TwoPageLeft":e=ut.PAGE;case"TwoColumnLeft":i=gt.ODD;break;case"TwoPageRight":e=ut.PAGE;case"TwoColumnRight":i=gt.EVEN}return{scrollMode:e,spreadMode:i}}function Ot(t,e,i=null){t.classList.toggle("toggled",e),t.setAttribute("aria-checked",e),i?.classList.toggle("hidden",!e)}function jt(t,e,i=null){t.classList.toggle("toggled",e),t.setAttribute("aria-expanded",e),i?.classList.toggle("hidden",!e)}const Ft=function(){const t=document.createElement("div");return t.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)","calc(1320px)"===t.style.width?Math.fround:t=>t}();{var Rt=new Map;const{maxTouchPoints:t,platform:e,userAgent:i}=navigator,n=/Android/.test(i);(/\b(iPad|iPhone|iPod)(?=;)/.test(i)||"MacIntel"===e&&t>1||n)&&Rt.set("maxCanvasPixels",5242880),n&&Rt.set("useSystemFonts",!1)}const Ut=1,Ht=2,zt=4,Wt=8,$t=16,Gt=128,Xt={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},Zt={allowedGlobalEvents:{value:null,kind:Ut},canvasMaxAreaInBytes:{value:-1,kind:Ut+zt},isInAutomation:{value:!1,kind:Ut},localeProperties:{value:{lang:navigator.language||"en-US"},kind:Ut},maxCanvasDim:{value:32767,kind:Ut+Ht},nimbusDataStr:{value:"",kind:Ut},supportsCaretBrowsingMode:{value:!1,kind:Ut},supportsDocumentFonts:{value:!0,kind:Ut},supportsIntegratedFind:{value:!1,kind:Ut},supportsMouseWheelZoomCtrlKey:{value:!0,kind:Ut},supportsMouseWheelZoomMetaKey:{value:!0,kind:Ut},supportsPinchToZoom:{value:!0,kind:Ut},supportsPrinting:{value:!0,kind:Ut},toolbarDensity:{value:0,kind:Ut+$t},altTextLearnMoreUrl:{value:"",kind:Ht+Gt},annotationEditorMode:{value:15,kind:Ht+Gt},annotationMode:{value:2,kind:Ht+Gt},capCanvasAreaFactor:{value:200,kind:Ht+Gt},cursorToolOnLoad:{value:0,kind:Ht+Gt},debuggerSrc:{value:"./debugger.mjs",kind:Ht},defaultZoomDelay:{value:400,kind:Ht+Gt},defaultZoomValue:{value:"",kind:Ht+Gt},disableHistory:{value:!1,kind:Ht},disablePageLabels:{value:!1,kind:Ht+Gt},enableAltText:{value:!0,kind:Ht+Gt},enableAltTextModelDownload:{value:!0,kind:Ht+Gt+$t},enableAutoLinking:{value:!0,kind:Ht+Gt},enableDetailCanvas:{value:!0,kind:Ht},enableGuessAltText:{value:!0,kind:Ht+Gt+$t},enableHighlightFloatingButton:{value:!0,kind:Ht+Gt},enableNewAltTextWhenAddingImage:{value:!0,kind:Ht+Gt},enablePermissions:{value:!1,kind:Ht+Gt},enablePrintAutoRotate:{value:!0,kind:Ht+Gt},enableScripting:{value:!0,kind:Ht+Gt},enableSignatureEditor:{value:!1,kind:Ht+Gt},enableUpdatedAddImage:{value:!1,kind:Ht+Gt},externalLinkRel:{value:"noopener noreferrer nofollow",kind:Ht},externalLinkTarget:{value:0,kind:Ht+Gt},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:Ht+Gt},historyUpdateUrl:{value:!1,kind:Ht+Gt},ignoreDestinationZoom:{value:!1,kind:Ht+Gt},imageResourcesPath:{value:"./images/",kind:Ht},maxCanvasPixels:{value:2**25,kind:Ht},minDurationToUpdateCanvas:{value:500,kind:Ht},forcePageColors:{value:!1,kind:Ht+Gt},pageColorsBackground:{value:"Canvas",kind:Ht+Gt},pageColorsForeground:{value:"CanvasText",kind:Ht+Gt},pdfBugEnabled:{value:!1,kind:Ht+Gt},printResolution:{value:150,kind:Ht},sidebarViewOnLoad:{value:-1,kind:Ht+Gt},scrollModeOnLoad:{value:-1,kind:Ht+Gt},spreadModeOnLoad:{value:-1,kind:Ht+Gt},textLayerMode:{value:1,kind:Ht+Gt},viewerCssTheme:{value:0,kind:Ht+Gt},viewOnLoad:{value:0,kind:Ht+Gt},cMapPacked:{value:!0,kind:zt},cMapUrl:{value:"../web/cmaps/",kind:zt},disableAutoFetch:{value:!1,kind:zt+Gt},disableFontFace:{value:!1,kind:zt+Gt},disableRange:{value:!1,kind:zt+Gt},disableStream:{value:!1,kind:zt+Gt},docBaseUrl:{value:"",kind:zt},enableHWA:{value:!0,kind:zt+Ht+Gt},enableXfa:{value:!0,kind:zt+Gt},fontExtraProperties:{value:!1,kind:zt},iccUrl:{value:"../web/iccs/",kind:zt},isEvalSupported:{value:!0,kind:zt},isOffscreenCanvasSupported:{value:!0,kind:zt},maxImageSize:{value:-1,kind:zt},pdfBug:{value:!1,kind:zt},standardFontDataUrl:{value:"../web/standard_fonts/",kind:zt},useSystemFonts:{value:void 0,kind:zt,type:Xt.BOOLEAN+Xt.UNDEFINED},verbosity:{value:1,kind:zt},wasmUrl:{value:"../web/wasm/",kind:zt},workerPort:{value:null,kind:Wt},workerSrc:{value:"../build/pdf.worker.mjs",kind:Wt}};Zt.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:Ht},Zt.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:Ht},Zt.enableFakeMLManager={value:!0,kind:Ht},Zt.disablePreferences={value:!1,kind:Ht};class Kt{static eventBus;static#a=new Map;static{for(const t in Zt)this.#a.set(t,Zt[t].value);for(const[t,e]of Rt)this.#a.set(t,e);this._hasInvokedSet=!1,this._checkDisablePreferences=()=>!!this.get("disablePreferences")||(this._hasInvokedSet,!1)}static get(t){return this.#a.get(t)}static getAll(t=null,e=!1){const i=Object.create(null);for(const n in Zt){const s=Zt[n];(!t||t&s.kind)&&(i[n]=e?s.value:this.#a.get(n))}return i}static set(t,e){this.setAll({[t]:e})}static setAll(t,e=!1){let i;this._hasInvokedSet||=!0;for(const n in t){const s=Zt[n],a=t[n];if(!s||!(typeof a==typeof s.value||Xt[(typeof a).toUpperCase()]&s.type))continue;const{kind:r}=s;(!e||r&Ut||r&Gt)&&(this.eventBus&&r&$t&&(i||=new Map).set(n,a),this.#a.set(n,a))}if(i)for(const[t,e]of i)this.eventBus.dispatch(t.toLowerCase(),{source:this,value:e})}}const qt={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};class Yt{externalLinkEnabled=!0;constructor({eventBus:t,externalLinkTarget:e=null,externalLinkRel:i=null,ignoreDestinationZoom:n=!1}={}){this.eventBus=t,this.externalLinkTarget=e,this.externalLinkRel=i,this._ignoreDestinationZoom=n,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(t,e=null){this.baseUrl=e,this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setHistory(t){this.pdfHistory=t}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(t){this.pdfDocument&&(this.pdfViewer.currentPageNumber=t)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(t){this.pdfDocument&&(this.pdfViewer.pagesRotation=t)}get isInPresentationMode(){return!!this.pdfDocument&&this.pdfViewer.isInPresentationMode}async goToDestination(t){if(!this.pdfDocument)return;let e,i,n;if("string"==typeof t?(e=t,i=await this.pdfDocument.getDestination(t)):(e=null,i=await t),!Array.isArray(i))return;const[s]=i;if(s&&"object"==typeof s){if(n=this.pdfDocument.cachedPageNumber(s),!n)try{n=await this.pdfDocument.getPageIndex(s)+1}catch{return}}else Number.isInteger(s)&&(n=s+1);!n||n<1||n>this.pagesCount||(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:e,explicitDest:i,pageNumber:n})),this.pdfViewer.scrollPageIntoView({pageNumber:n,destArray:i,ignoreDestinationZoom:this._ignoreDestinationZoom}))}goToPage(t){if(!this.pdfDocument)return;const e="string"==typeof t&&this.pdfViewer.pageLabelToPageNumber(t)||0|t;Number.isInteger(e)&&e>0&&e<=this.pagesCount&&(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(e)),this.pdfViewer.scrollPageIntoView({pageNumber:e}))}addLinkAttributes(t,e,i=!1){if(!e||"string"!=typeof e)throw new Error('A valid "url" parameter must provided.');const n=i?qt.BLANK:this.externalLinkTarget,s=this.externalLinkRel;this.externalLinkEnabled?t.href=t.title=e:(t.href="",t.title=`Disabled: ${e}`,t.onclick=()=>!1);let a="";switch(n){case qt.NONE:break;case qt.SELF:a="_self";break;case qt.BLANK:a="_blank";break;case qt.PARENT:a="_parent";break;case qt.TOP:a="_top"}t.target=a,t.rel="string"==typeof s?s:"noopener noreferrer nofollow"}getDestinationHash(t){if("string"==typeof t){if(t.length>0)return this.getAnchorUrl("#"+escape(t))}else if(Array.isArray(t)){const e=JSON.stringify(t);if(e.length>0)return this.getAnchorUrl("#"+escape(e))}return this.getAnchorUrl("")}getAnchorUrl(t){return this.baseUrl?this.baseUrl+t:t}setHash(t){if(!this.pdfDocument)return;let e,i;if(t.includes("=")){const n=wt(t);if(n.has("search")){const t=n.get("search").replaceAll('"',""),e="true"===n.get("phrase");this.eventBus.dispatch("findfromurlhash",{source:this,query:e?t:t.match(/\S+/g)})}if(n.has("page")&&(e=0|n.get("page")||1),n.has("zoom")){const t=n.get("zoom").split(","),e=t[0],s=parseFloat(e);e.includes("Fit")?"Fit"===e||"FitB"===e?i=[null,{name:e}]:"FitH"===e||"FitBH"===e||"FitV"===e||"FitBV"===e?i=[null,{name:e},t.length>1?0|t[1]:null]:"FitR"===e&&(5!==t.length||(i=[null,{name:e},0|t[1],0|t[2],0|t[3],0|t[4]])):i=[null,{name:"XYZ"},t.length>1?0|t[1]:null,t.length>2?0|t[2]:null,s?s/100:e]}return i?this.pdfViewer.scrollPageIntoView({pageNumber:e||this.page,destArray:i,allowNegativeOffset:!0}):e&&(this.page=e),n.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:n.get("pagemode")}),void(n.has("nameddest")&&this.goToDestination(n.get("nameddest")))}i=unescape(t);try{i=JSON.parse(i),Array.isArray(i)||(i=i.toString())}catch{}("string"==typeof i||_(i))&&this.goToDestination(i)}executeNamedAction(t){if(this.pdfDocument){switch(t){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1}this.eventBus.dispatch("namedaction",{source:this,action:t})}}async executeSetOCGState(t){if(!this.pdfDocument)return;const e=this.pdfDocument,i=await this.pdfViewer.optionalContentConfigPromise;e===this.pdfDocument&&(i.setOCGState(t),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(i))}}class Qt extends Yt{setDocument(t,e=null){}}const Jt="event",te="timeout";async function ee({target:t,name:e,delay:i=0}){if("object"!=typeof t||!e||"string"!=typeof e||!(Number.isInteger(i)&&i>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");const{promise:n,resolve:s}=Promise.withResolvers(),a=new AbortController;function r(t){a.abort(),clearTimeout(o),s(t)}t[t instanceof ie?"_on":"addEventListener"](e,r.bind(null,Jt),{signal:a.signal});const o=setTimeout(r.bind(null,te),i);return n}class ie{#r=Object.create(null);on(t,e,i=null){this._on(t,e,{external:!0,once:i?.once,signal:i?.signal})}off(t,e,i=null){this._off(t,e)}dispatch(t,e){const i=this.#r[t];if(!i||0===i.length)return;let n;for(const{listener:s,external:a,once:r}of i.slice(0))r&&this._off(t,s),a?(n||=[]).push(s):s(e);if(n){for(const t of n)t(e);n=null}}_on(t,e,i=null){let n=null;if(i?.signal instanceof AbortSignal){const{signal:s}=i;if(s.aborted)return;const a=()=>this._off(t,e);n=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}(this.#r[t]||=[]).push({listener:e,external:!0===i?.external,once:!0===i?.once,rmAbort:n})}_off(t,e,i=null){const n=this.#r[t];if(n)for(let t=0,i=n.length;t<i;t++){const i=n[t];if(i.listener===e)return i.rmAbort?.(),void n.splice(t,1)}}}class ne{updateFindControlState(t){}updateFindMatchesCount(t){}initPassiveLoading(){}reportTelemetry(t){}async createL10n(){throw new Error("Not implemented: createL10n")}createScripting(){throw new Error("Not implemented: createScripting")}createSignatureStorage(){throw new Error("Not implemented: createSignatureStorage")}updateEditorStates(t){throw new Error("Not implemented: updateEditorStates")}dispatchGlobalEvent(t){}}class se{#o=Object.freeze({altTextLearnMoreUrl:"",annotationEditorMode:15,annotationMode:2,capCanvasAreaFactor:200,cursorToolOnLoad:0,defaultZoomDelay:400,defaultZoomValue:"",disablePageLabels:!1,enableAltText:!0,enableAltTextModelDownload:!0,enableAutoLinking:!0,enableGuessAltText:!0,enableHighlightFloatingButton:!0,enableNewAltTextWhenAddingImage:!0,enablePermissions:!1,enablePrintAutoRotate:!0,enableScripting:!0,enableSignatureEditor:!1,enableUpdatedAddImage:!1,externalLinkTarget:0,highlightEditorColors:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",historyUpdateUrl:!1,ignoreDestinationZoom:!1,forcePageColors:!1,pageColorsBackground:"Canvas",pageColorsForeground:"CanvasText",pdfBugEnabled:!1,sidebarViewOnLoad:-1,scrollModeOnLoad:-1,spreadModeOnLoad:-1,textLayerMode:1,viewerCssTheme:0,viewOnLoad:0,disableAutoFetch:!1,disableFontFace:!1,disableRange:!1,disableStream:!1,enableHWA:!0,enableXfa:!0});#l=null;constructor(){this.#l=this._readFromStorage(this.#o).then((({browserPrefs:t,prefs:e})=>{Kt._checkDisablePreferences()||Kt.setAll({...t,...e},!0)}))}async _writeToStorage(t){throw new Error("Not implemented: _writeToStorage")}async _readFromStorage(t){throw new Error("Not implemented: _readFromStorage")}async reset(){await this.#l,Kt.setAll(this.#o,!0),await this._writeToStorage(this.#o)}async set(t,e){await this.#l,Kt.setAll({[t]:e},!0),await this._writeToStorage(Kt.getAll(Gt))}async get(t){return await this.#l,Kt.get(t)}get initializedPromise(){return this.#l}}class ae{constructor(t){this.value=t}valueOf(){return this.value}}class re extends ae{constructor(t="???"){super(t)}toString(t){return`{${this.value}}`}}class oe extends ae{constructor(t,e={}){super(t),this.opts=e}toString(t){if(t)try{return t.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(e){t.reportError(e)}return this.value.toString(10)}}class le extends ae{static supportsValue(t){if("number"==typeof t)return!0;if(t instanceof Date)return!0;if(t instanceof ae)return le.supportsValue(t.valueOf());if("Temporal"in globalThis){const e=globalThis.Temporal;if(t instanceof e.Instant||t instanceof e.PlainDateTime||t instanceof e.PlainDate||t instanceof e.PlainMonthDay||t instanceof e.PlainTime||t instanceof e.PlainYearMonth)return!0}return!1}constructor(t,e={}){t instanceof le?(e={...t.opts,...e},t=t.value):t instanceof ae&&(t=t.valueOf()),"object"==typeof t&&"calendarId"in t&&void 0===e.calendar&&(e={...e,calendar:t.calendarId}),super(t),this.opts=e}[Symbol.toPrimitive](t){return"string"===t?this.toString():this.toNumber()}toNumber(){const t=this.value;if("number"==typeof t)return t;if(t instanceof Date)return t.getTime();if("epochMilliseconds"in t)return t.epochMilliseconds;if("toZonedDateTime"in t)return t.toZonedDateTime("UTC").epochMilliseconds;throw new TypeError("Unwrapping a non-number value as a number")}toString(t){if(t)try{return t.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(e){t.reportError(e)}return"number"==typeof this.value||this.value instanceof Date?new Date(this.value).toISOString():this.value.toString()}}function de(t,e,i){if(i===e)return!0;if(i instanceof oe&&e instanceof oe&&i.value===e.value)return!0;if(e instanceof oe&&"string"==typeof i){if(i===t.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value))return!0}return!1}function he(t,e,i){return e[i]?pe(t,e[i].value):(t.reportError(new RangeError("No default")),new re)}function ce(t,e){const i=[],n=Object.create(null);for(const s of e)"narg"===s.type?n[s.name]=ue(t,s.value):i.push(ue(t,s));return{positional:i,named:n}}function ue(t,e){switch(e.type){case"str":return e.value;case"num":return new oe(e.value,{minimumFractionDigits:e.precision});case"var":return function(t,{name:e}){let i;if(t.params){if(!Object.prototype.hasOwnProperty.call(t.params,e))return new re(`$${e}`);i=t.params[e]}else{if(!t.args||!Object.prototype.hasOwnProperty.call(t.args,e))return t.reportError(new ReferenceError(`Unknown variable: $${e}`)),new re(`$${e}`);i=t.args[e]}if(i instanceof ae)return i;switch(typeof i){case"string":return i;case"number":return new oe(i);case"object":if(le.supportsValue(i))return new le(i);default:return t.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof i}`)),new re(`$${e}`)}}(t,e);case"mesg":return function(t,{name:e,attr:i}){const n=t.bundle._messages.get(e);if(!n)return t.reportError(new ReferenceError(`Unknown message: ${e}`)),new re(e);if(i){const s=n.attributes[i];return s?pe(t,s):(t.reportError(new ReferenceError(`Unknown attribute: ${i}`)),new re(`${e}.${i}`))}if(n.value)return pe(t,n.value);return t.reportError(new ReferenceError(`No value: ${e}`)),new re(e)}(t,e);case"term":return function(t,{name:e,attr:i,args:n}){const s=`-${e}`,a=t.bundle._terms.get(s);if(!a)return t.reportError(new ReferenceError(`Unknown term: ${s}`)),new re(s);if(i){const e=a.attributes[i];if(e){t.params=ce(t,n).named;const i=pe(t,e);return t.params=null,i}return t.reportError(new ReferenceError(`Unknown attribute: ${i}`)),new re(`${s}.${i}`)}t.params=ce(t,n).named;const r=pe(t,a.value);return t.params=null,r}(t,e);case"func":return function(t,{name:e,args:i}){let n=t.bundle._functions[e];if(!n)return t.reportError(new ReferenceError(`Unknown function: ${e}()`)),new re(`${e}()`);if("function"!=typeof n)return t.reportError(new TypeError(`Function ${e}() is not callable`)),new re(`${e}()`);try{let e=ce(t,i);return n(e.positional,e.named)}catch(i){return t.reportError(i),new re(`${e}()`)}}(t,e);case"select":return function(t,{selector:e,variants:i,star:n}){let s=ue(t,e);if(s instanceof re)return he(t,i,n);for(const e of i){if(de(t,s,ue(t,e.key)))return pe(t,e.value)}return he(t,i,n)}(t,e);default:return new re}}function ge(t,e){if(t.dirty.has(e))return t.reportError(new RangeError("Cyclic reference")),new re;t.dirty.add(e);const i=[],n=t.bundle._useIsolating&&e.length>1;for(const s of e)if("string"!=typeof s){if(t.placeables++,t.placeables>100)throw t.dirty.delete(e),new RangeError(`Too many placeables expanded: ${t.placeables}, max allowed is 100`);n&&i.push("⁨"),i.push(ue(t,s).toString(t)),n&&i.push("⁩")}else i.push(t.bundle._transform(s));return t.dirty.delete(e),i.join("")}function pe(t,e){return"string"==typeof e?t.bundle._transform(e):ge(t,e)}class me{constructor(t,e,i){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=t,this.errors=e,this.args=i}reportError(t){if(!(this.errors&&t instanceof Error))throw t;this.errors.push(t)}memoizeIntlObject(t,e){let i=this.bundle._intls.get(t);i||(i={},this.bundle._intls.set(t,i));let n=JSON.stringify(e);return i[n]||(i[n]=new t(this.bundle.locales,e)),i[n]}}function fe(t,e){const i=Object.create(null);for(const[n,s]of Object.entries(t))e.includes(n)&&(i[n]=s.valueOf());return i}const be=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function ve(t,e){let i=t[0];if(i instanceof re)return new re(`NUMBER(${i.valueOf()})`);if(i instanceof oe)return new oe(i.valueOf(),{...i.opts,...fe(e,be)});if(i instanceof le)return new oe(i.toNumber(),{...fe(e,be)});throw new TypeError("Invalid argument to NUMBER")}const we=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function ye(t,e){let i=t[0];if(i instanceof re)return new re(`DATETIME(${i.valueOf()})`);if(i instanceof le||i instanceof oe)return new le(i,fe(e,we));throw new TypeError("Invalid argument to DATETIME")}const Ce=new Map;class Pe{constructor(t,{functions:e,useIsolating:i=!0,transform:n=t=>t}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(t)?t:[t],this._functions={NUMBER:ve,DATETIME:ye,...e},this._useIsolating=i,this._transform=n,this._intls=function(t){const e=Array.isArray(t)?t.join(" "):t;let i=Ce.get(e);return void 0===i&&(i=new Map,Ce.set(e,i)),i}(t)}hasMessage(t){return this._messages.has(t)}getMessage(t){return this._messages.get(t)}addResource(t,{allowOverrides:e=!1}={}){const i=[];for(let n=0;n<t.body.length;n++){let s=t.body[n];if(s.id.startsWith("-")){if(!1===e&&this._terms.has(s.id)){i.push(new Error(`Attempt to override an existing term: "${s.id}"`));continue}this._terms.set(s.id,s)}else{if(!1===e&&this._messages.has(s.id)){i.push(new Error(`Attempt to override an existing message: "${s.id}"`));continue}this._messages.set(s.id,s)}}return i}formatPattern(t,e=null,i=null){if("string"==typeof t)return this._transform(t);let n=new me(this,i,e);try{return ge(n,t).toString(n)}catch(t){if(n.errors&&t instanceof Error)return n.errors.push(t),(new re).toString(n);throw t}}}const Se=/^(-?[a-zA-Z][\w-]*) *= */gm,Ee=/\.([a-zA-Z][\w-]*) *= */y,_e=/\*?\[/y,xe=/(-?[0-9]+(?:\.([0-9]+))?)/y,Te=/([a-zA-Z][\w-]*)/y,Ae=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,Le=/^[A-Z][A-Z0-9_-]*$/,Ie=/([^{}\n\r]+)/y,Me=/([^\\"\n\r]*)/y,ke=/\\([\\"])/y,Be=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,De=/^\n+/,Ne=/ +$/,Ve=/ *\r?\n/g,Oe=/( *)$/,je=/{\s*/y,Fe=/\s*}/y,Re=/\[\s*/y,Ue=/\s*] */y,He=/\s*\(\s*/y,ze=/\s*->\s*/y,We=/\s*:\s*/y,$e=/\s*,?\s*/y,Ge=/\s+/y;class Xe{constructor(t){this.body=[],Se.lastIndex=0;let e=0;for(;;){let i=Se.exec(t);if(null===i)break;e=Se.lastIndex;try{this.body.push(o(i[1]))}catch(t){if(t instanceof SyntaxError)continue;throw t}}function i(i){return i.lastIndex=e,i.test(t)}function n(i,n){if(t[e]===i)return e++,!0;if(n)throw new n(`Expected ${i}`);return!1}function s(t,n){if(i(t))return e=t.lastIndex,!0;if(n)throw new n(`Expected ${t.toString()}`);return!1}function a(i){i.lastIndex=e;let n=i.exec(t);if(null===n)throw new SyntaxError(`Expected ${i.toString()}`);return e=i.lastIndex,n}function r(t){return a(t)[1]}function o(t){let e=l(),n=function(){let t=Object.create(null);for(;i(Ee);){let e=r(Ee),i=l();if(null===i)throw new SyntaxError("Expected attribute value");t[e]=i}return t}();if(null===e&&0===Object.keys(n).length)throw new SyntaxError("Expected message value or attributes");return{id:t,value:e,attributes:n}}function l(){let n;if(i(Ie)&&(n=r(Ie)),"{"===t[e]||"}"===t[e])return d(n?[n]:[],1/0);let s=b();return s?n?d([n,s],s.length):(s.value=v(s.value,De),d([s],s.length)):n?v(n,Ne):null}function d(n=[],s){for(;;){if(i(Ie)){n.push(r(Ie));continue}if("{"===t[e]){n.push(h());continue}if("}"===t[e])throw new SyntaxError("Unbalanced closing brace");let a=b();if(!a)break;n.push(a),s=Math.min(s,a.length)}let a=n.length-1,o=n[a];"string"==typeof o&&(n[a]=v(o,Ne));let l=[];for(let t of n)t instanceof Ze&&(t=t.value.slice(0,t.value.length-s)),t&&l.push(t);return l}function h(){s(je,SyntaxError);let t=c();if(s(Fe))return t;if(s(ze)){let e=function(){let t,e=[],s=0;for(;i(_e);){n("*")&&(t=s);let i=g(),a=l();if(null===a)throw new SyntaxError("Expected variant value");e[s++]={key:i,value:a}}if(0===s)return null;if(void 0===t)throw new SyntaxError("Expected default variant");return{variants:e,star:t}}();return s(Fe,SyntaxError),{type:"select",selector:t,...e}}throw new SyntaxError("Unclosed placeable")}function c(){if("{"===t[e])return h();if(i(Ae)){let[,i,n,r=null]=a(Ae);if("$"===i)return{type:"var",name:n};if(s(He)){let a=function(){let i=[];for(;;){switch(t[e]){case")":return e++,i;case void 0:throw new SyntaxError("Unclosed argument list")}i.push(u()),s($e)}}();if("-"===i)return{type:"term",name:n,attr:r,args:a};if(Le.test(n))return{type:"func",name:n,args:a};throw new SyntaxError("Function names must be all upper-case")}return"-"===i?{type:"term",name:n,attr:r,args:[]}:{type:"mesg",name:n,attr:r}}return p()}function u(){let t=c();return"mesg"!==t.type?t:s(We)?{type:"narg",name:t.name,value:p()}:t}function g(){let t;return s(Re,SyntaxError),t=i(xe)?m():{type:"str",value:r(Te)},s(Ue,SyntaxError),t}function p(){if(i(xe))return m();if('"'===t[e])return function(){n('"',SyntaxError);let i="";for(;;){if(i+=r(Me),"\\"!==t[e]){if(n('"'))return{type:"str",value:i};throw new SyntaxError("Unclosed string literal")}i+=f()}}();throw new SyntaxError("Invalid expression")}function m(){let[,t,e=""]=a(xe),i=e.length;return{type:"num",value:parseFloat(t),precision:i}}function f(){if(i(ke))return r(ke);if(i(Be)){let[,t,e]=a(Be),i=parseInt(t||e,16);return i<=55295||57344<=i?String.fromCodePoint(i):"�"}throw new SyntaxError("Unknown escape sequence")}function b(){let i=e;switch(s(Ge),t[e]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return w(t.slice(i,e))}return" "===t[e-1]&&w(t.slice(i,e))}function v(t,e){return t.replace(e,"")}function w(t){let e=t.replace(Ve,"\n"),i=Oe.exec(t)[1].length;return new Ze(e,i)}}}class Ze{constructor(t,e){this.value=t,this.length=e}}const Ke=/<|&#?\w+;/,qe={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},Ye={"http://www.w3.org/1999/xhtml":{global:["title","aria-description","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function Qe(t,e){const{value:i}=e;if("string"==typeof i)if("title"===t.localName&&"http://www.w3.org/1999/xhtml"===t.namespaceURI)t.textContent=i;else if(Ke.test(i)){const e=t.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");e.innerHTML=i,function(t,e){for(const i of t.childNodes)if(i.nodeType!==i.TEXT_NODE)if(i.hasAttribute("data-l10n-name")){const n=ei(e,i);t.replaceChild(n,i)}else if(si(i)){const e=ii(i);t.replaceChild(e,i)}else t.replaceChild(ni(i),i);e.textContent="",e.appendChild(t)}(e.content,t)}else t.textContent=i;ti(e,t)}function Je(t,e){if(!t)return!1;for(let i of t)if(i.name===e)return!0;return!1}function ti(t,e){const i=e.hasAttribute("data-l10n-attrs")?e.getAttribute("data-l10n-attrs").split(",").map((t=>t.trim())):null;for(const n of Array.from(e.attributes))ai(n.name,e,i)&&!Je(t.attributes,n.name)&&e.removeAttribute(n.name);if(t.attributes)for(const n of Array.from(t.attributes))ai(n.name,e,i)&&e.getAttribute(n.name)!==n.value&&e.setAttribute(n.name,n.value)}function ei(t,e){const i=e.getAttribute("data-l10n-name"),n=t.querySelector(`[data-l10n-name="${i}"]`);if(!n)return ni(e);if(n.localName!==e.localName)return ni(e);t.removeChild(n);return ri(e,n.cloneNode(!1))}function ii(t){const e=t.ownerDocument.createElement(t.localName);return ri(t,e)}function ni(t){return t.ownerDocument.createTextNode(t.textContent)}function si(t){const e=qe[t.namespaceURI];return e&&e.includes(t.localName)}function ai(t,e,i=null){if(i&&i.includes(t))return!0;const n=Ye[e.namespaceURI];if(!n)return!1;const s=t.toLowerCase(),a=e.localName;if(n.global.includes(s))return!0;if(!n[a])return!1;if(n[a].includes(s))return!0;if("http://www.w3.org/1999/xhtml"===e.namespaceURI&&"input"===a&&"value"===s){const t=e.type.toLowerCase();if("submit"===t||"button"===t||"reset"===t)return!0}return!1}function ri(t,e){return e.textContent=t.textContent,ti(t,e),e}class oi extends Array{static from(t){return t instanceof this?t:new this(t)}}Symbol.iterator;class li extends oi{constructor(t){if(super(),Symbol.asyncIterator in Object(t))this.iterator=t[Symbol.asyncIterator]();else{if(!(Symbol.iterator in Object(t)))throw new TypeError("Argument must implement the iteration protocol.");this.iterator=t[Symbol.iterator]()}}[Symbol.asyncIterator](){const t=this;let e=0;return{next:async()=>(t.length<=e&&t.push(t.iterator.next()),t[e++])}}async touchNext(t=1){let e=0;for(;e++<t;){const t=this[this.length-1];if(t&&(await t).done)break;this.push(this.iterator.next())}return this[this.length-1]}}class di{constructor(t=[],e){this.resourceIds=t,this.generateBundles=e,this.onChange(!0)}addResourceIds(t,e=!1){return this.resourceIds.push(...t),this.onChange(e),this.resourceIds.length}removeResourceIds(t){return this.resourceIds=this.resourceIds.filter((e=>!t.includes(e))),this.onChange(),this.resourceIds.length}async formatWithFallback(t,e){const i=[];let n=!1;for await(const s of this.bundles){n=!0;const a=ui(e,s,t,i);if(0===a.size)break;if("undefined"!=typeof console){s.locales[0],Array.from(a).join(", ")}}return i}formatMessages(t){return this.formatWithFallback(t,ci)}formatValues(t){return this.formatWithFallback(t,hi)}async formatValue(t,e){const[i]=await this.formatValues([{id:t,args:e}]);return i}handleEvent(){this.onChange()}onChange(t=!1){this.bundles=li.from(this.generateBundles(this.resourceIds)),t&&this.bundles.touchNext(2)}}function hi(t,e,i,n){return i.value?t.formatPattern(i.value,n,e):null}function ci(t,e,i,n){const s={value:null,attributes:null};i.value&&(s.value=t.formatPattern(i.value,n,e));let a=Object.keys(i.attributes);if(a.length>0){s.attributes=new Array(a.length);for(let[r,o]of a.entries()){let a=t.formatPattern(i.attributes[o],n,e);s.attributes[r]={name:o,value:a}}}return s}function ui(t,e,i,n){const s=[],a=new Set;return i.forEach((({id:i,args:r},o)=>{if(void 0!==n[o])return;let l=e.getMessage(i);if(l){if(s.length=0,n[o]=t(e,s,l,r),s.length>0&&"undefined"!=typeof console){e.locales[0],s.join(", ")}}else a.add(i)})),a}const gi="data-l10n-id",pi="data-l10n-args",mi=`[${gi}]`;class fi extends di{constructor(t,e){super(t,e),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[gi,pi]}}onChange(t=!1){super.onChange(t),this.roots&&this.translateRoots()}setAttributes(t,e,i){return t.setAttribute(gi,e),i?t.setAttribute(pi,JSON.stringify(i)):t.removeAttribute(pi),t}getAttributes(t){return{id:t.getAttribute(gi),args:JSON.parse(t.getAttribute(pi)||null)}}connectRoot(t){for(const e of this.roots)if(e===t||e.contains(t)||t.contains(e))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==t.ownerDocument.defaultView)throw new Error("Cannot connect a root:\n          DOMLocalization already has a root from a different window.")}else this.windowElement=t.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver((t=>this.translateMutations(t)));this.roots.add(t),this.mutationObserver.observe(t,this.observerConfig)}disconnectRoot(t){return this.roots.delete(t),this.pauseObserving(),0===this.roots.size?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){const t=Array.from(this.roots);return Promise.all(t.map((t=>this.translateFragment(t))))}pauseObserving(){this.mutationObserver&&(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(const t of this.roots)this.mutationObserver.observe(t,this.observerConfig)}translateMutations(t){for(const e of t)switch(e.type){case"attributes":e.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(e.target);break;case"childList":for(const t of e.addedNodes)if(t.nodeType===t.ELEMENT_NODE)if(t.childElementCount)for(const e of this.getTranslatables(t))this.pendingElements.add(e);else t.hasAttribute(gi)&&this.pendingElements.add(t)}this.pendingElements.size>0&&null===this.pendingrAF&&(this.pendingrAF=this.windowElement.requestAnimationFrame((()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null})))}translateFragment(t){return this.translateElements(this.getTranslatables(t))}async translateElements(t){if(!t.length)return;const e=t.map(this.getKeysForElement),i=await this.formatMessages(e);return this.applyTranslations(t,i)}applyTranslations(t,e){this.pauseObserving();for(let i=0;i<t.length;i++)void 0!==e[i]&&Qe(t[i],e[i]);this.resumeObserving()}getTranslatables(t){const e=Array.from(t.querySelectorAll(mi));return"function"==typeof t.hasAttribute&&t.hasAttribute(gi)&&e.push(t),e}getKeysForElement(t){return{id:t.getAttribute(gi),args:JSON.parse(t.getAttribute(pi)||null)}}}class bi{#d;#h;#c;#u;constructor({lang:t,isRTL:e},i=null){this.#c=bi.#g(t),this.#u=i,this.#d=e??bi.#p(this.#c)?"rtl":"ltr"}_setL10n(t){this.#u=t}getLanguage(){return this.#c}getDirection(){return this.#d}async get(t,e=null,i){if(Array.isArray(t)){t=t.map((t=>({id:t})));return(await this.#u.formatMessages(t)).map((t=>t.value))}const n=await this.#u.formatMessages([{id:t,args:e}]);return n[0]?.value||i}async translate(t){(this.#h||=new Set).add(t);try{this.#u.connectRoot(t),await this.#u.translateRoots()}catch{}}async translateOnce(t){try{await this.#u.translateElements([t])}catch(t){}}async destroy(){if(this.#h){for(const t of this.#h)this.#u.disconnectRoot(t);this.#h.clear(),this.#h=null}this.#u.pauseObserving()}pause(){this.#u.pauseObserving()}resume(){this.#u.resumeObserving()}static#g(t){return{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[t=t?.toLowerCase()||"en-us"]||t}static#p(t){const e=t.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(e)}}function vi(){const{isAndroid:t,isLinux:e,isMac:i,isWindows:n}=g.platform;return e?"linux":n?"windows":i?"macos":t?"android":"other"}function wi(t,e){const i=new Xe(e),n=new Pe(t,{functions:{PLATFORM:vi}});return n.addResource(i).length,n}class yi extends bi{constructor(t){super({lang:t});const e=t?yi.#m.bind(yi,"en-us",this.getLanguage()):yi.#f.bind(yi,this.getLanguage());this._setL10n(new fi([],e))}static async*#m(t,e){const{baseURL:i,paths:n}=await this.#b(),s=[e];if(t!==e){const i=e.split("-",1)[0];i!==e&&s.push(i),s.push(t)}const a=s.map((t=>[t,this.#v(t,i,n)]));for(const[t,e]of a){const i=await e;i?yield i:"en-us"===t&&(yield this.#w(t))}}static async#v(t,e,i){const n=i[t];if(!n)return null;const s=new URL(n,e);return wi(t,await p(s,"text"))}static async#b(){try{const{href:t}=document.querySelector('link[type="application/l10n"]'),e=await p(t,"json");return{baseURL:t.substring(0,t.lastIndexOf("/")+1)||"./",paths:e}}catch{}return{baseURL:"./",paths:Object.create(null)}}static async*#f(t){yield this.#w(t)}static async#w(t){return wi(t,'pdfjs-previous-button =\n    .title = Previous Page\npdfjs-previous-button-label = Previous\npdfjs-next-button =\n    .title = Next Page\npdfjs-next-button-label = Next\npdfjs-page-input =\n    .title = Page\npdfjs-of-pages = of { $pagesCount }\npdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })\npdfjs-zoom-out-button =\n    .title = Zoom Out\npdfjs-zoom-out-button-label = Zoom Out\npdfjs-zoom-in-button =\n    .title = Zoom In\npdfjs-zoom-in-button-label = Zoom In\npdfjs-zoom-select =\n    .title = Zoom\npdfjs-presentation-mode-button =\n    .title = Switch to Presentation Mode\npdfjs-presentation-mode-button-label = Presentation Mode\npdfjs-open-file-button =\n    .title = Open File\npdfjs-open-file-button-label = Open\npdfjs-print-button =\n    .title = Print\npdfjs-print-button-label = Print\npdfjs-save-button =\n    .title = Save\npdfjs-save-button-label = Save\npdfjs-download-button =\n    .title = Download\npdfjs-download-button-label = Download\npdfjs-bookmark-button =\n    .title = Current Page (View URL from Current Page)\npdfjs-bookmark-button-label = Current Page\npdfjs-tools-button =\n    .title = Tools\npdfjs-tools-button-label = Tools\npdfjs-first-page-button =\n    .title = Go to First Page\npdfjs-first-page-button-label = Go to First Page\npdfjs-last-page-button =\n    .title = Go to Last Page\npdfjs-last-page-button-label = Go to Last Page\npdfjs-page-rotate-cw-button =\n    .title = Rotate Clockwise\npdfjs-page-rotate-cw-button-label = Rotate Clockwise\npdfjs-page-rotate-ccw-button =\n    .title = Rotate Counterclockwise\npdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise\npdfjs-cursor-text-select-tool-button =\n    .title = Enable Text Selection Tool\npdfjs-cursor-text-select-tool-button-label = Text Selection Tool\npdfjs-cursor-hand-tool-button =\n    .title = Enable Hand Tool\npdfjs-cursor-hand-tool-button-label = Hand Tool\npdfjs-scroll-page-button =\n    .title = Use Page Scrolling\npdfjs-scroll-page-button-label = Page Scrolling\npdfjs-scroll-vertical-button =\n    .title = Use Vertical Scrolling\npdfjs-scroll-vertical-button-label = Vertical Scrolling\npdfjs-scroll-horizontal-button =\n    .title = Use Horizontal Scrolling\npdfjs-scroll-horizontal-button-label = Horizontal Scrolling\npdfjs-scroll-wrapped-button =\n    .title = Use Wrapped Scrolling\npdfjs-scroll-wrapped-button-label = Wrapped Scrolling\npdfjs-spread-none-button =\n    .title = Do not join page spreads\npdfjs-spread-none-button-label = No Spreads\npdfjs-spread-odd-button =\n    .title = Join page spreads starting with odd-numbered pages\npdfjs-spread-odd-button-label = Odd Spreads\npdfjs-spread-even-button =\n    .title = Join page spreads starting with even-numbered pages\npdfjs-spread-even-button-label = Even Spreads\npdfjs-document-properties-button =\n    .title = Document Properties…\npdfjs-document-properties-button-label = Document Properties…\npdfjs-document-properties-file-name = File name:\npdfjs-document-properties-file-size = File size:\npdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)\npdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)\npdfjs-document-properties-title = Title:\npdfjs-document-properties-author = Author:\npdfjs-document-properties-subject = Subject:\npdfjs-document-properties-keywords = Keywords:\npdfjs-document-properties-creation-date = Creation Date:\npdfjs-document-properties-modification-date = Modification Date:\npdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }\npdfjs-document-properties-creator = Creator:\npdfjs-document-properties-producer = PDF Producer:\npdfjs-document-properties-version = PDF Version:\npdfjs-document-properties-page-count = Page Count:\npdfjs-document-properties-page-size = Page Size:\npdfjs-document-properties-page-size-unit-inches = in\npdfjs-document-properties-page-size-unit-millimeters = mm\npdfjs-document-properties-page-size-orientation-portrait = portrait\npdfjs-document-properties-page-size-orientation-landscape = landscape\npdfjs-document-properties-page-size-name-a-three = A3\npdfjs-document-properties-page-size-name-a-four = A4\npdfjs-document-properties-page-size-name-letter = Letter\npdfjs-document-properties-page-size-name-legal = Legal\npdfjs-document-properties-page-size-dimension-string = { $width } × { $height } { $unit } ({ $orientation })\npdfjs-document-properties-page-size-dimension-name-string = { $width } × { $height } { $unit } ({ $name }, { $orientation })\npdfjs-document-properties-linearized = Fast Web View:\npdfjs-document-properties-linearized-yes = Yes\npdfjs-document-properties-linearized-no = No\npdfjs-document-properties-close-button = Close\npdfjs-print-progress-message = Preparing document for printing…\npdfjs-print-progress-percent = { $progress }%\npdfjs-print-progress-close-button = Cancel\npdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.\npdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.\npdfjs-toggle-sidebar-button =\n    .title = Toggle Sidebar\npdfjs-toggle-sidebar-notification-button =\n    .title = Toggle Sidebar (document contains outline/attachments/layers)\npdfjs-toggle-sidebar-button-label = Toggle Sidebar\npdfjs-document-outline-button =\n    .title = Show Document Outline (double-click to expand/collapse all items)\npdfjs-document-outline-button-label = Document Outline\npdfjs-attachments-button =\n    .title = Show Attachments\npdfjs-attachments-button-label = Attachments\npdfjs-layers-button =\n    .title = Show Layers (double-click to reset all layers to the default state)\npdfjs-layers-button-label = Layers\npdfjs-thumbs-button =\n    .title = Show Thumbnails\npdfjs-thumbs-button-label = Thumbnails\npdfjs-current-outline-item-button =\n    .title = Find Current Outline Item\npdfjs-current-outline-item-button-label = Current Outline Item\npdfjs-findbar-button =\n    .title = Find in Document\npdfjs-findbar-button-label = Find\npdfjs-additional-layers = Additional Layers\npdfjs-thumb-page-title =\n    .title = Page { $page }\npdfjs-thumb-page-canvas =\n    .aria-label = Thumbnail of Page { $page }\npdfjs-find-input =\n    .title = Find\n    .placeholder = Find in document…\npdfjs-find-previous-button =\n    .title = Find the previous occurrence of the phrase\npdfjs-find-previous-button-label = Previous\npdfjs-find-next-button =\n    .title = Find the next occurrence of the phrase\npdfjs-find-next-button-label = Next\npdfjs-find-highlight-checkbox = Highlight All\npdfjs-find-match-case-checkbox-label = Match Case\npdfjs-find-match-diacritics-checkbox-label = Match Diacritics\npdfjs-find-entire-word-checkbox-label = Whole Words\npdfjs-find-reached-top = Reached top of document, continued from bottom\npdfjs-find-reached-bottom = Reached end of document, continued from top\npdfjs-find-match-count =\n    { $total ->\n        [one] { $current } of { $total } match\n       *[other] { $current } of { $total } matches\n    }\npdfjs-find-match-count-limit =\n    { $limit ->\n        [one] More than { $limit } match\n       *[other] More than { $limit } matches\n    }\npdfjs-find-not-found = Phrase not found\npdfjs-page-scale-width = Page Width\npdfjs-page-scale-fit = Page Fit\npdfjs-page-scale-auto = Automatic Zoom\npdfjs-page-scale-actual = Actual Size\npdfjs-page-scale-percent = { $scale }%\npdfjs-page-landmark =\n    .aria-label = Page { $page }\npdfjs-loading-error = An error occurred while loading the PDF.\npdfjs-invalid-file-error = Invalid or corrupted PDF file.\npdfjs-missing-file-error = Missing PDF file.\npdfjs-unexpected-response-error = Unexpected server response.\npdfjs-rendering-error = An error occurred while rendering the page.\npdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }\npdfjs-text-annotation-type =\n    .alt = [{ $type } Annotation]\npdfjs-password-label = Enter the password to open this PDF file.\npdfjs-password-invalid = Invalid password. Please try again.\npdfjs-password-ok-button = OK\npdfjs-password-cancel-button = Cancel\npdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.\npdfjs-editor-free-text-button =\n    .title = Text\npdfjs-editor-free-text-button-label = Text\npdfjs-editor-ink-button =\n    .title = Draw\npdfjs-editor-ink-button-label = Draw\npdfjs-editor-stamp-button =\n    .title = Add or edit images\npdfjs-editor-stamp-button-label = Add or edit images\npdfjs-editor-highlight-button =\n    .title = Highlight\npdfjs-editor-highlight-button-label = Highlight\npdfjs-highlight-floating-button1 =\n    .title = Highlight\n    .aria-label = Highlight\npdfjs-highlight-floating-button-label = Highlight\npdfjs-editor-signature-button =\n    .title = Add signature\npdfjs-editor-signature-button-label = Add signature\npdfjs-editor-highlight-editor =\n    .aria-label = Highlight editor\npdfjs-editor-ink-editor =\n    .aria-label = Drawing editor\npdfjs-editor-signature-editor1 =\n    .aria-description = Signature editor: { $description }\npdfjs-editor-stamp-editor =\n    .aria-label = Image editor\npdfjs-editor-remove-ink-button =\n    .title = Remove drawing\npdfjs-editor-remove-freetext-button =\n    .title = Remove text\npdfjs-editor-remove-stamp-button =\n    .title = Remove image\npdfjs-editor-remove-highlight-button =\n    .title = Remove highlight\npdfjs-editor-remove-signature-button =\n    .title = Remove signature\npdfjs-editor-free-text-color-input = Color\npdfjs-editor-free-text-size-input = Size\npdfjs-editor-ink-color-input = Color\npdfjs-editor-ink-thickness-input = Thickness\npdfjs-editor-ink-opacity-input = Opacity\npdfjs-editor-stamp-add-image-button =\n    .title = Add image\npdfjs-editor-stamp-add-image-button-label = Add image\npdfjs-editor-free-highlight-thickness-input = Thickness\npdfjs-editor-free-highlight-thickness-title =\n    .title = Change thickness when highlighting items other than text\npdfjs-editor-add-signature-container =\n    .aria-label = Signature controls and saved signatures\npdfjs-editor-signature-add-signature-button =\n    .title = Add new signature\npdfjs-editor-signature-add-signature-button-label = Add new signature\npdfjs-editor-add-saved-signature-button =\n    .title = Saved signature: { $description }\npdfjs-free-text2 =\n    .aria-label = Text Editor\n    .default-content = Start typing…\npdfjs-editor-alt-text-button =\n    .aria-label = Alt text\npdfjs-editor-alt-text-button-label = Alt text\npdfjs-editor-alt-text-edit-button =\n    .aria-label = Edit alt text\npdfjs-editor-alt-text-dialog-label = Choose an option\npdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people can’t see the image or when it doesn’t load.\npdfjs-editor-alt-text-add-description-label = Add a description\npdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.\npdfjs-editor-alt-text-mark-decorative-label = Mark as decorative\npdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.\npdfjs-editor-alt-text-cancel-button = Cancel\npdfjs-editor-alt-text-save-button = Save\npdfjs-editor-alt-text-decorative-tooltip = Marked as decorative\npdfjs-editor-alt-text-textarea =\n    .placeholder = For example, “A young man sits down at a table to eat a meal”\npdfjs-editor-resizer-top-left =\n    .aria-label = Top left corner — resize\npdfjs-editor-resizer-top-middle =\n    .aria-label = Top middle — resize\npdfjs-editor-resizer-top-right =\n    .aria-label = Top right corner — resize\npdfjs-editor-resizer-middle-right =\n    .aria-label = Middle right — resize\npdfjs-editor-resizer-bottom-right =\n    .aria-label = Bottom right corner — resize\npdfjs-editor-resizer-bottom-middle =\n    .aria-label = Bottom middle — resize\npdfjs-editor-resizer-bottom-left =\n    .aria-label = Bottom left corner — resize\npdfjs-editor-resizer-middle-left =\n    .aria-label = Middle left — resize\npdfjs-editor-highlight-colorpicker-label = Highlight color\npdfjs-editor-colorpicker-button =\n    .title = Change color\npdfjs-editor-colorpicker-dropdown =\n    .aria-label = Color choices\npdfjs-editor-colorpicker-yellow =\n    .title = Yellow\npdfjs-editor-colorpicker-green =\n    .title = Green\npdfjs-editor-colorpicker-blue =\n    .title = Blue\npdfjs-editor-colorpicker-pink =\n    .title = Pink\npdfjs-editor-colorpicker-red =\n    .title = Red\npdfjs-editor-highlight-show-all-button-label = Show all\npdfjs-editor-highlight-show-all-button =\n    .title = Show all\npdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)\npdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)\npdfjs-editor-new-alt-text-textarea =\n    .placeholder = Write your description here…\npdfjs-editor-new-alt-text-description = Short description for people who can’t see the image or when the image doesn’t load.\npdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.\npdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more\npdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically\npdfjs-editor-new-alt-text-not-now-button = Not now\npdfjs-editor-new-alt-text-error-title = Couldn’t create alt text automatically\npdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.\npdfjs-editor-new-alt-text-error-close-button = Close\npdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)\n    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)\npdfjs-editor-new-alt-text-added-button =\n    .aria-label = Alt text added\npdfjs-editor-new-alt-text-added-button-label = Alt text added\npdfjs-editor-new-alt-text-missing-button =\n    .aria-label = Missing alt text\npdfjs-editor-new-alt-text-missing-button-label = Missing alt text\npdfjs-editor-new-alt-text-to-review-button =\n    .aria-label = Review alt text\npdfjs-editor-new-alt-text-to-review-button-label = Review alt text\npdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }\npdfjs-image-alt-text-settings-button =\n    .title = Image alt text settings\npdfjs-image-alt-text-settings-button-label = Image alt text settings\npdfjs-editor-alt-text-settings-dialog-label = Image alt text settings\npdfjs-editor-alt-text-settings-automatic-title = Automatic alt text\npdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically\npdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who can’t see the image or when the image doesn’t load.\npdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)\npdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.\npdfjs-editor-alt-text-settings-delete-model-button = Delete\npdfjs-editor-alt-text-settings-download-model-button = Download\npdfjs-editor-alt-text-settings-downloading-model-button = Downloading…\npdfjs-editor-alt-text-settings-editor-title = Alt text editor\npdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image\npdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.\npdfjs-editor-alt-text-settings-close-button = Close\npdfjs-editor-undo-bar-message-highlight = Highlight removed\npdfjs-editor-undo-bar-message-freetext = Text removed\npdfjs-editor-undo-bar-message-ink = Drawing removed\npdfjs-editor-undo-bar-message-stamp = Image removed\npdfjs-editor-undo-bar-message-signature = Signature removed\npdfjs-editor-undo-bar-message-multiple =\n    { $count ->\n        [one] { $count } annotation removed\n       *[other] { $count } annotations removed\n    }\npdfjs-editor-undo-bar-undo-button =\n    .title = Undo\npdfjs-editor-undo-bar-undo-button-label = Undo\npdfjs-editor-undo-bar-close-button =\n    .title = Close\npdfjs-editor-undo-bar-close-button-label = Close\npdfjs-editor-add-signature-dialog-label = This modal allows the user to create a signature to add to a PDF document. The user can edit the name (which also serves as the alt text), and optionally save the signature for repeated use.\npdfjs-editor-add-signature-dialog-title = Add a signature\npdfjs-editor-add-signature-type-button = Type\n    .title = Type\npdfjs-editor-add-signature-draw-button = Draw\n    .title = Draw\npdfjs-editor-add-signature-image-button = Image\n    .title = Image\npdfjs-editor-add-signature-type-input =\n    .aria-label = Type your signature\n    .placeholder = Type your signature\npdfjs-editor-add-signature-draw-placeholder = Draw your signature\npdfjs-editor-add-signature-draw-thickness-range-label = Thickness\npdfjs-editor-add-signature-draw-thickness-range =\n    .title = Drawing thickness: { $thickness }\npdfjs-editor-add-signature-image-placeholder = Drag a file here to upload\npdfjs-editor-add-signature-image-browse-link =\n    { PLATFORM() ->\n        [macos] Or choose image files\n       *[other] Or browse image files\n    }\npdfjs-editor-add-signature-description-label = Description (alt text)\npdfjs-editor-add-signature-description-input =\n    .title = Description (alt text)\npdfjs-editor-add-signature-description-default-when-drawing = Signature\npdfjs-editor-add-signature-clear-button-label = Clear signature\npdfjs-editor-add-signature-clear-button =\n    .title = Clear signature\npdfjs-editor-add-signature-save-checkbox = Save signature\npdfjs-editor-add-signature-save-warning-message = You’ve reached the limit of 5 saved signatures. Remove one to save more.\npdfjs-editor-add-signature-image-upload-error-title = Couldn’t upload image\npdfjs-editor-add-signature-image-upload-error-description = Check your network connection or try another image.\npdfjs-editor-add-signature-error-close-button = Close\npdfjs-editor-add-signature-cancel-button = Cancel\npdfjs-editor-add-signature-add-button = Add\npdfjs-editor-delete-signature-button1 =\n    .title = Remove saved signature\npdfjs-editor-delete-signature-button-label1 = Remove saved signature\npdfjs-editor-add-signature-edit-button-label = Edit description\npdfjs-editor-edit-signature-dialog-title = Edit description\npdfjs-editor-edit-signature-update-button = Update')}}class Ci{constructor(t){this._ready=new Promise(((e,i)=>{import(t).then((t=>{e(t.QuickJSSandbox())})).catch(i)}))}async createSandbox(t){(await this._ready).create(t)}async dispatchEventInSandbox(t){const e=await this._ready;setTimeout((()=>e.dispatchEvent(t)),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}const Pi="pdfjs.signature";class Si{#y;#C=null;#P=null;constructor(t,e){this.#y=t,this.#P=e}#S(){localStorage.setItem(Pi,JSON.stringify(Object.fromEntries(this.#C)))}async getAll(){if(this.#P&&(window.addEventListener("storage",(({key:t})=>{t===Pi&&(this.#C=null,this.#y?.dispatch("storedsignatureschanged",{source:this}))}),{signal:this.#P}),this.#P=null),!this.#C){this.#C=new Map;const t=localStorage.getItem(Pi);if(t)for(const[e,i]of Object.entries(JSON.parse(t)))this.#C.set(e,i)}return this.#C}async isFull(){return 5===await this.size()}async size(){return(await this.getAll()).size}async create(t){if(await this.isFull())return null;const e=v();return this.#C.set(e,t),this.#S(),e}async delete(t){const e=await this.getAll();return!!e.has(t)&&(e.delete(t),this.#S(),!0)}}class Ei extends ne{async createL10n(){return new yi(Kt.get("localeProperties")?.lang)}createScripting(){return new Ci(Kt.get("sandboxBundleSrc"))}createSignatureStorage(t,e){return new Si(t,e)}}class _i{#E=this.#_.bind(this);#x;#T=null;#A;#L;#I;#M;#k;#B;#y;#D=!1;#N;#V=null;#O=null;#j;#F;#R=!1;#U=!1;#H;#z;#W;#$;#G;#X;#Z=null;constructor({descriptionContainer:t,dialog:e,imagePreview:i,cancelButton:n,disclaimer:s,notNowButton:a,saveButton:r,textarea:o,learnMore:l,errorCloseButton:d,createAutomaticallyButton:h,downloadModel:c,downloadModelDescription:u,title:g},p,m){this.#A=n,this.#x=h,this.#L=t,this.#I=e,this.#M=s,this.#z=a,this.#j=i,this.#$=o,this.#H=l,this.#G=g,this.#k=c,this.#B=u,this.#W=p,this.#y=m,e.addEventListener("close",this.#K.bind(this)),e.addEventListener("contextmenu",(t=>{t.target!==this.#$&&t.preventDefault()})),n.addEventListener("click",this.#E),a.addEventListener("click",this.#E),r.addEventListener("click",this.#S.bind(this)),d.addEventListener("click",(()=>{this.#q(!1)})),h.addEventListener("click",(async()=>{const t="true"!==h.getAttribute("aria-pressed");this.#T._reportTelemetry({action:"pdfjs.image.alt_text.ai_generation_check",data:{status:t}}),this.#X&&(this.#X.setPreference("enableGuessAltText",t),await this.#X.mlManager.toggleService("altText",t)),this.#Y(t,!1)})),o.addEventListener("focus",(()=>{this.#U=this.#R,this.#Q(!1),this.#J()})),o.addEventListener("blur",(()=>{o.value||this.#Q(this.#U),this.#J()})),o.addEventListener("input",(()=>{this.#J()})),m._on("enableguessalttext",(({value:t})=>{this.#Y(t,!1)})),this.#W.register(e),this.#H.addEventListener("click",(()=>{this.#T._reportTelemetry({action:"pdfjs.image.alt_text.info",data:{topic:"alt_text"}})}))}#Q(t){this.#X&&this.#R!==t&&(this.#R=t,this.#L.classList.toggle("loading",t))}#q(t){this.#X&&this.#I.classList.toggle("error",t)}async#Y(t,e=!1){if(this.#X)if(this.#I.classList.toggle("aiDisabled",!t),this.#x.setAttribute("aria-pressed",t),t){const{altTextLearnMoreUrl:t}=this.#X.mlManager;t&&(this.#H.href=t),this.#tt(e)}else this.#Q(!1),this.#R=!1,this.#J()}#et(){this.#z.classList.toggle("hidden",!this.#D),this.#A.classList.toggle("hidden",this.#D)}#it(t){this.#X&&this.#V!==t&&(this.#V=t,this.#I.classList.toggle("noAi",!t),this.#J())}#J(){const t=this.#R||this.#N&&this.#N===this.#$.value;this.#M.hidden=!t;const e=this.#R||!!this.#$.value;this.#O!==e&&(this.#O=e,this.#G.setAttribute("data-l10n-id",e?"pdfjs-editor-new-alt-text-dialog-edit-label":"pdfjs-editor-new-alt-text-dialog-add-label"))}async#tt(t){if(this.#R)return;if(this.#$.value)return;if(t&&null!==this.#Z)return;if(this.#N=this.#T.guessedAltText,null===this.#Z&&this.#N)return void this.#nt(this.#N);this.#Q(!0),this.#J();let e=!1;try{const t=await this.#T.mlGuessAltText(this.#F,!1);t&&(this.#N=t,this.#U=this.#R,this.#R&&this.#nt(t))}catch(t){e=!0}this.#Q(!1),this.#J(),e&&this.#X&&this.#q(!0)}#nt(t){this.#X&&!this.#$.value&&(this.#$.value=t,this.#J())}#st(){this.#k.classList.toggle("hidden",!1);const t=async({detail:{finished:e,total:i,totalLoaded:n}})=>{const s=1e6;n=Math.min(.99*i,n);const a=this.#B.ariaValueMax=Math.round(i/s),r=this.#B.ariaValueNow=Math.round(n/s);if(this.#B.setAttribute("data-l10n-args",JSON.stringify({totalSize:a,downloadedSize:r})),!e)return;if(this.#y._off("loadaiengineprogress",t),this.#k.classList.toggle("hidden",!0),this.#it(!0),!this.#X)return;const{mlManager:o}=this.#X;o.toggleService("altText",!0),this.#Y(await o.isEnabledFor("altText"),!0)};this.#y._on("loadaiengineprogress",t)}async editAltText(t,e,i){if(this.#T||!e)return;if(i&&e.hasAltTextData())return void e.altTextFinish();this.#D=i;let{mlManager:n}=t,s=!!n;this.#J(),n&&!n.isReady("altText")?(s=!1,n.hasProgress?this.#st():n=null):this.#k.classList.toggle("hidden",!0);const a=n?.isEnabledFor("altText");this.#T=e,this.#X=t,this.#X.removeEditListeners(),({altText:this.#Z}=e.altTextData),this.#$.value=this.#Z??"";let r,o,l;n?(({canvas:r,width:o,height:l,imageData:this.#F}=e.copyCanvas(224,180,!0)),s&&this.#Y(await a,!0)):({canvas:r,width:o,height:l}=e.copyCanvas(224,180,!1)),r.setAttribute("role","presentation");const{style:d}=r;d.width=`${o}px`,d.height=`${l}px`,this.#j.append(r),this.#et(),this.#it(s),this.#q(!1);try{await this.#W.open(this.#I)}catch(t){throw this.#K(),t}}#_(){this.#T.altTextData={cancel:!0};const t=this.#$.value.trim();this.#T._reportTelemetry({action:"pdfjs.image.alt_text.dismiss",data:{alt_text_type:t?"present":"empty",flow:this.#D?"image_add":"alt_text_edit"}}),this.#T._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!0,alt_text_type:"skipped"}}),this.#at()}#at(){this.#W.closeIfActive(this.#I)}#K(){const t=this.#j.firstChild;t.remove(),t.width=t.height=0,this.#F=null,this.#Q(!1),this.#X?.addEditListeners(),this.#T.altTextFinish(),this.#X?.setSelected(this.#T),this.#T=null,this.#X=null}#rt(t){return new Set(t.toLowerCase().split(/[^\p{L}\p{N}]+/gu).filter((t=>!!t)))}#S(){const t=this.#$.value.trim();if(this.#T.altTextData={altText:t,decorative:!1},this.#T.altTextData.guessedAltText=this.#N,this.#N&&this.#N!==t){const e=this.#rt(this.#N),i=this.#rt(t);this.#T._reportTelemetry({action:"pdfjs.image.alt_text.user_edit",data:{total_words:e.size,words_removed:e.difference(i).size,words_added:i.difference(e).size}})}this.#T._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!0,alt_text_type:t?"present":"empty"}}),this.#T._reportTelemetry({action:"pdfjs.image.alt_text.save",data:{alt_text_type:t?"present":"empty",flow:this.#D?"image_add":"alt_text_edit"}}),this.#at()}destroy(){this.#X=null,this.#at()}}class xi{#ot;#lt;#dt;#I;#y;#ht;#W;#ct;constructor({dialog:t,createModelButton:e,aiModelSettings:i,learnMore:n,closeButton:s,deleteModelButton:a,downloadModelButton:r,showAltTextDialogButton:o},l,d,h){this.#I=t,this.#ot=i,this.#lt=e,this.#dt=r,this.#ct=o,this.#W=l,this.#y=d,this.#ht=h;const{altTextLearnMoreUrl:c}=h;c&&(n.href=c),t.addEventListener("contextmenu",T),e.addEventListener("click",(async t=>{const e=this.#ut("enableGuessAltText",t);await h.toggleService("altText",e),this.#gt({type:"stamp",action:"pdfjs.image.alt_text.settings_ai_generation_check",data:{status:e}})})),o.addEventListener("click",(t=>{const e=this.#ut("enableNewAltTextWhenAddingImage",t);this.#gt({type:"stamp",action:"pdfjs.image.alt_text.settings_edit_alt_text_check",data:{status:e}})})),a.addEventListener("click",this.#pt.bind(this,!0)),r.addEventListener("click",this.#mt.bind(this,!0)),s.addEventListener("click",this.#at.bind(this)),n.addEventListener("click",(()=>{this.#gt({type:"stamp",action:"pdfjs.image.alt_text.info",data:{topic:"ai_generation"}})})),d._on("enablealttextmodeldownload",(({value:t})=>{t?this.#mt(!1):this.#pt(!1)})),this.#W.register(t)}#gt(t){this.#y.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}async#mt(t=!1){if(t){this.#dt.disabled=!0;const t=this.#dt.firstChild;t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-settings-downloading-model-button"),await this.#ht.downloadModel("altText"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-settings-download-model-button"),this.#lt.disabled=!1,this.#ft("enableGuessAltText",!0),this.#ht.toggleService("altText",!0),this.#ft("enableAltTextModelDownload",!0),this.#dt.disabled=!1}this.#ot.classList.toggle("download",!1),this.#lt.setAttribute("aria-pressed",!0)}async#pt(t=!1){t&&(await this.#ht.deleteModel("altText"),this.#ft("enableGuessAltText",!1),this.#ft("enableAltTextModelDownload",!1)),this.#ot.classList.toggle("download",!0),this.#lt.disabled=!0,this.#lt.setAttribute("aria-pressed",!1)}async open({enableGuessAltText:t,enableNewAltTextWhenAddingImage:e}){const{enableAltTextModelDownload:i}=this.#ht;this.#lt.disabled=!i,this.#lt.setAttribute("aria-pressed",i&&t),this.#ct.setAttribute("aria-pressed",e),this.#ot.classList.toggle("download",!i),await this.#W.open(this.#I),this.#gt({type:"stamp",action:"pdfjs.image.alt_text.settings_displayed"})}#ut(t,{target:e}){const i="true"!==e.getAttribute("aria-pressed");return this.#ft(t,i),e.setAttribute("aria-pressed",i),i}#ft(t,e){this.#y.dispatch("setpreference",{source:this,name:t,value:e})}#at(){this.#W.closeIfActive(this.#I)}}class Ti{#bt=null;#T=null;#A;#I;#y;#vt=!1;#wt;#yt;#W;#Ct;#$;#X;#Z=null;#Pt=null;#St=null;#Et=null;#_t;#xt=null;constructor({dialog:t,optionDescription:e,optionDecorative:i,textarea:n,cancelButton:s,saveButton:a},r,o,l){this.#I=t,this.#wt=e,this.#yt=i,this.#$=n,this.#A=s,this.#Ct=a,this.#W=o,this.#y=l,this.#_t=r;const d=this.#Tt.bind(this);t.addEventListener("close",this.#K.bind(this)),t.addEventListener("contextmenu",(t=>{t.target!==this.#$&&t.preventDefault()})),s.addEventListener("click",this.#at.bind(this)),a.addEventListener("click",this.#S.bind(this)),e.addEventListener("change",d),i.addEventListener("change",d),this.#W.register(t)}#At(){if(this.#St)return;const t=new c,e=this.#St=t.createElement("svg");e.setAttribute("width","0"),e.setAttribute("height","0");const i=t.createElement("defs");e.append(i);const n=t.createElement("mask");i.append(n),n.setAttribute("id","alttext-manager-mask"),n.setAttribute("maskContentUnits","objectBoundingBox");let s=t.createElement("rect");n.append(s),s.setAttribute("fill","white"),s.setAttribute("width","1"),s.setAttribute("height","1"),s.setAttribute("x","0"),s.setAttribute("y","0"),s=this.#Et=t.createElement("rect"),n.append(s),s.setAttribute("fill","black"),this.#I.append(e)}async editAltText(t,e){if(this.#T||!e)return;this.#At(),this.#vt=!1,this.#bt=new AbortController;const i={signal:this.#bt.signal},n=this.#Lt.bind(this);for(const t of[this.#wt,this.#yt,this.#$,this.#Ct,this.#A])t.addEventListener("click",n,i);const{altText:s,decorative:a}=e.altTextData;!0===a?(this.#yt.checked=!0,this.#wt.checked=!1):(this.#yt.checked=!1,this.#wt.checked=!0),this.#Z=this.#$.value=s?.trim()||"",this.#Tt(),this.#T=e,this.#X=t,this.#X.removeEditListeners(),this.#Pt=new AbortController,this.#y._on("resize",this.#It.bind(this),{signal:this.#Pt.signal});try{await this.#W.open(this.#I),this.#It()}catch(t){throw this.#K(),t}}#It(){if(!this.#T)return;const t=this.#I,{style:e}=t,{x:i,y:n,width:s,height:a}=this.#_t.getBoundingClientRect(),{innerWidth:r,innerHeight:o}=window,{width:l,height:d}=t.getBoundingClientRect(),{x:h,y:c,width:u,height:g}=this.#T.getClientDimensions(),p=10,m="ltr"===this.#X.direction,f=Math.max(h,i),b=Math.min(h+u,i+s),v=Math.max(c,n),w=Math.min(c+g,n+a);this.#Et.setAttribute("width",""+(b-f)/r),this.#Et.setAttribute("height",""+(w-v)/o),this.#Et.setAttribute("x",""+f/r),this.#Et.setAttribute("y",""+v/o);let y=null,C=Math.max(c,0);C+=Math.min(o-(C+d),0),m?h+u+p+l<r?y=h+u+p:h>l+p&&(y=h-l-p):h>l+p?y=h-l-p:h+u+p+l<r&&(y=h+u+p),null===y&&(C=null,y=Math.max(h,0),y+=Math.min(r-(y+l),0),c>d+p?C=c-d-p:c+g+p+d<o&&(C=c+g+p)),null!==C?(t.classList.add("positioned"),m?e.left=`${y}px`:e.right=r-y-l+"px",e.top=`${C}px`):(t.classList.remove("positioned"),e.left="",e.top="")}#at(){this.#W.closeIfActive(this.#I)}#K(){this.#T._reportTelemetry(this.#xt||{action:"alt_text_cancel",alt_text_keyboard:!this.#vt}),this.#xt=null,this.#Mt(),this.#X?.addEditListeners(),this.#Pt?.abort(),this.#Pt=null,this.#T.altTextFinish(),this.#T=null,this.#X=null}#Tt(){this.#$.disabled=this.#yt.checked}#S(){const t=this.#$.value.trim(),e=this.#yt.checked;this.#T.altTextData={altText:t,decorative:e},this.#xt={action:"alt_text_save",alt_text_description:!!t,alt_text_edit:!!this.#Z&&this.#Z!==t,alt_text_decorative:e,alt_text_keyboard:!this.#vt},this.#at()}#Lt(t){0!==t.detail&&(this.#vt=!0,this.#Mt())}#Mt(){this.#bt?.abort(),this.#bt=null}destroy(){this.#X=null,this.#at(),this.#St?.remove(),this.#St=this.#Et=null}}class Ai{constructor(t,e){this.eventBus=e,this.#kt(t)}#kt({editorFreeTextFontSize:t,editorFreeTextColor:e,editorInkColor:n,editorInkThickness:s,editorInkOpacity:a,editorStampAddImage:r,editorFreeHighlightThickness:o,editorHighlightShowAll:l,editorSignatureAddSignature:d}){const{eventBus:h}=this,c=(t,e)=>{h.dispatch("switchannotationeditorparams",{source:this,type:i[t],value:e})};t.addEventListener("input",(function(){c("FREETEXT_SIZE",this.valueAsNumber)})),e.addEventListener("input",(function(){c("FREETEXT_COLOR",this.value)})),n.addEventListener("input",(function(){c("INK_COLOR",this.value)})),s.addEventListener("input",(function(){c("INK_THICKNESS",this.valueAsNumber)})),a.addEventListener("input",(function(){c("INK_OPACITY",this.valueAsNumber)})),r.addEventListener("click",(()=>{h.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{action:"pdfjs.image.add_image_click"}}}),c("CREATE")})),o.addEventListener("input",(function(){c("HIGHLIGHT_THICKNESS",this.valueAsNumber)})),l.addEventListener("click",(function(){const t="true"===this.getAttribute("aria-pressed");this.setAttribute("aria-pressed",!t),c("HIGHLIGHT_SHOW_ALL",!t)})),d.addEventListener("click",(()=>{c("CREATE")})),h._on("annotationeditorparamschanged",(r=>{for(const[d,c]of r.details)switch(d){case i.FREETEXT_SIZE:t.value=c;break;case i.FREETEXT_COLOR:e.value=c;break;case i.INK_COLOR:n.value=c;break;case i.INK_THICKNESS:s.value=c;break;case i.INK_OPACITY:a.value=c;break;case i.HIGHLIGHT_DEFAULT_COLOR:h.dispatch("mainhighlightcolorpickerupdatecolor",{source:this,value:c});break;case i.HIGHLIGHT_THICKNESS:o.value=c;break;case i.HIGHLIGHT_FREE:o.disabled=!c;break;case i.HIGHLIGHT_SHOW_ALL:l.setAttribute("aria-pressed",c)}}))}}const Li=.1;class Ii{#Bt;#Dt=0;#Nt;constructor(t,e,i,n){if(this.#Bt=e,this.#Nt=i,!n)return;this.#Dt=n.getBoundingClientRect().height;const s=new ResizeObserver((t=>{for(const e of t)if(e.target===n){this.#Dt=Math.floor(e.borderBoxSize[0].blockSize);break}}));s.observe(n),t.addEventListener("abort",(()=>s.disconnect()),{once:!0})}#Vt(t,e){const i=t.y,n=t.bottom,s=t.y+t.height/2,a=e.y,r=e.bottom,o=e.y+e.height/2;return i<=o&&o<=n||a<=s&&s<=r}#Ot(t,e,i,n){const s=t.y+t.height/2;return(n?i>=s:i<=s)&&t.x-Li<=e&&e<=t.right+Li}#jt(t){return t.top>=this.#Dt&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}#Ft(t,e){const{focusNode:i,focusOffset:n}=t,s=document.createRange();s.setStart(i,n),s.setEnd(i,n);const a=s.getBoundingClientRect();return[a.x,e?a.top:a.bottom]}static#Rt(t,e){if(!document.caretPositionFromPoint){const{startContainer:i,startOffset:n}=document.caretRangeFromPoint(t,e);return{offsetNode:i,offset:n}}return document.caretPositionFromPoint(t,e)}#Ut(t,e,i,n,s){if(s||=n.getBoundingClientRect(),e<=s.x+Li)return void(i?t.extend(n.firstChild,0):t.setPosition(n.firstChild,0));if(s.right-Li<=e){const{lastChild:e}=n;return void(i?t.extend(e,e.length):t.setPosition(e,e.length))}const a=s.y+s.height/2;let r=Ii.#Rt(e,a),o=r.offsetNode?.parentElement;if(o&&o!==n){const t=document.elementsFromPoint(e,a),i=[];for(const e of t){if(e===n)break;const{style:t}=e;i.push([e,t.visibility]),t.visibility="hidden"}r=Ii.#Rt(e,a),o=r.offsetNode?.parentElement;for(const[t,e]of i)t.style.visibility=e}o===n?i?t.extend(r.offsetNode,r.offset):t.setPosition(r.offsetNode,r.offset):i?t.extend(n.firstChild,0):t.setPosition(n.firstChild,0)}#Ht(t,e,i,n,s){this.#jt(n)?this.#Ut(e,s,t,i,n):(this.#Bt.addEventListener("scrollend",this.#Ut.bind(this,e,s,t,i,null),{once:!0}),i.scrollIntoView())}#zt(t,e){for(;;){const i=t.closest(".page"),n=parseInt(i.getAttribute("data-page-number")),s=e?n-1:n+1;if(!(t=this.#Nt.querySelector(`.page[data-page-number="${s}"] .textLayer`)))return null;const a=document.createTreeWalker(t,NodeFilter.SHOW_TEXT),r=e?a.lastChild():a.firstChild();if(r)return r}}moveCaret(t,e){const i=document.getSelection();if(0===i.rangeCount)return;const{focusNode:n}=i,s=n.nodeType!==Node.ELEMENT_NODE?n.parentElement:n,a=s.closest(".textLayer");if(!a)return;const r=document.createTreeWalker(a,NodeFilter.SHOW_TEXT);r.currentNode=n;const o=s.getBoundingClientRect();let l=null;const d=(t?r.previousSibling:r.nextSibling).bind(r);for(;d();){const t=r.currentNode.parentElement;if(!this.#Vt(o,t.getBoundingClientRect())){l=t;break}}if(!l){const s=this.#zt(a,t);if(!s)return;if(e){const e=(t?r.firstChild():r.lastChild())||n;i.extend(e,t?0:e.length);const a=document.createRange();return a.setStart(s,t?s.length:0),a.setEnd(s,t?s.length:0),void i.addRange(a)}const[o]=this.#Ft(i,t),{parentElement:l}=s;return void this.#Ht(e,i,l,l.getBoundingClientRect(),o)}const[h,c]=this.#Ft(i,t),u=l.getBoundingClientRect();if(this.#Ot(u,h,c,t))this.#Ht(e,i,l,u,h);else{for(;d();){const n=r.currentNode.parentElement,s=n.getBoundingClientRect();if(!this.#Vt(u,s))break;if(this.#Ot(s,h,c,t))return void this.#Ht(e,i,n,s,h)}this.#Ht(e,i,l,u,h)}}}function Mi(t,e){const i=document.createElement("a");if(!i.click)throw new Error('DownloadManager: "a.click()" is not supported.');i.href=t,i.target="_parent","download"in i&&(i.download=e),(document.body||document.documentElement).append(i),i.click(),i.remove()}class ki{#Wt=new WeakMap;downloadData(t,e,i){Mi(URL.createObjectURL(new Blob([t],{type:i})),e)}openOrDownloadData(t,e,i=null){const n=E(e),s=n?"application/pdf":"";if(n){let n,a=this.#Wt.get(t);a||(a=URL.createObjectURL(new Blob([t],{type:s})),this.#Wt.set(t,a)),n="?file="+encodeURIComponent(a+"#"+e),i&&(n+=`#${escape(i)}`);try{return window.open(n),!0}catch(e){URL.revokeObjectURL(a),this.#Wt.delete(t)}}return this.downloadData(t,e,s),!1}download(t,e,i){let n;if(t)n=URL.createObjectURL(new Blob([t],{type:"application/pdf"}));else{if(!h(e,"http://example.com"))return;n=e+"#pdfjs.action=download"}Mi(n,i)}}class Bi{#$t=null;#_t;#y=null;#Gt=null;#Xt=null;isOpen=!1;#Zt;#Kt=null;#qt;static#Yt=Object.freeze({highlight:"pdfjs-editor-undo-bar-message-highlight",freetext:"pdfjs-editor-undo-bar-message-freetext",stamp:"pdfjs-editor-undo-bar-message-stamp",ink:"pdfjs-editor-undo-bar-message-ink",signature:"pdfjs-editor-undo-bar-message-signature",_multiple:"pdfjs-editor-undo-bar-message-multiple"});constructor({container:t,message:e,undoButton:i,closeButton:n},s){this.#_t=t,this.#Zt=e,this.#qt=i,this.#$t=n,this.#y=s}destroy(){this.#Xt?.abort(),this.#Xt=null,this.hide()}show(t,e){if(!this.#Xt){this.#Xt=new AbortController;const t={signal:this.#Xt.signal},e=this.hide.bind(this);this.#_t.addEventListener("contextmenu",T,t),this.#$t.addEventListener("click",e,t),this.#y._on("beforeprint",e,t),this.#y._on("download",e,t)}this.hide(),"string"==typeof e?this.#Zt.setAttribute("data-l10n-id",Bi.#Yt[e]):(this.#Zt.setAttribute("data-l10n-id",Bi.#Yt._multiple),this.#Zt.setAttribute("data-l10n-args",JSON.stringify({count:e}))),this.isOpen=!0,this.#_t.hidden=!1,this.#Kt=new AbortController,this.#qt.addEventListener("click",(()=>{t(),this.hide()}),{signal:this.#Kt.signal}),this.#Gt=setTimeout((()=>{this.#_t.focus(),this.#Gt=null}),100)}hide(){this.isOpen&&(this.isOpen=!1,this.#_t.hidden=!0,this.#Kt?.abort(),this.#Kt=null,this.#Gt&&(clearTimeout(this.#Gt),this.#Gt=null))}}class Di{#Qt=new WeakMap;#Jt=null;get active(){return this.#Jt}async register(t,e=!1){if("object"!=typeof t)throw new Error("Not enough parameters.");if(this.#Qt.has(t))throw new Error("The overlay is already registered.");this.#Qt.set(t,{canForceClose:e}),t.addEventListener("cancel",(({target:t})=>{this.#Jt===t&&(this.#Jt=null)}))}async open(t){if(!this.#Qt.has(t))throw new Error("The overlay does not exist.");if(this.#Jt){if(this.#Jt===t)throw new Error("The overlay is already active.");if(!this.#Qt.get(t).canForceClose)throw new Error("Another overlay is currently active.");await this.close()}this.#Jt=t,t.showModal()}async close(t=this.#Jt){if(!this.#Qt.has(t))throw new Error("The overlay does not exist.");if(!this.#Jt)throw new Error("The overlay is currently not active.");if(this.#Jt!==t)throw new Error("Another overlay is currently active.");t.close(),this.#Jt=null}async closeIfActive(t){this.#Jt===t&&await this.close(t)}}class Ni{#te=null;#ee=null;#ie=null;constructor(t,e,i=!1){this.dialog=t.dialog,this.label=t.label,this.input=t.input,this.submitButton=t.submitButton,this.cancelButton=t.cancelButton,this.overlayManager=e,this._isViewerEmbedded=i,this.submitButton.addEventListener("click",this.#ne.bind(this)),this.cancelButton.addEventListener("click",this.close.bind(this)),this.input.addEventListener("keydown",(t=>{13===t.keyCode&&this.#ne()})),this.overlayManager.register(this.dialog,!0),this.dialog.addEventListener("close",this.#_.bind(this))}async open(){await(this.#te?.promise),this.#te=Promise.withResolvers();try{await this.overlayManager.open(this.dialog)}catch(t){throw this.#te.resolve(),t}const t=this.#ie===M.INCORRECT_PASSWORD;this._isViewerEmbedded&&!t||this.input.focus(),this.label.setAttribute("data-l10n-id",t?"pdfjs-password-invalid":"pdfjs-password-label")}async close(){this.overlayManager.closeIfActive(this.dialog)}#ne(){const t=this.input.value;t?.length>0&&this.#se(t)}#_(){this.#se(new Error("PasswordPrompt cancelled.")),this.#te.resolve()}#se(t){this.#ee&&(this.close(),this.input.value="",this.#ee(t),this.#ee=null)}async setUpdateCallback(t,e){this.#te&&await this.#te.promise,this.#ee=t,this.#ie=e}}const Vi="selected";class Oi{constructor(t){this.container=t.container,this.eventBus=t.eventBus,this._l10n=t.l10n,this.reset()}reset(){this._pdfDocument=null,this._lastToggleIsShow=!0,this._currentTreeItem=null,this.container.textContent="",this.container.classList.remove("treeWithDeepNesting")}_dispatchEvent(t){throw new Error("Not implemented: _dispatchEvent")}_bindLink(t,e){throw new Error("Not implemented: _bindLink")}_normalizeTextContent(t){return Ct(t,!0)||"–"}_addToggleButton(t,e=!1){const i=document.createElement("div");i.className="treeItemToggler",e&&i.classList.add("treeItemsHidden"),i.onclick=e=>{if(e.stopPropagation(),i.classList.toggle("treeItemsHidden"),e.shiftKey){const e=!i.classList.contains("treeItemsHidden");this._toggleTreeItem(t,e)}},t.prepend(i)}_toggleTreeItem(t,e=!1){this._l10n.pause(),this._lastToggleIsShow=e;for(const i of t.querySelectorAll(".treeItemToggler"))i.classList.toggle("treeItemsHidden",!e);this._l10n.resume()}_toggleAllTreeItems(){this._toggleTreeItem(this.container,!this._lastToggleIsShow)}_finishRendering(t,e,i=!1){i&&(this.container.classList.add("treeWithDeepNesting"),this._lastToggleIsShow=!t.querySelector(".treeItemsHidden")),this._l10n.pause(),this.container.append(t),this._l10n.resume(),this._dispatchEvent(e)}render(t){throw new Error("Not implemented: render")}_updateCurrentTreeItem(t=null){this._currentTreeItem&&(this._currentTreeItem.classList.remove(Vi),this._currentTreeItem=null),t&&(t.classList.add(Vi),this._currentTreeItem=t)}_scrollToCurrentTreeItem(t){if(!t)return;this._l10n.pause();let e=t.parentNode;for(;e&&e!==this.container;){if(e.classList.contains("treeItem")){const t=e.firstElementChild;t?.classList.remove("treeItemsHidden")}e=e.parentNode}this._l10n.resume(),this._updateCurrentTreeItem(t),this.container.scrollTo(t.offsetLeft,t.offsetTop+-100)}}class ji extends Oi{constructor(t){super(t),this.downloadManager=t.downloadManager,this.eventBus._on("fileattachmentannotation",this.#ae.bind(this))}reset(t=!1){super.reset(),this._attachments=null,t||(this._renderedCapability=Promise.withResolvers()),this._pendingDispatchEvent=!1}async _dispatchEvent(t){this._renderedCapability.resolve(),(0!==t||this._pendingDispatchEvent||(this._pendingDispatchEvent=!0,await ee({target:this.eventBus,name:"annotationlayerrendered",delay:1e3}),this._pendingDispatchEvent))&&(this._pendingDispatchEvent=!1,this.eventBus.dispatch("attachmentsloaded",{source:this,attachmentsCount:t}))}_bindLink(t,{content:e,description:i,filename:n}){i&&(t.title=i),t.onclick=()=>(this.downloadManager.openOrDownloadData(e,n),!1)}render({attachments:t,keepRenderedCapability:e=!1}){if(this._attachments&&this.reset(e),this._attachments=t||null,!t)return void this._dispatchEvent(0);const i=document.createDocumentFragment();let n=0;for(const e in t){const s=t[e],a=document.createElement("div");a.className="treeItem";const r=document.createElement("a");this._bindLink(r,s),r.textContent=this._normalizeTextContent(s.filename),a.append(r),i.append(a),n++}this._finishRendering(i,n)}#ae(t){const e=this._renderedCapability.promise;e.then((()=>{if(e!==this._renderedCapability.promise)return;const i=this._attachments||Object.create(null);for(const e in i)if(t.filename===e)return;i[t.filename]=t,this.render({attachments:i,keepRenderedCapability:!0})}))}}const Fi="grab-to-pan-grab";class Ri{#re=null;#oe=null;#le=null;constructor({element:t}){this.element=t,this.document=t.ownerDocument;(this.overlay=document.createElement("div")).className="grab-to-pan-grabbing"}activate(){this.#re||(this.#re=new AbortController,this.element.addEventListener("mousedown",this.#de.bind(this),{capture:!0,signal:this.#re.signal}),this.element.classList.add(Fi))}deactivate(){this.#re&&(this.#re.abort(),this.#re=null,this.#he(),this.element.classList.remove(Fi))}toggle(){this.#re?this.deactivate():this.activate()}ignoreTarget(t){return t.matches("a[href], a[href] *, input, textarea, button, button *, select, option")}#de(t){if(0!==t.button||this.ignoreTarget(t.target))return;if(t.originalTarget)try{t.originalTarget.tagName}catch{return}this.scrollLeftStart=this.element.scrollLeft,this.scrollTopStart=this.element.scrollTop,this.clientXStart=t.clientX,this.clientYStart=t.clientY,this.#oe=new AbortController;const e=this.#he.bind(this),i={capture:!0,signal:this.#oe.signal};this.document.addEventListener("mousemove",this.#ce.bind(this),i),this.document.addEventListener("mouseup",e,i),this.#le=new AbortController,this.element.addEventListener("scroll",e,{capture:!0,signal:this.#le.signal}),H(t);const n=document.activeElement;n&&!n.contains(t.target)&&n.blur()}#ce(t){if(this.#le?.abort(),this.#le=null,!(1&t.buttons))return void this.#he();const e=t.clientX-this.clientXStart,i=t.clientY-this.clientYStart;this.element.scrollTo({top:this.scrollTopStart-i,left:this.scrollLeftStart-e,behavior:"instant"}),this.overlay.parentNode||document.body.append(this.overlay)}#he(){this.#oe?.abort(),this.#oe=null,this.#le?.abort(),this.#le=null,this.overlay.remove()}}class Ui{#Jt=pt;#ue=null;constructor({container:t,eventBus:e,cursorToolOnLoad:i=pt}){this.container=t,this.eventBus=e,this.#ge(),Promise.resolve().then((()=>{this.switchTool(i)}))}get activeTool(){return this.#Jt}switchTool(t){null===this.#ue&&this.#pe(t)}#pe(t,e=!1){if(t===this.#Jt)return void(null!==this.#ue&&this.eventBus.dispatch("cursortoolchanged",{source:this,tool:t,disabled:e}));const i=()=>{switch(this.#Jt){case pt:break;case mt:this._handTool.deactivate()}};switch(t){case pt:i();break;case mt:i(),this._handTool.activate();break;default:return}this.#Jt=t,this.eventBus.dispatch("cursortoolchanged",{source:this,tool:t,disabled:e})}#ge(){this.eventBus._on("switchcursortool",(i=>{i.reset?null!==this.#ue&&(t=n.NONE,e=tt,s()):this.switchTool(i.tool)}));let t=n.NONE,e=tt;const i=()=>{this.#ue??=this.#Jt,this.#pe(pt,!0)},s=()=>{null!==this.#ue&&t===n.NONE&&e===tt&&(this.#pe(this.#ue),this.#ue=null)};this.eventBus._on("annotationeditormodechanged",(({mode:e})=>{t=e,e===n.NONE?s():i()})),this.eventBus._on("presentationmodechanged",(({state:t})=>{e=t,t===tt?s():t===it&&i()}))}get _handTool(){return R(this,"_handTool",new Ri({element:this.container}))}}const Hi=["en-us","en-lr","my"],zi={"8.5x11":"pdfjs-document-properties-page-size-name-letter","8.5x14":"pdfjs-document-properties-page-size-name-legal"},Wi={"297x420":"pdfjs-document-properties-page-size-name-a-three","210x297":"pdfjs-document-properties-page-size-name-a-four"};function $i(t,e,i){return i[`${e?t.width:t.height}x${e?t.height:t.width}`]}class Gi{#me=null;constructor({dialog:t,fields:e,closeButton:i},n,s,a,r,o){this.dialog=t,this.fields=e,this.overlayManager=n,this.l10n=a,this._fileNameLookup=r,this._titleLookup=o,this.#fe(),i.addEventListener("click",this.close.bind(this)),this.overlayManager.register(this.dialog),s._on("pagechanging",(t=>{this._currentPageNumber=t.pageNumber})),s._on("rotationchanging",(t=>{this._pagesRotation=t.pagesRotation}))}async open(){await Promise.all([this.overlayManager.open(this.dialog),this._dataAvailableCapability.promise]);const t=this._currentPageNumber,e=this._pagesRotation;if(this.#me&&t===this.#me._currentPageNumber&&e===this.#me._pagesRotation)return void this.#be();const[{info:i,metadata:n,contentLength:s},a]=await Promise.all([this.pdfDocument.getMetadata(),this.pdfDocument.getPage(t)]),[r,o,l,d,h,c,u]=await Promise.all([this._fileNameLookup(),this.#ve(s),this._titleLookup(),this.#we(n?.get("xmp:createdate"),i.CreationDate),this.#we(n?.get("xmp:modifydate"),i.ModDate),this.#ye(_t(a),e),this.#Ce(i.IsLinearized)]);this.#me=Object.freeze({fileName:r,fileSize:o,title:l,author:n?.get("dc:creator")?.join("\n")||i.Author,subject:n?.get("dc:subject")?.join("\n")||i.Subject,keywords:n?.get("pdf:keywords")||i.Keywords,creationDate:d,modificationDate:h,creator:n?.get("xmp:creatortool")||i.Creator,producer:n?.get("pdf:producer")||i.Producer,version:i.PDFFormatVersion,pageCount:this.pdfDocument.numPages,pageSize:c,linearized:u,_currentPageNumber:t,_pagesRotation:e}),this.#be();const{length:g}=await this.pdfDocument.getDownloadInfo();if(s===g)return;const p=Object.assign(Object.create(null),this.#me);p.fileSize=await this.#ve(g),this.#me=Object.freeze(p),this.#be()}async close(){this.overlayManager.close(this.dialog)}setDocument(t){this.pdfDocument&&(this.#fe(),this.#be()),t&&(this.pdfDocument=t,this._dataAvailableCapability.resolve())}#fe(){this.pdfDocument=null,this.#me=null,this._dataAvailableCapability=Promise.withResolvers(),this._currentPageNumber=1,this._pagesRotation=0}#be(){if(!this.#me||this.overlayManager.active===this.dialog)for(const t in this.fields){const e=this.#me?.[t];this.fields[t].textContent=e||0===e?e:"-"}}async#ve(t=0){const e=t/1024,i=e/1024;return e?this.l10n.get(i>=1?"pdfjs-document-properties-size-mb":"pdfjs-document-properties-size-kb",{mb:i,kb:e,b:t}):void 0}async#ye(t,e){if(!t)return;e%180!=0&&(t={width:t.height,height:t.width});const i=Mt(t),n=Hi.includes(this.l10n.getLanguage());let s={width:Math.round(100*t.width)/100,height:Math.round(100*t.height)/100},a={width:Math.round(25.4*t.width*10)/10,height:Math.round(25.4*t.height*10)/10},r=$i(s,i,zi)||$i(a,i,Wi);if(!(r||Number.isInteger(a.width)&&Number.isInteger(a.height))){const e={width:25.4*t.width,height:25.4*t.height},n={width:Math.round(a.width),height:Math.round(a.height)};Math.abs(e.width-n.width)<.1&&Math.abs(e.height-n.height)<.1&&(r=$i(n,i,Wi),r&&(s={width:Math.round(n.width/25.4*100)/100,height:Math.round(n.height/25.4*100)/100},a=n))}const[{width:o,height:l},d,h,c]=await Promise.all([n?s:a,this.l10n.get(n?"pdfjs-document-properties-page-size-unit-inches":"pdfjs-document-properties-page-size-unit-millimeters"),r&&this.l10n.get(r),this.l10n.get(i?"pdfjs-document-properties-page-size-orientation-portrait":"pdfjs-document-properties-page-size-orientation-landscape")]);return this.l10n.get(h?"pdfjs-document-properties-page-size-dimension-name-string":"pdfjs-document-properties-page-size-dimension-string",{width:o,height:l,unit:d,name:h,orientation:c})}async#we(t,e){const i=Date.parse(t)||B.toDateObject(e);return i?this.l10n.get("pdfjs-document-properties-date-time-string",{dateObj:i.valueOf()}):void 0}#Ce(t){return this.l10n.get(t?"pdfjs-document-properties-linearized-yes":"pdfjs-document-properties-linearized-no")}}const Xi=0,Zi=1,Ki=2,qi=3,Yi=4,Qi=5,Ji=6,tn=7;function en(t){return function(t){return t<11904}(t)?function(t){return!(65408&t)}(t)?function(t){return 32===t||9===t||13===t||10===t}(t)?Xi:function(t){return t>=97&&t<=122||t>=65&&t<=90}(t)||function(t){return t>=48&&t<=57}(t)||95===t?Zi:Ki:function(t){return 3584==(65408&t)}(t)?tn:160===t?Xi:Zi:function(t){return t>=13312&&t<=40959||t>=63744&&t<=64255}(t)?qi:function(t){return t>=12448&&t<=12543}(t)?Yi:function(t){return t>=12352&&t<=12447}(t)?Qi:function(t){return t>=65376&&t<=65439}(t)?Ji:Zi}let nn;const sn=0,an=1,rn=2,on=3,ln={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},dn=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let hn;const cn=/\p{M}+/gu,un=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,gn=/([^\p{M}])\p{M}*$/u,pn=/^\p{M}*([^\p{M}])/u,mn=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,fn=new Map,bn=new Map;let vn=null,wn=null;function yn(t){const e=[];let i;for(;null!==(i=mn.exec(t));){let{index:t}=i;for(const n of i[0]){let i=fn.get(n);i||(i=n.normalize("NFD").length,fn.set(n,i)),e.push([i,t++])}}const n=e.length>0;let s;if(!n&&vn)s=vn;else if(n&&wn)s=wn;else{const t=Object.keys(ln).join(""),e=(nn||=" ¨ª¯²-µ¸-º¼-¾Ĳ-ĳĿ-ŀŉſǄ-ǌǱ-ǳʰ-ʸ˘-˝ˠ-ˤʹͺ;΄-΅·ϐ-ϖϰ-ϲϴ-ϵϹևٵ-ٸक़-य़ড়-ঢ়য়ਲ਼ਸ਼ਖ਼-ਜ਼ਫ਼ଡ଼-ଢ଼ำຳໜ-ໝ༌གྷཌྷདྷབྷཛྷཀྵჼᴬ-ᴮᴰ-ᴺᴼ-ᵍᵏ-ᵪᵸᶛ-ᶿẚ-ẛάέήίόύώΆ᾽-῁ΈΉ῍-῏ΐΊ῝-῟ΰΎ῭-`ΌΏ´-῾ - ‑‗․-… ″-‴‶-‷‼‾⁇-⁉⁗ ⁰-ⁱ⁴-₎ₐ-ₜ₨℀-℃℅-ℇ℉-ℓℕ-№ℙ-ℝ℠-™ℤΩℨK-ℭℯ-ℱℳ-ℹ℻-⅀ⅅ-ⅉ⅐-ⅿ↉∬-∭∯-∰〈-〉①-⓪⨌⩴-⩶⫝̸ⱼ-ⱽⵯ⺟⻳⼀-⿕　〶〸-〺゛-゜ゟヿㄱ-ㆎ㆒-㆟㈀-㈞㈠-㉇㉐-㉾㊀-㏿ꚜ-ꚝꝰꟲ-ꟴꟸ-ꟹꭜ-ꭟꭩ豈-嗀塚晴凞-羽蘒諸逸-都飯-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-﷼︐-︙︰-﹄﹇-﹒﹔-﹦﹨-﹫ﹰ-ﹲﹴﹶ-ﻼ！-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ￠-￦",nn);s=new RegExp([`[${t}]`,`[${e}]`,`${"(?:゙|゚)"}\\n`,"\\p{M}+(?:-\\n)?",`${"\\p{Ll}-\\n(?=\\p{Ll})|\\p{Lu}-\\n(?=\\p{L})"}`,"\\S-\\n",`${"(?:\\p{Ideographic}|[぀-ヿ])"}\\n`,"\\n",n?"[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]":"\\u0000"].map((t=>`(${t})`)).join("|"),"gum"),n?wn=s:vn=s}const a=[];for(;null!==(i=cn.exec(t));)a.push([i[0].length,i.index]);let r=t.normalize("NFD");const o=[0,0];let l=0,d=0,h=0,c=0,u=0,g=!1;r=r.replace(s,((t,i,n,s,r,p,m,f,b,v,w)=>{if(w-=c,i){const t=ln[i],e=t.length;for(let t=1;t<e;t++)o.push(w-h+t,h-t);return h-=e-1,t}if(n){let t=bn.get(n);t||(t=n.normalize("NFKC"),bn.set(n,t));const e=t.length;for(let t=1;t<e;t++)o.push(w-h+t,h-t);return h-=e-1,t}if(s)return g=!0,w+u===a[l]?.[1]?++l:(o.push(w-1-h+1,h-1),h-=1,c+=1),o.push(w-h+1,h),c+=1,u+=1,s.charAt(0);if(r){const t=r.endsWith("\n"),e=t?r.length-2:r.length;g=!0;let i=e;w+u===a[l]?.[1]&&(i-=a[l][0],++l);for(let t=1;t<=i;t++)o.push(w-1-h+t,h-t);return h-=i,c+=i,t?(w+=e-1,o.push(w-h+1,1+h),h+=1,c+=1,u+=1,r.slice(0,e)):r}if(p){const t=p.length-2;return o.push(w-h+t,1+h),h+=1,c+=1,u+=1,p.slice(0,-2)}if(m)return c+=1,u+=1,m.slice(0,-1);if(f){const t=f.length-1;return o.push(w-h+t,h),c+=1,u+=1,f.slice(0,-1)}if(b)return o.push(w-h+1,h-1),h-=1,c+=1,u+=1," ";if(w+u===e[d]?.[1]){const t=e[d][0]-1;++d;for(let e=1;e<=t;e++)o.push(w-(h-e),h-e);h-=t,c+=t}return v})),o.push(r.length,h);const p=new Uint32Array(o.length>>1),m=new Int32Array(o.length>>1);for(let t=0,e=o.length;t<e;t+=2)p[t>>1]=o[t],m[t>>1]=o[t+1];return[r,[p,m],g]}function Cn(t,e,i){if(!t)return[e,i];const[n,s]=t,a=e,r=e+i-1;let o=Pt(n,(t=>t>=a));n[o]>a&&--o;let l=Pt(n,(t=>t>=r),o);n[l]>r&&--l;const d=a+s[o];return[d,r+s[l]+1-d]}class Pn{#Pe=null;#Se=!0;#Ee=0;constructor({linkService:t,eventBus:e,updateMatchesCountOnProgress:i=!0}){this._linkService=t,this._eventBus=e,this.#Se=i,this.onIsPageVisible=null,this.#fe(),e._on("find",this.#_e.bind(this)),e._on("findbarclose",this.#xe.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#Pe}setDocument(t){this._pdfDocument&&this.#fe(),t&&(this._pdfDocument=t,this._firstPageCapability.resolve())}#_e(t){if(!t)return;const e=this._pdfDocument,{type:i}=t;(null===this.#Pe||this.#Te(t))&&(this._dirtyMatch=!0),this.#Pe=t,"highlightallchange"!==i&&this.#Tt(on),this._firstPageCapability.promise.then((()=>{if(!this._pdfDocument||e&&this._pdfDocument!==e)return;this.#Ae();const t=!this._highlightMatches,n=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),i?this._dirtyMatch?this.#Le():"again"===i?(this.#Le(),t&&this.#Pe.highlightAll&&this.#Ie()):"highlightallchange"===i?(n?this.#Le():this._highlightMatches=!0,this.#Ie()):this.#Le():this._findTimeout=setTimeout((()=>{this.#Le(),this._findTimeout=null}),250)}))}scrollMatchIntoView({element:t=null,selectedLeft:e=0,pageIndex:i=-1,matchIndex:n=-1}){if(!this._scrollMatches||!t)return;if(-1===n||n!==this._selected.matchIdx)return;if(-1===i||i!==this._selected.pageIdx)return;this._scrollMatches=!1;bt(t,{top:-50,left:e+-400},!0)}#fe(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#Ee=0,this.#Pe=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get#Me(){const{query:t}=this.#Pe;return"string"==typeof t?(t!==this._rawQuery&&(this._rawQuery=t,[this._normalizedQuery]=yn(t)),this._normalizedQuery):(t||[]).filter((t=>!!t)).map((t=>yn(t)[0]))}#Te(t){const e=t.query,i=this.#Pe.query,n=typeof e;if(n!==typeof i)return!0;if("string"===n){if(e!==i)return!0}else if(JSON.stringify(e)!==JSON.stringify(i))return!0;switch(t.type){case"again":const t=this._selected.pageIdx+1,e=this._linkService;return t>=1&&t<=e.pagesCount&&t!==e.page&&!(this.onIsPageVisible?.(t)??1);case"highlightallchange":return!1}return!0}#ke(t,e,i){let n=t.slice(0,e).match(gn);if(n){const i=t.charCodeAt(e),s=n[1].charCodeAt(0);if(en(i)===en(s))return!1}if(n=t.slice(e+i).match(pn),n){const s=t.charCodeAt(e+i-1),a=n[1].charCodeAt(0);if(en(s)===en(a))return!1}return!0}#Be(t,e){const{matchDiacritics:i}=this.#Pe;let n=!1;const s="[ ]*";return(t=t.replaceAll(un,((t,s,a,r,o,l)=>s?`[ ]*\\${s}[ ]*`:a?`[ ]*${a}[ ]*`:r?"[ ]+":i?o||l:o?dn.has(o.charCodeAt(0))?o:"":e?(n=!0,`${l}\\p{M}*`):l))).endsWith(s)&&(t=t.slice(0,t.length-4)),i&&e&&(hn||=String.fromCharCode(...dn),n=!0,t=`${t}(?=[${hn}]|[^\\p{M}]|$)`),[n,t]}#De(t){if(!this.#Pe)return;const e=this.#Me;if(0===e.length)return;const i=this._pageContents[t],n=this.match(e,i,t),s=this._pageMatches[t]=[],a=this._pageMatchesLength[t]=[],r=this._pageDiffs[t];n?.forEach((({index:t,length:e})=>{const[i,n]=Cn(r,t,e);n&&(s.push(i),a.push(n))})),this.#Pe.highlightAll&&this.#Ne(t),this._resumePageIdx===t&&(this._resumePageIdx=null,this.#Ve());const o=s.length;this._matchesCountTotal+=o,this.#Se?o>0&&this.#Oe():++this.#Ee===this._linkService.pagesCount&&this.#Oe()}match(t,e,i){const n=this._hasDiacritics[i];let s=!1;if("string"==typeof t?[s,t]=this.#Be(t,n):t=t.sort().reverse().map((t=>{const[e,i]=this.#Be(t,n);return s||=e,`(${i})`})).join("|"),!t)return;const{caseSensitive:a,entireWord:r}=this.#Pe;t=new RegExp(t,`g${s?"u":""}${a?"":"i"}`);const o=[];let l;for(;null!==(l=t.exec(e));)r&&!this.#ke(e,l.index,l[0].length)||o.push({index:l.index,length:l[0].length});return o}#Ae(){if(this._extractTextPromises.length>0)return;let t=Promise.resolve();const e={disableNormalization:!0},i=this._pdfDocument;for(let n=0,s=this._linkService.pagesCount;n<s;n++){const{promise:s,resolve:a}=Promise.withResolvers();this._extractTextPromises[n]=s,t=t.then((async()=>{i===this._pdfDocument?await i.getPage(n+1).then((t=>t.getTextContent(e))).then((t=>{const e=[];for(const i of t.items)e.push(i.str),i.hasEOL&&e.push("\n");[this._pageContents[n],this._pageDiffs[n],this._hasDiacritics[n]]=yn(e.join("")),a()}),(t=>{this._pageContents[n]="",this._pageDiffs[n]=null,this._hasDiacritics[n]=!1,a()})):a()}))}}#Ne(t){this._scrollMatches&&this._selected.pageIdx===t&&(this._linkService.page=t+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:t})}#Ie(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#Le(){const t=this.#Pe.findPrevious,e=this._linkService.page-1,i=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=e,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#Ee=0,this._matchesCountTotal=0,this.#Ie();for(let t=0;t<i;t++)this._pendingFindMatches.has(t)||(this._pendingFindMatches.add(t),this._extractTextPromises[t].then((()=>{this._pendingFindMatches.delete(t),this.#De(t)})))}if(0===this.#Me.length)return void this.#Tt(sn);if(this._resumePageIdx)return;const n=this._offset;if(this._pagesToSearch=i,null!==n.matchIdx){const e=this._pageMatches[n.pageIdx].length;if(!t&&n.matchIdx+1<e||t&&n.matchIdx>0)return n.matchIdx=t?n.matchIdx-1:n.matchIdx+1,void this.#je(!0);this.#Fe(t)}this.#Ve()}#Re(t){const e=this._offset,i=t.length,n=this.#Pe.findPrevious;return i?(e.matchIdx=n?i-1:0,this.#je(!0),!0):(this.#Fe(n),!!(e.wrapped&&(e.matchIdx=null,this._pagesToSearch<0))&&(this.#je(!1),!0))}#Ve(){this._resumePageIdx;let t=null;do{const e=this._offset.pageIdx;if(t=this._pageMatches[e],!t){this._resumePageIdx=e;break}}while(!this.#Re(t))}#Fe(t){const e=this._offset,i=this._linkService.pagesCount;e.pageIdx=t?e.pageIdx-1:e.pageIdx+1,e.matchIdx=null,this._pagesToSearch--,(e.pageIdx>=i||e.pageIdx<0)&&(e.pageIdx=t?i-1:0,e.wrapped=!0)}#je(t=!1){let e=an;const i=this._offset.wrapped;if(this._offset.wrapped=!1,t){const t=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,e=i?rn:sn,-1!==t&&t!==this._selected.pageIdx&&this.#Ne(t)}this.#Tt(e,this.#Pe.findPrevious),-1!==this._selected.pageIdx&&(this._scrollMatches=!0,this.#Ne(this._selected.pageIdx))}#xe(t){const e=this._pdfDocument;this._firstPageCapability.promise.then((()=>{!this._pdfDocument||e&&this._pdfDocument!==e||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#Tt(sn),this._highlightMatches=!1,this.#Ie())}))}#Ue(){const{pageIdx:t,matchIdx:e}=this._selected;let i=0,n=this._matchesCountTotal;if(-1!==e){for(let e=0;e<t;e++)i+=this._pageMatches[e]?.length||0;i+=e+1}return(i<1||i>n)&&(i=n=0),{current:i,total:n}}#Oe(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#Ue()})}#Tt(t,e=!1){(this.#Se||this.#Ee===this._linkService.pagesCount&&t!==on)&&this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:t,previous:e,entireWord:this.#Pe?.entireWord??null,matchesCount:this.#Ue(),rawQuery:this.#Pe?.query??null})}}class Sn{#Bt;#He=new ResizeObserver(this.#ze.bind(this));constructor(t,e,i){this.opened=!1,this.bar=t.bar,this.toggleButton=t.toggleButton,this.findField=t.findField,this.highlightAll=t.highlightAllCheckbox,this.caseSensitive=t.caseSensitiveCheckbox,this.matchDiacritics=t.matchDiacriticsCheckbox,this.entireWord=t.entireWordCheckbox,this.findMsg=t.findMsg,this.findResultsCount=t.findResultsCount,this.findPreviousButton=t.findPreviousButton,this.findNextButton=t.findNextButton,this.eventBus=i,this.#Bt=e;const n=new Map([[this.highlightAll,"highlightallchange"],[this.caseSensitive,"casesensitivitychange"],[this.entireWord,"entirewordchange"],[this.matchDiacritics,"diacriticmatchingchange"]]);this.toggleButton.addEventListener("click",(()=>{this.toggle()})),this.findField.addEventListener("input",(()=>{this.dispatchEvent("")})),this.bar.addEventListener("keydown",(({keyCode:t,shiftKey:e,target:i})=>{switch(t){case 13:i===this.findField?this.dispatchEvent("again",e):n.has(i)&&(i.checked=!i.checked,this.dispatchEvent(n.get(i)));break;case 27:this.close()}})),this.findPreviousButton.addEventListener("click",(()=>{this.dispatchEvent("again",!0)})),this.findNextButton.addEventListener("click",(()=>{this.dispatchEvent("again",!1)}));for(const[t,e]of n)t.addEventListener("click",(()=>{this.dispatchEvent(e)}))}reset(){this.updateUIState()}dispatchEvent(t,e=!1){this.eventBus.dispatch("find",{source:this,type:t,query:this.findField.value,caseSensitive:this.caseSensitive.checked,entireWord:this.entireWord.checked,highlightAll:this.highlightAll.checked,findPrevious:e,matchDiacritics:this.matchDiacritics.checked})}updateUIState(t,e,i){const{findField:n,findMsg:s}=this;let a="",r="";switch(t){case sn:break;case on:r="pending";break;case an:a="pdfjs-find-not-found",r="notFound";break;case rn:a=e?"pdfjs-find-reached-top":"pdfjs-find-reached-bottom"}n.setAttribute("data-status",r),n.setAttribute("aria-invalid",t===an),s.setAttribute("data-status",r),a?s.setAttribute("data-l10n-id",a):(s.removeAttribute("data-l10n-id"),s.textContent=""),this.updateResultsCount(i)}updateResultsCount({current:t=0,total:e=0}={}){const{findResultsCount:i}=this;if(e>0){const n=1e3;i.setAttribute("data-l10n-id",e>n?"pdfjs-find-match-count-limit":"pdfjs-find-match-count"),i.setAttribute("data-l10n-args",JSON.stringify({limit:n,current:t,total:e}))}else i.removeAttribute("data-l10n-id"),i.textContent=""}open(){this.opened||(this.#He.observe(this.#Bt),this.#He.observe(this.bar),this.opened=!0,jt(this.toggleButton,!0,this.bar)),this.findField.select(),this.findField.focus()}close(){this.opened&&(this.#He.disconnect(),this.opened=!1,jt(this.toggleButton,!1,this.bar),this.eventBus.dispatch("findbarclose",{source:this}))}toggle(){this.opened?this.close():this.open()}#ze(){const{bar:t}=this;t.classList.remove("wrapContainers");t.clientHeight>t.firstElementChild.clientHeight&&t.classList.add("wrapContainers")}}function En(){return document.location.hash}class _n{#We=null;constructor({linkService:t,eventBus:e}){this.linkService=t,this.eventBus=e,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",(()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",(t=>{this._isPagesLoaded=!!t.pagesCount}),{once:!0})}))}initialize({fingerprint:t,resetHistory:e=!1,updateUrl:i=!1}){if(!t||"string"!=typeof t)return;this._initialized&&this.reset();const n=""!==this._fingerprint&&this._fingerprint!==t;this._fingerprint=t,this._updateUrl=!0===i,this._initialized=!0,this.#$e();const s=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=En(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this.#Ge(s,!0)||e){const{hash:t,page:i,rotation:s}=this.#Xe(!0);return!t||n||e?void this.#Ze(null,!0):void this.#Ze({hash:t,page:i,rotation:s},!0)}const a=s.destination;this.#Ke(a,s.uid,!0),void 0!==a.rotation&&(this._initialRotation=a.rotation),a.dest?(this._initialBookmark=JSON.stringify(a.dest),this._destination.page=null):a.hash?this._initialBookmark=a.hash:a.page&&(this._initialBookmark=`page=${a.page}`)}reset(){this._initialized&&(this.#qe(),this._initialized=!1,this.#Ye()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:t=null,explicitDest:e,pageNumber:i}){if(!this._initialized)return;if(t&&"string"!=typeof t)return;if(!Array.isArray(e))return;if(!this.#Qe(i)&&(null!==i||this._destination))return;const n=t||JSON.stringify(e);if(!n)return;let s=!1;if(this._destination&&(function(t,e){if("string"!=typeof t||"string"!=typeof e)return!1;if(t===e)return!0;if(wt(t).get("nameddest")===e)return!0;return!1}(this._destination.hash,n)||function(t,e){function i(t,e){if(typeof t!=typeof e)return!1;if(Array.isArray(t)||Array.isArray(e))return!1;if(null!==t&&"object"==typeof t&&null!==e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!i(t[n],e[n]))return!1;return!0}return t===e||Number.isNaN(t)&&Number.isNaN(e)}if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(let n=0,s=t.length;n<s;n++)if(!i(t[n],e[n]))return!1;return!0}(this._destination.dest,e))){if(this._destination.page)return;s=!0}this._popStateInProgress&&!s||(this.#Ze({dest:e,hash:n,page:i,rotation:this.linkService.rotation},s),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1}))))}pushPage(t){this._initialized&&this.#Qe(t)&&this._destination?.page!==t&&(this._popStateInProgress||(this.#Ze({dest:null,hash:`page=${t}`,page:t,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1})))))}pushCurrentPosition(){this._initialized&&!this._popStateInProgress&&this.#Je()}back(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this.#Ge(t)&&t.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this.#Ge(t)&&t.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}#Ze(t,e=!1){const i=e||!this._destination,n={fingerprint:this._fingerprint,uid:i?this._uid:this._uid+1,destination:t};let s;if(this.#Ke(t,n.uid),this._updateUrl&&t?.hash){const{href:e,protocol:i}=document.location;"file:"!==i&&(s=G(e,t.hash))}i?window.history.replaceState(n,"",s):window.history.pushState(n,"",s)}#Je(t=!1){if(!this._position)return;let e=this._position;if(t&&(e=Object.assign(Object.create(null),this._position),e.temporary=!0),!this._destination)return void this.#Ze(e);if(this._destination.temporary)return void this.#Ze(e,!0);if(this._destination.hash===e.hash)return;if(!this._destination.page&&this._numPositionUpdates<=50)return;let i=!1;if(this._destination.page>=e.first&&this._destination.page<=e.page){if(void 0!==this._destination.dest||!this._destination.first)return;i=!0}this.#Ze(e,i)}#Qe(t){return Number.isInteger(t)&&t>0&&t<=this.linkService.pagesCount}#Ge(t,e=!1){if(!t)return!1;if(t.fingerprint!==this._fingerprint){if(!e)return!1;{if("string"!=typeof t.fingerprint||t.fingerprint.length!==this._fingerprint.length)return!1;const[e]=performance.getEntriesByType("navigation");if("reload"!==e?.type)return!1}}return!(!Number.isInteger(t.uid)||t.uid<0)&&(null!==t.destination&&"object"==typeof t.destination)}#Ke(t,e,i=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),i&&t?.temporary&&delete t.temporary,this._destination=t,this._uid=e,this._maxUid=Math.max(this._maxUid,e),this._numPositionUpdates=0}#Xe(t=!1){const e=unescape(En()).substring(1),i=wt(e),n=i.get("nameddest")||"";let s=0|i.get("page");return(!this.#Qe(s)||t&&n.length>0)&&(s=null),{hash:e,page:s,rotation:this.linkService.rotation}}#ti({location:t}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:t.pdfOpenParams.substring(1),page:this.linkService.page,first:t.pageNumber,rotation:t.rotation},this._popStateInProgress||(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout((()=>{this._popStateInProgress||this.#Je(!0),this._updateViewareaTimeout=null}),1e3))}#ei({state:t}){const e=En(),i=this._currentHash!==e;if(this._currentHash=e,!t){this._uid++;const{hash:t,page:e,rotation:i}=this.#Xe();return void this.#Ze({hash:t,page:e,rotation:i},!0)}if(!this.#Ge(t))return;this._popStateInProgress=!0,i&&(this._blockHashChange++,ee({target:window,name:"hashchange",delay:1e3}).then((()=>{this._blockHashChange--})));const n=t.destination;this.#Ke(n,t.uid,!0),At(n.rotation)&&(this.linkService.rotation=n.rotation),n.dest?this.linkService.goToDestination(n.dest):n.hash?this.linkService.setHash(n.hash):n.page&&(this.linkService.page=n.page),Promise.resolve().then((()=>{this._popStateInProgress=!1}))}#qe(){this._destination&&!this._destination.temporary||this.#Je()}#$e(){if(this.#We)return;this.#We=new AbortController;const{signal:t}=this.#We;this.eventBus._on("updateviewarea",this.#ti.bind(this),{signal:t}),window.addEventListener("popstate",this.#ei.bind(this),{signal:t}),window.addEventListener("pagehide",this.#qe.bind(this),{signal:t})}#Ye(){this.#We?.abort(),this.#We=null}}class xn extends Oi{constructor(t){super(t),this.eventBus._on("optionalcontentconfigchanged",(t=>{this.#ii(t.promise)})),this.eventBus._on("resetlayers",(()=>{this.#ii()})),this.eventBus._on("togglelayerstree",this._toggleAllTreeItems.bind(this))}reset(){super.reset(),this._optionalContentConfig=null,this._optionalContentVisibility?.clear(),this._optionalContentVisibility=null}_dispatchEvent(t){this.eventBus.dispatch("layersloaded",{source:this,layersCount:t})}_bindLink(t,{groupId:e,input:i}){const n=()=>{const t=i.checked;this._optionalContentConfig.setVisibility(e,t);const n=this._optionalContentVisibility.get(e);n&&(n.visible=t),this.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(this._optionalContentConfig)})};t.onclick=e=>e.target===i?(n(),!0):e.target!==t||(i.checked=!i.checked,n(),!1)}_setNestedName(t,{name:e=null}){"string"!=typeof e?(t.setAttribute("data-l10n-id","pdfjs-additional-layers"),t.style.fontStyle="italic",this._l10n.translateOnce(t)):t.textContent=this._normalizeTextContent(e)}_addToggleButton(t,{name:e=null}){super._addToggleButton(t,null===e)}_toggleAllTreeItems(){this._optionalContentConfig&&super._toggleAllTreeItems()}render({optionalContentConfig:t,pdfDocument:e}){this._optionalContentConfig&&this.reset(),this._optionalContentConfig=t||null,this._pdfDocument=e||null;const i=t?.getOrder();if(!i)return void this._dispatchEvent(0);this._optionalContentVisibility=new Map;const n=document.createDocumentFragment(),s=[{parent:n,groups:i}];let a=0,r=!1;for(;s.length>0;){const e=s.shift();for(const i of e.groups){const n=document.createElement("div");n.className="treeItem";const o=document.createElement("a");if(n.append(o),"object"==typeof i){r=!0,this._addToggleButton(n,i),this._setNestedName(o,i);const t=document.createElement("div");t.className="treeItems",n.append(t),s.push({parent:t,groups:i.order})}else{const e=t.getGroup(i),n=document.createElement("input");this._bindLink(o,{groupId:i,input:n}),n.type="checkbox",n.checked=e.visible,this._optionalContentVisibility.set(i,{input:n,visible:n.checked});const s=document.createElement("label");s.textContent=this._normalizeTextContent(e.name),s.append(n),o.append(s),a++}e.parent.append(n)}}this._finishRendering(n,a,r)}async#ii(t=null){if(!this._optionalContentConfig)return;const e=this._pdfDocument,i=await(t||e.getOptionalContentConfig({intent:"display"}));if(e===this._pdfDocument)if(t)for(const[t,e]of this._optionalContentVisibility){const n=i.getGroup(t);n&&e.visible!==n.visible&&(e.input.checked=e.visible=!e.visible)}else this.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(i)}),this.render({optionalContentConfig:i,pdfDocument:this._pdfDocument})}}class Tn extends Oi{constructor(t){super(t),this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.eventBus._on("toggleoutlinetree",this._toggleAllTreeItems.bind(this)),this.eventBus._on("currentoutlineitem",this._currentOutlineItem.bind(this)),this.eventBus._on("pagechanging",(t=>{this._currentPageNumber=t.pageNumber})),this.eventBus._on("pagesloaded",(t=>{this._isPagesLoaded=!!t.pagesCount,this._currentOutlineItemCapability?.resolve(this._isPagesLoaded)})),this.eventBus._on("sidebarviewchanged",(t=>{this._sidebarView=t.view}))}reset(){super.reset(),this._outline=null,this._pageNumberToDestHashCapability=null,this._currentPageNumber=1,this._isPagesLoaded=null,this._currentOutlineItemCapability?.resolve(!1),this._currentOutlineItemCapability=null}_dispatchEvent(t){this._currentOutlineItemCapability=Promise.withResolvers(),0===t||this._pdfDocument?.loadingParams.disableAutoFetch?this._currentOutlineItemCapability.resolve(!1):null!==this._isPagesLoaded&&this._currentOutlineItemCapability.resolve(this._isPagesLoaded),this.eventBus.dispatch("outlineloaded",{source:this,outlineCount:t,currentOutlineItemPromise:this._currentOutlineItemCapability.promise})}_bindLink(t,{url:e,newWindow:i,action:n,attachment:s,dest:a,setOCGState:r}){const{linkService:o}=this;if(e)o.addLinkAttributes(t,e,i);else{if(n)return t.href=o.getAnchorUrl(""),void(t.onclick=()=>(o.executeNamedAction(n),!1));if(s)return t.href=o.getAnchorUrl(""),void(t.onclick=()=>(this.downloadManager.openOrDownloadData(s.content,s.filename),!1));if(r)return t.href=o.getAnchorUrl(""),void(t.onclick=()=>(o.executeSetOCGState(r),!1));t.href=o.getDestinationHash(a),t.onclick=t=>(this._updateCurrentTreeItem(t.target.parentNode),a&&o.goToDestination(a),!1)}}_setStyles(t,{bold:e,italic:i}){e&&(t.style.fontWeight="bold"),i&&(t.style.fontStyle="italic")}_addToggleButton(t,{count:e,items:i}){let n=!1;if(e<0){let t=i.length;if(t>0){const e=[...i];for(;e.length>0;){const{count:i,items:n}=e.shift();i>0&&n.length>0&&(t+=n.length,e.push(...n))}}Math.abs(e)===t&&(n=!0)}super._addToggleButton(t,n)}_toggleAllTreeItems(){this._outline&&super._toggleAllTreeItems()}render({outline:t,pdfDocument:e}){if(this._outline&&this.reset(),this._outline=t||null,this._pdfDocument=e||null,!t)return void this._dispatchEvent(0);const i=document.createDocumentFragment(),n=[{parent:i,items:t}];let s=0,a=!1;for(;n.length>0;){const t=n.shift();for(const e of t.items){const i=document.createElement("div");i.className="treeItem";const r=document.createElement("a");if(this._bindLink(r,e),this._setStyles(r,e),r.textContent=this._normalizeTextContent(e.title),i.append(r),e.items.length>0){a=!0,this._addToggleButton(i,e);const t=document.createElement("div");t.className="treeItems",i.append(t),n.push({parent:t,items:e.items})}t.parent.append(i),s++}}this._finishRendering(i,s,a)}async _currentOutlineItem(){if(!this._isPagesLoaded)throw new Error("_currentOutlineItem: All pages have not been loaded.");if(!this._outline||!this._pdfDocument)return;const t=await this._getPageNumberToDestHash(this._pdfDocument);if(t&&(this._updateCurrentTreeItem(null),this._sidebarView===rt))for(let e=this._currentPageNumber;e>0;e--){const i=t.get(e);if(!i)continue;const n=this.container.querySelector(`a[href="${i}"]`);if(n){this._scrollToCurrentTreeItem(n.parentNode);break}}}async _getPageNumberToDestHash(t){if(this._pageNumberToDestHashCapability)return this._pageNumberToDestHashCapability.promise;this._pageNumberToDestHashCapability=Promise.withResolvers();const e=new Map,i=new Map,n=[{nesting:0,items:this._outline}];for(;n.length>0;){const s=n.shift(),a=s.nesting;for(const{dest:r,items:o}of s.items){let s,l;if("string"==typeof r){if(s=await t.getDestination(r),t!==this._pdfDocument)return null}else s=r;if(Array.isArray(s)){const[n]=s;if(n&&"object"==typeof n?l=t.cachedPageNumber(n):Number.isInteger(n)&&(l=n+1),Number.isInteger(l)&&(!e.has(l)||a>i.get(l))){const t=this.linkService.getDestinationHash(r);e.set(l,t),i.set(l,a)}}o.length>0&&n.push({nesting:a+1,items:o})}}return this._pageNumberToDestHashCapability.resolve(e.size>0?e:null),this._pageNumberToDestHashCapability.promise}}const An="pdfPresentationMode",Ln="pdfPresentationModeControls",In=Math.PI/6;class Mn{#Pe=J;#ni=null;#si=null;#ai=null;constructor({container:t,pdfViewer:e,eventBus:i}){this.container=t,this.pdfViewer=e,this.eventBus=i,this.contextMenuOpen=!1,this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0,this.touchSwipeState=null}async request(){const{container:t,pdfViewer:e}=this;if(this.active||!e.pagesCount||!t.requestFullscreen)return!1;this.#ri(),this.#oi(et);const i=t.requestFullscreen();this.#ni={pageNumber:e.currentPageNumber,scaleValue:e.currentScaleValue,scrollMode:e.scrollMode,spreadMode:null,annotationEditorMode:null},e.spreadMode===gt.NONE||e.pageViewsReady&&e.hasEqualPageSizes||(this.#ni.spreadMode=e.spreadMode),e.annotationEditorMode!==n.DISABLE&&(this.#ni.annotationEditorMode=e.annotationEditorMode);try{return await i,e.focus(),!0}catch{this.#li(),this.#oi(tt)}return!1}get active(){return this.#Pe===et||this.#Pe===it}#di(t){if(!this.active)return;t.preventDefault();const e=function(t){const e=t.deltaMode;let i=Tt(t);return e===WheelEvent.DOM_DELTA_PIXEL?i/=900:e===WheelEvent.DOM_DELTA_LINE&&(i/=30),i}(t),i=Date.now(),n=this.mouseScrollTimeStamp;if(!(i>n&&i-n<50)&&((this.mouseScrollDelta>0&&e<0||this.mouseScrollDelta<0&&e>0)&&this.#hi(),this.mouseScrollDelta+=e,Math.abs(this.mouseScrollDelta)>=.1)){const t=this.mouseScrollDelta;this.#hi();(t>0?this.pdfViewer.previousPage():this.pdfViewer.nextPage())&&(this.mouseScrollTimeStamp=i)}}#oi(t){this.#Pe=t,this.eventBus.dispatch("presentationmodechanged",{source:this,state:t})}#ci(){this.#oi(it),this.container.classList.add(An),setTimeout((()=>{this.pdfViewer.scrollMode=ut.PAGE,null!==this.#ni.spreadMode&&(this.pdfViewer.spreadMode=gt.NONE),this.pdfViewer.currentPageNumber=this.#ni.pageNumber,this.pdfViewer.currentScaleValue="page-fit",null!==this.#ni.annotationEditorMode&&(this.pdfViewer.annotationEditorMode={mode:n.NONE})}),0),this.#ui(),this.#gi(),this.contextMenuOpen=!1,document.getSelection().empty()}#pi(){const t=this.pdfViewer.currentPageNumber;this.container.classList.remove(An),setTimeout((()=>{this.#li(),this.#oi(tt),this.pdfViewer.scrollMode=this.#ni.scrollMode,null!==this.#ni.spreadMode&&(this.pdfViewer.spreadMode=this.#ni.spreadMode),this.pdfViewer.currentScaleValue=this.#ni.scaleValue,this.pdfViewer.currentPageNumber=t,null!==this.#ni.annotationEditorMode&&(this.pdfViewer.annotationEditorMode={mode:this.#ni.annotationEditorMode}),this.#ni=null}),0),this.#mi(),this.#fi(),this.#hi(),this.contextMenuOpen=!1}#bi(t){if(this.contextMenuOpen)return this.contextMenuOpen=!1,void t.preventDefault();0===t.button&&(t.target.href&&t.target.parentNode?.hasAttribute("data-internal-link")||(t.preventDefault(),t.shiftKey?this.pdfViewer.previousPage():this.pdfViewer.nextPage()))}#vi(){this.contextMenuOpen=!0}#gi(){this.controlsTimeout?clearTimeout(this.controlsTimeout):this.container.classList.add(Ln),this.controlsTimeout=setTimeout((()=>{this.container.classList.remove(Ln),delete this.controlsTimeout}),3e3)}#fi(){this.controlsTimeout&&(clearTimeout(this.controlsTimeout),this.container.classList.remove(Ln),delete this.controlsTimeout)}#hi(){this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0}#wi(t){if(this.active)if(t.touches.length>1)this.touchSwipeState=null;else switch(t.type){case"touchstart":this.touchSwipeState={startX:t.touches[0].pageX,startY:t.touches[0].pageY,endX:t.touches[0].pageX,endY:t.touches[0].pageY};break;case"touchmove":if(null===this.touchSwipeState)return;this.touchSwipeState.endX=t.touches[0].pageX,this.touchSwipeState.endY=t.touches[0].pageY,t.preventDefault();break;case"touchend":if(null===this.touchSwipeState)return;let e=0;const i=this.touchSwipeState.endX-this.touchSwipeState.startX,n=this.touchSwipeState.endY-this.touchSwipeState.startY,s=Math.abs(Math.atan2(n,i));Math.abs(i)>50&&(s<=In||s>=Math.PI-In)?e=i:Math.abs(n)>50&&Math.abs(s-Math.PI/2)<=In&&(e=n),e>0?this.pdfViewer.previousPage():e<0&&this.pdfViewer.nextPage()}}#ui(){if(this.#ai)return;this.#ai=new AbortController;const{signal:t}=this.#ai,e=this.#wi.bind(this);window.addEventListener("mousemove",this.#gi.bind(this),{signal:t}),window.addEventListener("mousedown",this.#bi.bind(this),{signal:t}),window.addEventListener("wheel",this.#di.bind(this),{passive:!1,signal:t}),window.addEventListener("keydown",this.#hi.bind(this),{signal:t}),window.addEventListener("contextmenu",this.#vi.bind(this),{signal:t}),window.addEventListener("touchstart",e,{signal:t}),window.addEventListener("touchmove",e,{signal:t}),window.addEventListener("touchend",e,{signal:t})}#mi(){this.#ai?.abort(),this.#ai=null}#ri(){this.#si||(this.#si=new AbortController,window.addEventListener("fullscreenchange",(()=>{document.fullscreenElement?this.#ci():this.#pi()}),{signal:this.#si.signal}))}#li(){this.#si?.abort(),this.#si=null}}class kn{constructor({pdfPage:t,annotationStorage:e=null,linkService:i,xfaHtml:n=null}){this.pdfPage=t,this.annotationStorage=e,this.linkService=i,this.xfaHtml=n,this.div=null,this._cancelled=!1}async render({viewport:t,intent:e="display"}){if("print"===e){const i={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:e};return this.div=document.createElement("div"),i.div=this.div,q.render(i)}const i=await this.pdfPage.getXfa();if(this._cancelled||!i)return{textDivs:[]};const n={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:i,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:e};return this.div?q.update(n):(this.div=document.createElement("div"),n.div=this.div,q.render(n))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}let Bn=null,Dn=null,Nn=null,Vn={initialized:!1};class On{constructor({pdfDocument:t,pagesOverview:e,printContainer:i,printResolution:n,printAnnotationStoragePromise:s=null}){this.pdfDocument=t,this.pagesOverview=e,this.printContainer=i,this._printResolution=n||150,this._optionalContentConfigPromise=t.getOptionalContentConfig({intent:"print"}),this._printAnnotationStoragePromise=s||Promise.resolve(),this.currentPage=-1,this.scratchCanvas=document.createElement("canvas")}layout(){this.throwIfInactive();const t=document.querySelector("body");t.setAttribute("data-pdfjsprinting",!0);const{width:e,height:i}=this.pagesOverview[0];this.pagesOverview.every((t=>t.width===e&&t.height===i));this.pageStyleSheet=document.createElement("style"),this.pageStyleSheet.textContent=`@page { size: ${e}pt ${i}pt;}`,t.append(this.pageStyleSheet)}destroy(){if(Bn!==this)return;this.printContainer.textContent="";document.querySelector("body").removeAttribute("data-pdfjsprinting"),this.pageStyleSheet&&(this.pageStyleSheet.remove(),this.pageStyleSheet=null),this.scratchCanvas.width=this.scratchCanvas.height=0,this.scratchCanvas=null,Bn=null,zn().then((function(){Nn.closeIfActive(Dn)}))}renderPages(){if(this.pdfDocument.isPureXfa)return function(t,e){const i=e.allXfaHtml,n=new Qt,s=Math.round(100*V.PDF_TO_CSS_UNITS)/100;for(const a of i.children){const i=document.createElement("div");i.className="xfaPrintedPage",t.append(i);const r=new kn({pdfPage:null,annotationStorage:e.annotationStorage,linkService:n,xfaHtml:a}),o=w(a,{scale:s});r.render({viewport:o,intent:"print"}),i.append(r.div)}}(this.printContainer,this.pdfDocument),Promise.resolve();const t=this.pagesOverview.length,e=(i,n)=>{if(this.throwIfInactive(),++this.currentPage>=t)return Un(t,t),void i();const s=this.currentPage;Un(s,t),function(t,e,i,n,s,a,o){const l=Bn.scratchCanvas,d=s/V.PDF;l.width=Math.floor(n.width*d),l.height=Math.floor(n.height*d);const h=l.getContext("2d");return h.save(),h.fillStyle="rgb(255, 255, 255)",h.fillRect(0,0,l.width,l.height),h.restore(),Promise.all([e.getPage(i),o]).then((function([t,e]){const i={canvasContext:h,transform:[d,0,0,d,0,0],viewport:t.getViewport({scale:1,rotation:n.rotation}),intent:"print",annotationMode:r.ENABLE_STORAGE,optionalContentConfigPromise:a,printAnnotationStorage:e};return t.render(i).promise.catch((t=>{throw t}))}))}(0,this.pdfDocument,s+1,this.pagesOverview[s],this._printResolution,this._optionalContentConfigPromise,this._printAnnotationStoragePromise).then(this.useRenderedPage.bind(this)).then((function(){e(i,n)}),n)};return new Promise(e)}useRenderedPage(){this.throwIfInactive();const t=document.createElement("img");this.scratchCanvas.toBlob((e=>{t.src=URL.createObjectURL(e)}));const e=document.createElement("div");e.className="printedPage",e.append(t),this.printContainer.append(e);const{promise:i,resolve:n,reject:s}=Promise.withResolvers();return t.onload=n,t.onerror=s,i.catch((()=>{})).then((()=>{URL.revokeObjectURL(t.src)})),i}performPrint(){return this.throwIfInactive(),new Promise((t=>{setTimeout((()=>{this.active?(jn.call(window),setTimeout(t,20)):t()}),0)}))}get active(){return this===Bn}throwIfInactive(){if(!this.active)throw new Error("This print request was cancelled or completed.")}}const jn=window.print;function Fn(t){const e=new CustomEvent(t,{bubbles:!1,cancelable:!1,detail:"custom"});window.dispatchEvent(e)}function Rn(){Bn&&(Bn.destroy(),Fn("afterprint"))}function Un(t,e){Dn||=document.getElementById("printServiceDialog");const i=Math.round(100*t/e),n=Dn.querySelector("progress"),s=Dn.querySelector(".relative-progress");n.value=i,s.setAttribute("data-l10n-args",JSON.stringify({progress:i}))}if(window.print=function(){if(!Bn){zn().then((function(){Bn&&Nn.open(Dn)}));try{Fn("beforeprint")}finally{if(Bn){const t=Bn;Bn.renderPages().then((()=>t.performPrint())).catch((()=>{})).then((()=>{t.active&&Rn()}))}else zn().then((function(){Nn.closeIfActive(Dn)}))}}},window.addEventListener("keydown",(function(t){80!==t.keyCode||!t.ctrlKey&&!t.metaKey||t.altKey||t.shiftKey&&!window.chrome&&!window.opera||(window.print(),t.preventDefault(),t.stopImmediatePropagation())}),!0),"onbeforeprint"in window){const t=function(t){"custom"!==t.detail&&t.stopImmediatePropagation()};window.addEventListener("beforeprint",t),window.addEventListener("afterprint",t)}let Hn;function zn(){if(!Hn){if(Nn=Vn.overlayManager,!Nn)throw new Error("The overlay manager has not yet been initialized.");Dn||=document.getElementById("printServiceDialog"),Hn=Nn.register(Dn,!0),document.getElementById("printCancel").onclick=Rn,Dn.addEventListener("close",Rn)}return Hn}class Wn{static initGlobals(t){Vn=t}static get supportsPrinting(){return R(this,"supportsPrinting",!0)}static createPrintService(t){if(Bn)throw new Error("The print service is created and active.");return Bn=new On(t)}}class $n{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(t){this.pdfViewer=t}setThumbnailViewer(t){this.pdfThumbnailViewer=t}isHighestPriority(t){return this.highestPriorityPage===t.renderingId}renderHighestPriority(t){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),this.pdfViewer.forceRendering(t)||this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),3e4))}getHighestPriority(t,e,i,n=!1,s=!1){const a=t.views,r=a.length;if(0===r)return null;for(let t=0;t<r;t++){const e=a[t].view;if(!this.isViewFinished(e))return e}if(!s)for(let t=0;t<r;t++){const{detailView:e}=a[t].view;if(e&&!this.isViewFinished(e))return e}const o=t.first.id,l=t.last.id;if(l-o+1>r){const n=t.ids;for(let t=1,s=l-o;t<s;t++){const s=i?o+t:l-t;if(n.has(s))continue;const a=e[s-1];if(!this.isViewFinished(a))return a}}let d=i?l:o-2,h=e[d];return h&&!this.isViewFinished(h)||n&&(d+=i?1:-1,h=e[d],h&&!this.isViewFinished(h))?h:null}isViewFinished(t){return t.renderingState===Q.FINISHED}renderView(t){switch(t.renderingState){case Q.FINISHED:return!1;case Q.PAUSED:this.highestPriorityPage=t.renderingId,t.resume();break;case Q.RUNNING:this.highestPriorityPage=t.renderingId;break;case Q.INITIAL:this.highestPriorityPage=t.renderingId,t.draw().finally((()=>{this.renderHighestPriority()})).catch((t=>{}))}return!0}}class Gn{#yi=null;#Ci=null;#Pi=null;#We=null;#y=null;#Si=null;#Ei=null;#_i=null;#xi=!1;#Ti=null;#Ai=null;constructor({eventBus:t,externalServices:e=null,docProperties:i=null}){this.#y=t,this.#Si=e,this.#Pi=i}setViewer(t){this.#_i=t}async setDocument(t){if(this.#Ei&&await this.#Li(),this.#Ei=t,!t)return;const[e,i,n]=await Promise.all([t.getFieldObjects(),t.getCalculationOrderIds(),t.getJSActions()]);if(!e&&!n)return void await this.#Li();if(t!==this.#Ei)return;try{this.#Ti=this.#Ii()}catch(t){return void await this.#Li()}const s=this.#y;this.#We=new AbortController;const{signal:a}=this.#We;s._on("updatefromsandbox",(t=>{t?.source===window&&this.#Mi(t.detail)}),{signal:a}),s._on("dispatcheventinsandbox",(t=>{this.#Ti?.dispatchEventInSandbox(t.detail)}),{signal:a}),s._on("pagechanging",(({pageNumber:t,previous:e})=>{t!==e&&(this.#ki(e),this.#Bi(t))}),{signal:a}),s._on("pagerendered",(({pageNumber:t})=>{this._pageOpenPending.has(t)&&t===this.#_i.currentPageNumber&&this.#Bi(t)}),{signal:a}),s._on("pagesdestroy",(async()=>{await this.#ki(this.#_i.currentPageNumber),await(this.#Ti?.dispatchEventInSandbox({id:"doc",name:"WillClose"})),this.#yi?.resolve()}),{signal:a});try{const a=await this.#Pi(t);if(t!==this.#Ei)return;await this.#Ti.createSandbox({objects:e,calculationOrder:i,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...a,actions:n}}),s.dispatch("sandboxcreated",{source:this})}catch(t){return void await this.#Li()}await(this.#Ti?.dispatchEventInSandbox({id:"doc",name:"Open"})),await this.#Bi(this.#_i.currentPageNumber,!0),Promise.resolve().then((()=>{t===this.#Ei&&(this.#xi=!0)}))}async dispatchWillSave(){return this.#Ti?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){return this.#Ti?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){if(this.#Ti){await(this.#Ai?.promise),this.#Ai=Promise.withResolvers();try{await this.#Ti.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(t){throw this.#Ai.resolve(),this.#Ai=null,t}await this.#Ai.promise}}async dispatchDidPrint(){return this.#Ti?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){return this.#Ci?.promise||null}get ready(){return this.#xi}get _pageOpenPending(){return R(this,"_pageOpenPending",new Set)}get _visitedPages(){return R(this,"_visitedPages",new Map)}async#Mi(t){const e=this.#_i,i=e.isInPresentationMode||e.isChangingPresentationMode,{id:n,siblings:s,command:a,value:r}=t;if(!n){switch(a){case"clear":case"error":case"println":break;case"layout":if(!i){const t=Vt(r);e.spreadMode=t.spreadMode}break;case"page-num":e.currentPageNumber=r+1;break;case"print":await e.pagesPromise,this.#y.dispatch("print",{source:this});break;case"zoom":i||(e.currentScaleValue=r);break;case"SaveAs":this.#y.dispatch("download",{source:this});break;case"FirstPage":e.currentPageNumber=1;break;case"LastPage":e.currentPageNumber=e.pagesCount;break;case"NextPage":e.nextPage();break;case"PrevPage":e.previousPage();break;case"ZoomViewIn":i||e.increaseScale();break;case"ZoomViewOut":i||e.decreaseScale();break;case"WillPrintFinished":this.#Ai?.resolve(),this.#Ai=null}return}if(i&&t.focus)return;delete t.id,delete t.siblings;const o=s?[n,...s]:[n];for(const e of o){const i=document.querySelector(`[data-element-id="${e}"]`);i?i.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:t})):this.#Ei?.annotationStorage.setValue(e,t)}}async#Bi(t,e=!1){const i=this.#Ei,n=this._visitedPages;if(e&&(this.#yi=Promise.withResolvers()),!this.#yi)return;const s=this.#_i.getPageView(t-1);if(s?.renderingState!==Q.FINISHED)return void this._pageOpenPending.add(t);this._pageOpenPending.delete(t);const a=(async()=>{const e=await(n.has(t)?null:s.pdfPage?.getJSActions());i===this.#Ei&&await(this.#Ti?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:t,actions:e}))})();n.set(t,a)}async#ki(t){const e=this.#Ei,i=this._visitedPages;if(!this.#yi)return;if(this._pageOpenPending.has(t))return;const n=i.get(t);n&&(i.set(t,null),await n,e===this.#Ei&&await(this.#Ti?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:t})))}#Ii(){if(this.#Ci=Promise.withResolvers(),this.#Ti)throw new Error("#initScripting: Scripting already exists.");return this.#Si.createScripting()}async#Li(){if(!this.#Ti)return this.#Ei=null,void this.#Ci?.resolve();this.#yi&&(await Promise.race([this.#yi.promise,new Promise((t=>{setTimeout(t,1e3)}))]).catch((()=>{})),this.#yi=null),this.#Ei=null;try{await this.#Ti.destroySandbox()}catch{}this.#Ai?.reject(new Error("Scripting destroyed.")),this.#Ai=null,this.#We?.abort(),this.#We=null,this._pageOpenPending.clear(),this._visitedPages.clear(),this.#Ti=null,this.#xi=!1,this.#Ci?.resolve()}}const Xn="sidebarResizing",Zn="pdfSidebarNotification";class Kn{#p=!1;#Di=null;#Ni=null;#Vi=null;constructor({elements:t,eventBus:e,l10n:i}){this.isOpen=!1,this.active=at,this.isInitialViewSet=!1,this.isInitialEventDispatched=!1,this.onToggled=null,this.onUpdateThumbnails=null,this.outerContainer=t.outerContainer,this.sidebarContainer=t.sidebarContainer,this.toggleButton=t.toggleButton,this.resizer=t.resizer,this.thumbnailButton=t.thumbnailButton,this.outlineButton=t.outlineButton,this.attachmentsButton=t.attachmentsButton,this.layersButton=t.layersButton,this.thumbnailView=t.thumbnailView,this.outlineView=t.outlineView,this.attachmentsView=t.attachmentsView,this.layersView=t.layersView,this._currentOutlineItemButton=t.currentOutlineItemButton,this.eventBus=e,this.#p="rtl"===i.getDirection(),this.#ge()}reset(){this.isInitialViewSet=!1,this.isInitialEventDispatched=!1,this.#Oi(!0),this.switchView(at),this.outlineButton.disabled=!1,this.attachmentsButton.disabled=!1,this.layersButton.disabled=!1,this._currentOutlineItemButton.disabled=!0}get visibleView(){return this.isOpen?this.active:st}setInitialView(t=st){this.isInitialViewSet||(this.isInitialViewSet=!0,t!==st&&t!==nt?(this.switchView(t,!0),this.isInitialEventDispatched||this.#ji()):this.#ji())}switchView(t,e=!1){const i=t!==this.active;let n=!1;switch(t){case st:return void(this.isOpen&&this.close());case at:this.isOpen&&i&&(n=!0);break;case rt:if(this.outlineButton.disabled)return;break;case ot:if(this.attachmentsButton.disabled)return;break;case lt:if(this.layersButton.disabled)return;break;default:return}this.active=t,Ot(this.thumbnailButton,t===at,this.thumbnailView),Ot(this.outlineButton,t===rt,this.outlineView),Ot(this.attachmentsButton,t===ot,this.attachmentsView),Ot(this.layersButton,t===lt,this.layersView),!e||this.isOpen?(n&&(this.onUpdateThumbnails(),this.onToggled()),i&&this.#ji()):this.open()}open(){this.isOpen||(this.isOpen=!0,jt(this.toggleButton,!0),this.outerContainer.classList.add("sidebarMoving","sidebarOpen"),this.active===at&&this.onUpdateThumbnails(),this.onToggled(),this.#ji(),this.#Oi())}close(t=null){this.isOpen&&(this.isOpen=!1,jt(this.toggleButton,!1),this.outerContainer.classList.add("sidebarMoving"),this.outerContainer.classList.remove("sidebarOpen"),this.onToggled(),this.#ji(),t?.detail>0&&this.toggleButton.blur())}toggle(t=null){this.isOpen?this.close(t):this.open()}#ji(){this.isInitialViewSet&&(this.isInitialEventDispatched||=!0),this.eventBus.dispatch("sidebarviewchanged",{source:this,view:this.visibleView})}#Fi(){this.toggleButton.setAttribute("data-l10n-id","pdfjs-toggle-sidebar-notification-button"),this.isOpen||this.toggleButton.classList.add(Zn)}#Oi(t=!1){(this.isOpen||t)&&this.toggleButton.classList.remove(Zn),t&&this.toggleButton.setAttribute("data-l10n-id","pdfjs-toggle-sidebar-button")}#ge(){const{eventBus:t,outerContainer:e}=this;this.sidebarContainer.addEventListener("transitionend",(i=>{i.target===this.sidebarContainer&&(e.classList.remove("sidebarMoving"),t.dispatch("resize",{source:this}))})),this.toggleButton.addEventListener("click",(t=>{this.toggle(t)})),this.thumbnailButton.addEventListener("click",(()=>{this.switchView(at)})),this.outlineButton.addEventListener("click",(()=>{this.switchView(rt)})),this.outlineButton.addEventListener("dblclick",(()=>{t.dispatch("toggleoutlinetree",{source:this})})),this.attachmentsButton.addEventListener("click",(()=>{this.switchView(ot)})),this.layersButton.addEventListener("click",(()=>{this.switchView(lt)})),this.layersButton.addEventListener("dblclick",(()=>{t.dispatch("resetlayers",{source:this})})),this._currentOutlineItemButton.addEventListener("click",(()=>{t.dispatch("currentoutlineitem",{source:this})}));const i=(t,e,i)=>{e.disabled=!t,t?this.#Fi():this.active===i&&this.switchView(at)};t._on("outlineloaded",(t=>{i(t.outlineCount,this.outlineButton,rt),t.currentOutlineItemPromise.then((t=>{this.isInitialViewSet&&(this._currentOutlineItemButton.disabled=!t)}))})),t._on("attachmentsloaded",(t=>{i(t.attachmentsCount,this.attachmentsButton,ot)})),t._on("layersloaded",(t=>{i(t.layersCount,this.layersButton,lt)})),t._on("presentationmodechanged",(t=>{t.state===tt&&this.visibleView===at&&this.onUpdateThumbnails()})),this.resizer.addEventListener("mousedown",(t=>{if(0!==t.button)return;e.classList.add(Xn),this.#Di=new AbortController;const i={signal:this.#Di.signal};window.addEventListener("mousemove",this.#Ri.bind(this),i),window.addEventListener("mouseup",this.#Ui.bind(this),i),window.addEventListener("blur",this.#Ui.bind(this),i)})),t._on("resize",(i=>{if(i.source!==window)return;if(this.#Ni=null,!this.#Vi)return;if(!this.isOpen)return void this.#Hi(this.#Vi);e.classList.add(Xn);const n=this.#Hi(this.#Vi);Promise.resolve().then((()=>{e.classList.remove(Xn),n&&t.dispatch("resize",{source:this})}))}))}get outerContainerWidth(){return this.#Ni||=this.outerContainer.clientWidth}#Hi(t=0){const e=Math.floor(this.outerContainerWidth/2);return t>e&&(t=e),t<200&&(t=200),t!==this.#Vi&&(this.#Vi=t,Bt.setProperty("--sidebar-width",`${t}px`),!0)}#Ri(t){let e=t.clientX;this.#p&&(e=this.outerContainerWidth-e),this.#Hi(e)}#Ui(t){this.outerContainer.classList.remove(Xn),this.eventBus.dispatch("resize",{source:this}),this.#Di?.abort(),this.#Di=null}}function qn(t){t.width=0,t.height=0}class Yn{static#zi=null;static getCanvas(t,e){const i=this.#zi||=document.createElement("canvas");i.width=t,i.height=e;const n=i.getContext("2d",{alpha:!1});return n.save(),n.fillStyle="rgb(255, 255, 255)",n.fillRect(0,0,t,e),n.restore(),[i,i.getContext("2d")]}static destroyCanvas(){this.#zi&&qn(this.#zi),this.#zi=null}}class Qn{constructor({container:t,eventBus:e,id:i,defaultViewport:n,optionalContentConfigPromise:s,linkService:a,renderingQueue:r,maxCanvasPixels:o,maxCanvasDim:l,pageColors:d,enableHWA:h}){this.id=i,this.renderingId="thumbnail"+i,this.pageLabel=null,this.pdfPage=null,this.rotation=0,this.viewport=n,this.pdfPageRotate=n.rotation,this._optionalContentConfigPromise=s||null,this.maxCanvasPixels=o??Kt.get("maxCanvasPixels"),this.maxCanvasDim=l||Kt.get("maxCanvasDim"),this.pageColors=d||null,this.enableHWA=h||!1,this.eventBus=e,this.linkService=a,this.renderingQueue=r,this.renderTask=null,this.renderingState=Q.INITIAL,this.resume=null;const c=document.createElement("a");c.href=a.getAnchorUrl("#page="+i),c.setAttribute("data-l10n-id","pdfjs-thumb-page-title"),c.setAttribute("data-l10n-args",this.#Wi),c.onclick=function(){return a.goToPage(i),!1},this.anchor=c;const u=document.createElement("div");u.className="thumbnail",u.setAttribute("data-page-number",this.id),this.div=u,this.#$i();const g=document.createElement("div");g.className="thumbnailImage",this._placeholderImg=g,u.append(g),c.append(u),t.append(c)}#$i(){const{width:t,height:e}=this.viewport,i=t/e;this.canvasWidth=98,this.canvasHeight=this.canvasWidth/i|0,this.scale=this.canvasWidth/t;const{style:n}=this.div;n.setProperty("--thumbnail-width",`${this.canvasWidth}px`),n.setProperty("--thumbnail-height",`${this.canvasHeight}px`)}setPdfPage(t){this.pdfPage=t,this.pdfPageRotate=t.rotate;const e=(this.rotation+this.pdfPageRotate)%360;this.viewport=t.getViewport({scale:1,rotation:e}),this.reset()}reset(){this.cancelRendering(),this.renderingState=Q.INITIAL,this.div.removeAttribute("data-loaded"),this.image?.replaceWith(this._placeholderImg),this.#$i(),this.image&&(this.image.removeAttribute("src"),delete this.image)}update({rotation:t=null}){"number"==typeof t&&(this.rotation=t);const e=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:1,rotation:e}),this.reset()}cancelRendering(){this.renderTask&&(this.renderTask.cancel(),this.renderTask=null),this.resume=null}#Gi(t=1,e=this.enableHWA){const i=document.createElement("canvas"),n=i.getContext("2d",{alpha:!1,willReadFrequently:!e}),s=new I,a=t*this.canvasWidth,r=t*this.canvasHeight;s.limitCanvas(a,r,this.maxCanvasPixels,this.maxCanvasDim),i.width=a*s.sx|0,i.height=r*s.sy|0;return{ctx:n,canvas:i,transform:s.scaled?[s.sx,0,0,s.sy,0,0]:null}}#Xi(t){if(this.renderingState!==Q.FINISHED)throw new Error("#convertCanvasToImage: Rendering has not finished.");const e=this.#Zi(t),i=document.createElement("img");i.className="thumbnailImage",i.setAttribute("data-l10n-id","pdfjs-thumb-page-canvas"),i.setAttribute("data-l10n-args",this.#Wi),i.src=e.toDataURL(),this.image=i,this.div.setAttribute("data-loaded",!0),this._placeholderImg.replaceWith(i),qn(e)}async draw(){if(this.renderingState!==Q.INITIAL)return;const{pageColors:t,pdfPage:e}=this;if(!e)throw this.renderingState=Q.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Q.RUNNING;const{ctx:i,canvas:n,transform:s}=this.#Gi(2),a={canvasContext:i,transform:s,viewport:this.viewport.clone({scale:2*this.scale}),optionalContentConfigPromise:this._optionalContentConfigPromise,pageColors:t},r=this.renderTask=e.render(a);r.onContinue=t=>{if(!this.renderingQueue.isHighestPriority(this))return this.renderingState=Q.PAUSED,void(this.resume=()=>{this.renderingState=Q.RUNNING,t()});t()};let o=null;try{await r.promise}catch(t){if(t instanceof O)return void qn(n);o=t}finally{r===this.renderTask&&(this.renderTask=null)}if(this.renderingState=Q.FINISHED,this.#Xi(n),qn(n),this.eventBus.dispatch("thumbnailrendered",{source:this,pageNumber:this.id,pdfPage:e}),o)throw o}setImage(t){if(this.renderingState!==Q.INITIAL)return;const{thumbnailCanvas:e,pdfPage:i,scale:n}=t;e&&(this.pdfPage||this.setPdfPage(i),n<this.scale||(this.renderingState=Q.FINISHED,this.#Xi(e)))}#Ki(t){const e=t.width<<3,i=t.height<<3,n=new I;return n.sx=n.sy=1,n.limitCanvas(e,i,this.maxCanvasPixels,this.maxCanvasDim),[e*n.sx|0,i*n.sy|0]}#Zi(t){const{ctx:e,canvas:i}=this.#Gi(1,!0);if(t.width<=2*i.width)return e.drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),i;let[n,s]=this.#Ki(i);const[a,r]=Yn.getCanvas(n,s);for(;n>t.width||s>t.height;)n>>=1,s>>=1;for(r.drawImage(t,0,0,t.width,t.height,0,0,n,s);n>2*i.width;)r.drawImage(a,0,0,n,s,0,0,n>>1,s>>1),n>>=1,s>>=1;return e.drawImage(a,0,0,n,s,0,0,i.width,i.height),i}get#Wi(){return JSON.stringify({page:this.pageLabel??this.id})}setPageLabel(t){this.pageLabel="string"==typeof t?t:null,this.anchor.setAttribute("data-l10n-args",this.#Wi),this.renderingState===Q.FINISHED&&this.image?.setAttribute("data-l10n-args",this.#Wi)}}const Jn="selected";class ts{constructor({container:t,eventBus:e,linkService:i,renderingQueue:n,maxCanvasPixels:s,maxCanvasDim:a,pageColors:r,abortSignal:o,enableHWA:l}){this.container=t,this.eventBus=e,this.linkService=i,this.renderingQueue=n,this.maxCanvasPixels=s,this.maxCanvasDim=a,this.pageColors=r||null,this.enableHWA=l||!1,this.scroll=vt(this.container,this.#qi.bind(this),o),this.#Yi()}#qi(){this.renderingQueue.renderHighestPriority()}getThumbnail(t){return this._thumbnails[t]}#Qi(){return xt({scrollEl:this.container,views:this._thumbnails})}scrollThumbnailIntoView(t){if(!this.pdfDocument)return;const e=this._thumbnails[t-1];if(!e)return;if(t!==this._currentPageNumber){this._thumbnails[this._currentPageNumber-1].div.classList.remove(Jn),e.div.classList.add(Jn)}const{first:i,last:n,views:s}=this.#Qi();if(s.length>0){let a=!1;if(t<=i.id||t>=n.id)a=!0;else for(const{id:e,percent:i}of s)if(e===t){a=i<100;break}a&&bt(e.div,{top:-19})}this._currentPageNumber=t}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!At(t))throw new Error("Invalid thumbnails rotation angle.");if(!this.pdfDocument)return;if(this._pagesRotation===t)return;this._pagesRotation=t;const e={rotation:t};for(const t of this._thumbnails)t.update(e)}cleanup(){for(const t of this._thumbnails)t.renderingState!==Q.FINISHED&&t.reset();Yn.destroyCanvas()}#Yi(){this._thumbnails=[],this._currentPageNumber=1,this._pageLabels=null,this._pagesRotation=0,this.container.textContent=""}setDocument(t){if(this.pdfDocument&&(this.#Ji(),this.#Yi()),this.pdfDocument=t,!t)return;const e=t.getPage(1),i=t.getOptionalContentConfig({intent:"display"});e.then((e=>{const n=t.numPages,s=e.getViewport({scale:1});for(let t=1;t<=n;++t){const e=new Qn({container:this.container,eventBus:this.eventBus,id:t,defaultViewport:s.clone(),optionalContentConfigPromise:i,linkService:this.linkService,renderingQueue:this.renderingQueue,maxCanvasPixels:this.maxCanvasPixels,maxCanvasDim:this.maxCanvasDim,pageColors:this.pageColors,enableHWA:this.enableHWA});this._thumbnails.push(e)}this._thumbnails[0]?.setPdfPage(e);this._thumbnails[this._currentPageNumber-1].div.classList.add(Jn)})).catch((t=>{}))}#Ji(){for(const t of this._thumbnails)t.cancelRendering()}setPageLabels(t){if(this.pdfDocument){t&&Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:this._pageLabels=null;for(let t=0,e=this._thumbnails.length;t<e;t++)this._thumbnails[t].setPageLabel(this._pageLabels?.[t]??null)}}async#tn(t){if(t.pdfPage)return t.pdfPage;try{const e=await this.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(e),e}catch(t){return null}}#en(t){return 1===t.first?.id||t.last?.id!==this._thumbnails.length&&this.scroll.down}forceRendering(){const t=this.#Qi(),e=this.#en(t),i=this.renderingQueue.getHighestPriority(t,this._thumbnails,e,!1,!0);return!!i&&(this.#tn(i).then((()=>{this.renderingQueue.renderView(i)})),!0)}}class es{#in=null;#nn=null;#sn=null;#an=null;#rn=null;#X;constructor(t){this.pdfPage=t.pdfPage,this.accessibilityManager=t.accessibilityManager,this.l10n=t.l10n,this.l10n||=new yi,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#X=t.uiManager,this.#in=t.annotationLayer||null,this.#rn=t.textLayer||null,this.#nn=t.drawLayer||null,this.#sn=t.onAppend||null,this.#an=t.structTreeLayer||null}async render({viewport:t,intent:i="display"}){if("display"!==i)return;if(this._cancelled)return;const n=t.clone({dontFlip:!0});if(this.div)return this.annotationEditorLayer.update({viewport:n}),void this.show();const s=this.div=document.createElement("div");s.className="annotationEditorLayer",s.hidden=!0,s.dir=this.#X.direction,this.#sn?.(s),this.annotationEditorLayer=new e({uiManager:this.#X,div:s,structTreeLayer:this.#an,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:n,annotationLayer:this.#in,textLayer:this.#rn,drawLayer:this.#nn});const a={viewport:n,div:s,annotations:null,intent:i};this.annotationEditorLayer.render(a),this.show()}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.annotationEditorLayer.pause(!0),this.div.hidden=!0)}show(){this.div&&!this.annotationEditorLayer.isInvisible&&(this.div.hidden=!1,this.annotationEditorLayer.pause(!1))}}class is{#on=null;#ln=!1;#sn=null;#We=null;#dn=!1;constructor({pdfPage:t,linkService:e,downloadManager:i,annotationStorage:n=null,imageResourcesPath:s="",renderForms:a=!0,enableScripting:r=!1,hasJSActionsPromise:o=null,fieldObjectsPromise:l=null,annotationCanvasMap:d=null,accessibilityManager:h=null,annotationEditorUIManager:c=null,onAppend:u=null}){this.pdfPage=t,this.linkService=e,this.downloadManager=i,this.imageResourcesPath=s,this.renderForms=a,this.annotationStorage=n,this.enableScripting=r,this._hasJSActionsPromise=o||Promise.resolve(!1),this._fieldObjectsPromise=l||Promise.resolve(null),this._annotationCanvasMap=d,this._accessibilityManager=h,this._annotationEditorUIManager=c,this.#sn=u,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=e.eventBus}async render({viewport:t,intent:e="display",structTreeLayer:i=null}){if(this.div){if(this._cancelled||!this.annotationLayer)return;return void this.annotationLayer.update({viewport:t.clone({dontFlip:!0})})}const[n,s,a]=await Promise.all([this.pdfPage.getAnnotations({intent:e}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;const r=this.div=document.createElement("div");if(r.className="annotationLayer",this.#sn?.(r),0===n.length)return this.#on=n,void this.hide(!0);this.#hn(t,i),await this.annotationLayer.render({annotations:n,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:s,fieldObjects:a}),this.#on=n,this.linkService.isInPresentationMode&&this.#cn(it),this.#We||(this.#We=new AbortController,this._eventBus?._on("presentationmodechanged",(t=>{this.#cn(t.state)}),{signal:this.#We.signal}))}#hn(t,e){this.annotationLayer=new a({div:this.div,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:t.clone({dontFlip:!0}),structTreeLayer:e})}cancel(){this._cancelled=!0,this.#We?.abort(),this.#We=null}hide(t=!1){this.#ln=!t,this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}async injectLinkAnnotations({inferredLinks:t,viewport:e,structTreeLayer:i=null}){if(null===this.#on)throw new Error("`render` method must be called before `injectLinkAnnotations`.");if(this._cancelled||this.#dn)return;this.#dn=!0;const n=this.#on.length?this.#un(t):t;n.length&&(this.annotationLayer||(this.#hn(e,i),F(this.div,e)),await this.annotationLayer.addLinkAnnotations(n,this.linkService),this.#ln||(this.div.hidden=!1))}#cn(t){if(!this.div)return;let e=!1;switch(t){case it:e=!0;break;case tt:break;default:return}for(const t of this.div.childNodes)t.hasAttribute("data-internal-link")||(t.inert=e)}#un(t){function e(t){if(!t.quadPoints)return[t.rect];const e=[];for(let i=2,n=t.quadPoints.length;i<n;i+=8){const n=t.quadPoints[i],s=t.quadPoints[i+1],a=t.quadPoints[i+2],r=t.quadPoints[i+3];e.push([a,r,n,s])}return e}function i(t,i){const n=[],s=e(t),a=e(i);for(const t of s)for(const e of a){const i=X.intersect(t,e);i&&n.push(i)}return n}function n(t){let e=0;for(const i of t)e+=Math.abs((i[2]-i[0])*(i[3]-i[1]));return e}return t.filter((t=>{let s;for(const a of this.#on){if(a.annotationType!==o.LINK||!a.url)continue;const r=i(a,t);if(0!==r.length&&(s??=n(e(t)),n(r)/s>.5))return!1}return!0}))}}function ns({width:t,height:e,left:i,top:n},s){if(0===t||0===e)return null;const a=s.textLayer.div.getBoundingClientRect(),r=s.getPagePoint(i-a.left,n-a.top),o=s.getPagePoint(i-a.left+t,n-a.top+e);return X.normalizeRect([r[0],r[1],o[0],o[1]])}function ss(t,e){const i=t.getClientRects();if(1===i.length)return{rect:ns(i[0],e)};const n=[1/0,1/0,-1/0,-1/0],s=[];let a=0;for(const t of i){const i=ns(t,e);null!==i&&(s[a]=s[a+4]=i[0],s[a+1]=s[a+3]=i[3],s[a+2]=s[a+6]=i[2],s[a+5]=s[a+7]=i[1],X.rectBoundingBox(...i,n),a+=8)}return{quadPoints:s,rect:n}}function as(t,e){let i=t;do{if(i.nodeType===Node.TEXT_NODE){const t=i.textContent.length;if(e<=t)return[i,e];e-=t}else if(i.firstChild){i=i.firstChild;continue}for(;!i.nextSibling&&i!==t;)i=i.parentNode;i!==t&&(i=i.nextSibling)}while(i!==t);throw new Error("Offset is bigger than container's contents length.")}class rs{static#gn=0;static#pn;static findLinks(t){this.#pn??=/\b(?:https?:\/\/|mailto:|www\.)(?:[\S--[\p{P}<>]]|\/|[\S--[\[\]]]+[\S--[\p{P}<>]])+|\b[\S--[@\p{Ps}\p{Pe}<>]]+@([\S--[\p{P}<>]]+(?:\.[\S--[\p{P}<>]]+)+)/gmv;const[e,i]=yn(t),n=e.matchAll(this.#pn),s=[];for(const t of n){const[e,n]=t;let a;if(e.startsWith("www.")||e.startsWith("http://")||e.startsWith("https://"))a=e;else{if(!URL.canParse(`http://${n}`))continue;a=e.startsWith("mailto:")?e:`mailto:${e}`}const r=h(a,null,{addDefaultProtocol:!0});if(r){const[n,a]=Cn(i,t.index,e.length);s.push({url:r.href,index:n,length:a})}}return s}static processLinks(t){return this.findLinks(t._textHighlighter.textContentItemsStr.join("\n")).map((e=>function({url:t,index:e,length:i},n,s){const a=n._textHighlighter,[{begin:r,end:l}]=a._convertMatches([e],[i]),d=new Range;return d.setStart(...as(a.textDivs[r.divIdx],r.offset)),d.setEnd(...as(a.textDivs[l.divIdx],l.offset)),{id:`inferred_link_${s}`,unsafeUrl:t,url:t,annotationType:o.LINK,rotation:0,...ss(d,n),borderStyle:null}}(e,t,this.#gn++)))}}class os{#mn=!1;#fn=null;#bn=0;#vn=null;#wn=Q.INITIAL;#yn=null;#Cn=0;#zi=null;canvas=null;div=null;eventBus=null;id=null;pageColors=null;renderingQueue=null;renderTask=null;resume=null;constructor(t){this.#mn=#mn in t?t.#mn:t.enableHWA||!1,this.eventBus=t.eventBus,this.id=t.id,this.pageColors=t.pageColors||null,this.renderingQueue=t.renderingQueue,this.#bn=t.minDurationToUpdateCanvas??500}get renderingState(){return this.#wn}set renderingState(t){if(t!==this.#wn)switch(this.#wn=t,this.#fn&&(clearTimeout(this.#fn),this.#fn=null),t){case Q.PAUSED:this.div.classList.remove("loading"),this.#Cn=0,this.#yn?.(!1);break;case Q.RUNNING:this.div.classList.add("loadingIcon"),this.#fn=setTimeout((()=>{this.div.classList.add("loading"),this.#fn=null}),0),this.#Cn=Date.now();break;case Q.INITIAL:case Q.FINISHED:this.div.classList.remove("loadingIcon","loading"),this.#Cn=0}}_createCanvas(t,e=!1){const{pageColors:i}=this,n=!(!i?.background||!i?.foreground),s=this.canvas,a=!s&&!n&&!e;let r=this.canvas=document.createElement("canvas");this.#yn=e=>{if(a){let i=this.#zi;if(!e&&this.#bn>0){if(Date.now()-this.#Cn<this.#bn)return;i||(i=this.#zi=r,r=this.canvas=r.cloneNode(!1),t(r))}if(i){return r.getContext("2d",{alpha:!1}).drawImage(i,0,0),void(e?this.#Pn():this.#Cn=Date.now())}return t(r),void(this.#yn=null)}e&&(s?(s.replaceWith(r),s.width=s.height=0):t(r))};const o=r.getContext("2d",{alpha:!1,willReadFrequently:!this.#mn});return{canvas:r,prevCanvas:s,ctx:o}}#Sn=t=>{if(this.#yn?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this))return this.renderingState=Q.PAUSED,void(this.resume=()=>{this.renderingState=Q.RUNNING,t()});t()};_resetCanvas(){const{canvas:t}=this;t&&(t.remove(),t.width=t.height=0,this.canvas=null,this.#Pn())}#Pn(){this.#zi&&(this.#zi.width=this.#zi.height=0,this.#zi=null)}async _drawCanvas(t,e,i){const n=this.renderTask=this.pdfPage.render(t);n.onContinue=this.#Sn,n.onError=t=>{t instanceof O&&(e(),this.#vn=null)};let s=null;try{await n.promise,this.#yn?.(!0)}catch(t){if(t instanceof O)return;s=t,this.#yn?.(!0)}finally{this.#vn=s,n===this.renderTask&&(this.renderTask=null)}if(this.renderingState=Q.FINISHED,i(n),s)throw s}cancelRendering({cancelExtraDelay:t=0}={}){this.renderTask&&(this.renderTask.cancel(t),this.renderTask=null),this.resume=null}dispatchPageRender(){this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id})}dispatchPageRendered(t,e){this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:t,isDetailView:e,timestamp:performance.now(),error:this.#vn})}}class ls{#nn=null;constructor(t){this.pageIndex=t.pageIndex}async render({intent:t="display"}){"display"!==t||this.#nn||this._cancelled||(this.#nn=new u({pageIndex:this.pageIndex}))}cancel(){this._cancelled=!0,this.#nn&&(this.#nn.destroy(),this.#nn=null)}setParent(t){this.#nn?.setParent(t)}getDrawLayer(){return this.#nn}}class ds extends os{#En=null;renderingCancelled=!1;constructor({pageView:t}){super(t),this.pageView=t,this.renderingId="detail"+this.id,this.div=t.div}setPdfPage(t){this.pageView.setPdfPage(t)}get pdfPage(){return this.pageView.pdfPage}get renderingState(){return super.renderingState}set renderingState(t){this.renderingCancelled=!1,super.renderingState=t}reset({keepCanvas:t=!1}={}){const e=this.renderingCancelled||this.renderingState===Q.RUNNING||this.renderingState===Q.PAUSED;this.cancelRendering(),this.renderingState=Q.INITIAL,this.renderingCancelled=e,t||this._resetCanvas()}#_n(t){if(!this.#En)return!0;const e=this.#En.minX,i=this.#En.minY,n=this.#En.width+e,s=this.#En.height+i;if(t.minX<e||t.minY<i||t.maxX>n||t.maxY>s)return!0;const{width:a,height:r,scale:o}=this.pageView.viewport;if(this.#En.scale!==o)return!0;const l=t.minX-e,d=n-t.maxX,h=t.minY-i,c=s-t.maxY;return e>0&&d/l>3||n<a&&l/d>3||i>0&&c/h>3||s<r&&h/c>3}update({visibleArea:t=null,underlyingViewUpdated:e=!1}={}){if(e)return this.cancelRendering(),void(this.renderingState=Q.INITIAL);if(!this.#_n(t))return;const{viewport:i,maxCanvasPixels:n,capCanvasAreaFactor:s}=this.pageView,a=t.maxX-t.minX,r=t.maxY-t.minY,o=a*r*I.pixelRatio**2,l=(Math.sqrt(I.capPixels(n,s)/o)-1)/2;let d=Math.min(1,l);d<0&&(d=0);const h=a*d,c=r*d,u=Math.max(0,t.minX-h),g=Math.min(i.width,t.maxX+h),p=Math.max(0,t.minY-c),m=g-u,f=Math.min(i.height,t.maxY+c)-p;this.#En={minX:u,minY:p,width:m,height:f,scale:i.scale},this.reset({keepCanvas:!0})}async draw(){if(this.pageView.detailView!==this)return;const t=this.pageView.renderingState===Q.FINISHED||this.renderingState===Q.FINISHED;this.renderingState!==Q.INITIAL&&this.reset();const{div:e,pdfPage:i,viewport:n}=this.pageView;if(!i)throw this.renderingState=Q.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Q.RUNNING;const s=this.pageView._ensureCanvasWrapper(),{canvas:a,prevCanvas:r,ctx:o}=this._createCanvas((t=>{"CANVAS"===s.firstElementChild?.tagName?s.firstElementChild.after(t):s.prepend(t)}),t);a.setAttribute("aria-hidden","true");const{width:l,height:d}=n,h=this.#En,{pixelRatio:c}=I,u=[c,0,0,c,-h.minX*c,-h.minY*c];a.width=h.width*c,a.height=h.height*c;const{style:g}=a;g.width=100*h.width/l+"%",g.height=100*h.height/d+"%",g.top=100*h.minY/d+"%",g.left=100*h.minX/l+"%";const p=this._drawCanvas(this.pageView._getRenderingContext(o,u),(()=>{this.canvas?.remove(),this.canvas=r}),(()=>{this.dispatchPageRendered(!1,!0)}));return e.setAttribute("data-loaded",!0),this.dispatchPageRender(),p}}const hs={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},cs=/^H(\d+)$/;class us{#xn;#Tn=null;#An;#Ln=new Map;#In;#Mn=null;constructor(t,e){this.#xn=t.getStructTree(),this.#In=e}async render(){if(this.#An)return this.#An;const{promise:t,resolve:e,reject:i}=Promise.withResolvers();this.#An=t;try{this.#Tn=this.#kn(await this.#xn)}catch(t){i(t)}return this.#xn=null,this.#Tn?.classList.add("structTree"),e(this.#Tn),t}async getAriaAttributes(t){try{return await this.render(),this.#Ln.get(t)}catch{}return null}hide(){this.#Tn&&!this.#Tn.hidden&&(this.#Tn.hidden=!0)}show(){this.#Tn?.hidden&&(this.#Tn.hidden=!1)}#Bn(t,e){const{alt:i,id:n,lang:s}=t;if(void 0!==i){let n=!1;const s=Ct(i);for(const e of t.children)if("annotation"===e.type){let t=this.#Ln.get(e.id);t||(t=new Map,this.#Ln.set(e.id,t)),t.set("aria-label",s),n=!0}n||e.setAttribute("aria-label",s)}void 0!==n&&e.setAttribute("aria-owns",n),void 0!==s&&e.setAttribute("lang",Ct(s,!0))}#Dn(t,e){const{alt:i,bbox:n,children:s}=t,a=s?.[0];if(!this.#In||!i||!n||"content"!==a?.type)return!1;const{id:r}=a;if(!r)return!1;e.setAttribute("aria-owns",r);const o=document.createElement("span");(this.#Mn||=new Map).set(r,o),o.setAttribute("role","img"),o.setAttribute("aria-label",Ct(i));const{pageHeight:l,pageX:d,pageY:h}=this.#In,c="calc(var(--total-scale-factor) *",{style:u}=o;return u.width=`${c}${n[2]-n[0]}px)`,u.height=`${c}${n[3]-n[1]}px)`,u.left=`${c}${n[0]-d}px)`,u.top=`${c}${l-n[3]+h}px)`,!0}addElementsToTextLayer(){if(this.#Mn){for(const[t,e]of this.#Mn)document.getElementById(t)?.append(e);this.#Mn.clear(),this.#Mn=null}}#kn(t){if(!t)return null;const e=document.createElement("span");if("role"in t){const{role:i}=t,n=i.match(cs);if(n?(e.setAttribute("role","heading"),e.setAttribute("aria-level",n[1])):hs[i]&&e.setAttribute("role",hs[i]),"Figure"===i&&this.#Dn(t,e))return e}if(this.#Bn(t,e),t.children)if(1===t.children.length&&"id"in t.children[0])this.#Bn(t.children[0],e);else for(const i of t.children)e.append(this.#kn(i));return e}}class gs{#Nn=!1;#Vn=null;#On=new Map;#jn=new Map;setTextMapping(t){this.#Vn=t}static#Fn(t,e){const i=t.getBoundingClientRect(),n=e.getBoundingClientRect();if(0===i.width&&0===i.height)return 1;if(0===n.width&&0===n.height)return-1;const s=i.y,a=i.y+i.height,r=i.y+i.height/2,o=n.y,l=n.y+n.height,d=n.y+n.height/2;if(r<=o&&d>=a)return-1;if(d<=s&&r>=l)return 1;return i.x+i.width/2-(n.x+n.width/2)}enable(){if(this.#Nn)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#Vn)throw new Error("Text divs and strings have not been set.");if(this.#Nn=!0,this.#Vn=this.#Vn.slice(),this.#Vn.sort(gs.#Fn),this.#On.size>0){const t=this.#Vn;for(const[e,i]of this.#On){document.getElementById(e)?this.#Rn(e,t[i]):this.#On.delete(e)}}for(const[t,e]of this.#jn)this.addPointerInTextLayer(t,e);this.#jn.clear()}disable(){this.#Nn&&(this.#jn.clear(),this.#Vn=null,this.#Nn=!1)}removePointerInTextLayer(t){if(!this.#Nn)return void this.#jn.delete(t);const e=this.#Vn;if(!e||0===e.length)return;const{id:i}=t,n=this.#On.get(i);if(void 0===n)return;const s=e[n];this.#On.delete(i);let a=s.getAttribute("aria-owns");a?.includes(i)&&(a=a.split(" ").filter((t=>t!==i)).join(" "),a?s.setAttribute("aria-owns",a):(s.removeAttribute("aria-owns"),s.setAttribute("role","presentation")))}#Rn(t,e){const i=e.getAttribute("aria-owns");i?.includes(t)||e.setAttribute("aria-owns",i?`${i} ${t}`:t),e.removeAttribute("role")}addPointerInTextLayer(t,e){const{id:i}=t;if(!i)return null;if(!this.#Nn)return this.#jn.set(t,e),null;e&&this.removePointerInTextLayer(t);const n=this.#Vn;if(!n||0===n.length)return null;const s=Pt(n,(e=>gs.#Fn(t,e)<0)),a=Math.max(0,s-1),r=n[a];this.#Rn(i,r),this.#On.set(i,a);const o=r.parentNode;return o?.classList.contains("markedContent")?o.id:null}moveElementInDOM(t,e,i,n){const s=this.addPointerInTextLayer(i,n);if(!t.hasChildNodes())return t.append(e),s;const a=Array.from(t.childNodes).filter((t=>t!==e));if(0===a.length)return s;const r=i||e,o=Pt(a,(t=>gs.#Fn(r,t)<0));return 0===o?a[0].before(e):a[o-1].after(e),s}}class ps{#We=null;constructor({findController:t,eventBus:e,pageIndex:i}){this.findController=t,this.matches=[],this.eventBus=e,this.pageIdx=i,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(t,e){this.textDivs=t,this.textContentItemsStr=e}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this.#We||(this.#We=new AbortController,this.eventBus._on("updatetextlayermatches",(t=>{t.pageIndex!==this.pageIdx&&-1!==t.pageIndex||this._updateMatches()}),{signal:this.#We.signal})),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this.#We?.abort(),this.#We=null,this._updateMatches(!0))}_convertMatches(t,e){if(!t)return[];const{textContentItemsStr:i}=this;let n=0,s=0;const a=i.length-1,r=[];for(let o=0,l=t.length;o<l;o++){let l=t[o];for(;n!==a&&l>=s+i[n].length;)s+=i[n].length,n++;i.length;const d={begin:{divIdx:n,offset:l-s}};for(l+=e[o];n!==a&&l>s+i[n].length;)s+=i[n].length,n++;d.end={divIdx:n,offset:l-s},r.push(d)}return r}_renderMatches(t){if(0===t.length)return;const{findController:e,pageIdx:i}=this,{textContentItemsStr:n,textDivs:s}=this,a=i===e.selected.pageIdx,r=e.selected.matchIdx;let o=null;const l={divIdx:-1,offset:void 0};function d(t,e){const i=t.divIdx;return s[i].textContent="",h(i,0,t.offset,e)}function h(t,e,i,a){let r=s[t];if(r.nodeType===Node.TEXT_NODE){const e=document.createElement("span");r.before(e),e.append(r),s[t]=e,r=e}const o=n[t].substring(e,i),l=document.createTextNode(o);if(a){const t=document.createElement("span");if(t.className=`${a} appended`,t.append(l),r.append(t),a.includes("selected")){const{left:e}=t.getClientRects()[0];return e-r.getBoundingClientRect().left}return 0}return r.append(l),0}let c=r,u=c+1;if(e.state.highlightAll)c=0,u=t.length;else if(!a)return;let g=-1,p=-1;for(let n=c;n<u;n++){const c=t[n],u=c.begin;if(u.divIdx===g&&u.offset===p)continue;g=u.divIdx,p=u.offset;const m=c.end,f=a&&n===r,b=f?" selected":"";let v=0;if(o&&u.divIdx===o.divIdx?h(o.divIdx,o.offset,u.offset):(null!==o&&h(o.divIdx,o.offset,l.offset),d(u)),u.divIdx===m.divIdx)v=h(u.divIdx,u.offset,m.offset,"highlight"+b);else{v=h(u.divIdx,u.offset,l.offset,"highlight begin"+b);for(let t=u.divIdx+1,e=m.divIdx;t<e;t++)s[t].className="highlight middle"+b;d(m,"highlight end"+b)}o=m,f&&e.scrollMatchIntoView({element:s[u.divIdx],selectedLeft:v,pageIndex:i,matchIndex:r})}o&&h(o.divIdx,o.offset,l.offset)}_updateMatches(t=!1){if(!this.enabled&&!t)return;const{findController:e,matches:i,pageIdx:n}=this,{textContentItemsStr:s,textDivs:a}=this;let r=-1;for(const t of i){for(let e=Math.max(r,t.begin.divIdx),i=t.end.divIdx;e<=i;e++){const t=a[e];t.textContent=s[e],t.className=""}r=t.end.divIdx+1}if(!e?.highlightMatches||t)return;const o=e.pageMatches[n]||null,l=e.pageMatchesLength[n]||null;this.matches=this._convertMatches(o,l),this._renderMatches(this.matches)}}class ms{#Un=!1;#sn=null;#Hn=!1;#rn=null;static#zn=new Map;static#Wn=null;constructor({pdfPage:t,highlighter:e=null,accessibilityManager:i=null,enablePermissions:n=!1,onAppend:s=null}){this.pdfPage=t,this.highlighter=e,this.accessibilityManager=i,this.#Un=!0===n,this.#sn=s,this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}async render({viewport:t,textContentParams:e=null}){if(this.#Hn&&this.#rn)return this.#rn.update({viewport:t,onBefore:this.hide.bind(this)}),void this.show();this.cancel(),this.#rn=new W({textContentSource:this.pdfPage.streamTextContent(e||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:t});const{textDivs:i,textContentItemsStr:n}=this.#rn;this.highlighter?.setTextMapping(i,n),this.accessibilityManager?.setTextMapping(i),await this.#rn.render(),this.#Hn=!0;const s=document.createElement("div");s.className="endOfContent",this.div.append(s),this.#$n(s),this.#sn?.(this.div),this.highlighter?.enable(),this.accessibilityManager?.enable()}hide(){!this.div.hidden&&this.#Hn&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.#Hn&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.#rn?.cancel(),this.#rn=null,this.highlighter?.disable(),this.accessibilityManager?.disable(),ms.#Gn(this.div)}#$n(t){const{div:e}=this;e.addEventListener("mousedown",(()=>{e.classList.add("selecting")})),e.addEventListener("copy",(t=>{if(!this.#Un){const e=document.getSelection();t.clipboardData.setData("text/plain",Ct(A(e.toString())))}H(t)})),ms.#zn.set(e,t),ms.#Xn()}static#Gn(t){this.#zn.delete(t),0===this.#zn.size&&(this.#Wn?.abort(),this.#Wn=null)}static#Xn(){if(this.#Wn)return;this.#Wn=new AbortController;const{signal:t}=this.#Wn,e=(t,e)=>{e.append(t),t.style.width="",t.style.height="",e.classList.remove("selecting")};let i=!1;var n,s;document.addEventListener("pointerdown",(()=>{i=!0}),{signal:t}),document.addEventListener("pointerup",(()=>{i=!1,this.#zn.forEach(e)}),{signal:t}),window.addEventListener("blur",(()=>{i=!1,this.#zn.forEach(e)}),{signal:t}),document.addEventListener("keyup",(()=>{i||this.#zn.forEach(e)}),{signal:t}),document.addEventListener("selectionchange",(()=>{const t=document.getSelection();if(0===t.rangeCount)return void this.#zn.forEach(e);const i=new Set;for(let e=0;e<t.rangeCount;e++){const n=t.getRangeAt(e);for(const t of this.#zn.keys())!i.has(t)&&n.intersectsNode(t)&&i.add(t)}for(const[t,n]of this.#zn)i.has(t)?t.classList.add("selecting"):e(n,t);if(n??="none"===getComputedStyle(this.#zn.values().next().value).getPropertyValue("-moz-user-select"),n)return;const a=t.getRangeAt(0),r=s&&(0===a.compareBoundaryPoints(Range.END_TO_END,s)||0===a.compareBoundaryPoints(Range.START_TO_END,s));let o=r?a.startContainer:a.endContainer;if(o.nodeType===Node.TEXT_NODE&&(o=o.parentNode),!r&&0===a.endOffset)do{for(;!o.previousSibling;)o=o.parentNode;o=o.previousSibling}while(!o.childNodes.length);const l=o.parentElement?.closest(".textLayer"),d=this.#zn.get(l);d&&(d.style.width=l.style.width,d.style.height=l.style.height,o.parentElement.insertBefore(d,r?o:o.nextSibling)),s=a.cloneRange()}),{signal:t})}}const fs=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]);class bs extends os{#Zn=r.ENABLE_FORMS;#Kn=null;#qn=!0;#Yn=!1;#O=!1;#Qn=null;#Jn=!1;#ts=null;#es=null;#is=1;#ns=1;#ss=ht;#as=1;#rs={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#os=[null,null,null,null];constructor(t){super(t);const e=t.container,i=t.defaultViewport;this.renderingId="page"+this.id,this.#Qn=t.layerProperties||null,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=t.scale||1,this.viewport=i,this.pdfPageRotate=i.rotation,this._optionalContentConfigPromise=t.optionalContentConfigPromise||null,this.#ss=t.textLayerMode??ht,this.#Zn=t.annotationMode??r.ENABLE_FORMS,this.imageResourcesPath=t.imageResourcesPath||"",this.enableDetailCanvas=t.enableDetailCanvas??!0,this.maxCanvasPixels=t.maxCanvasPixels??Kt.get("maxCanvasPixels"),this.maxCanvasDim=t.maxCanvasDim||Kt.get("maxCanvasDim"),this.capCanvasAreaFactor=t.capCanvasAreaFactor??Kt.get("capCanvasAreaFactor"),this.#qn=!1!==t.enableAutoLinking,this.l10n=t.l10n,this.l10n||=new yi,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=e,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null,this.detailView=null;const n=document.createElement("div");if(n.className="page",n.setAttribute("data-page-number",this.id),n.setAttribute("role","region"),n.setAttribute("data-l10n-id","pdfjs-page-landmark"),n.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=n,this.#ls(),e?.append(n),this._isStandalone){e?.style.setProperty("--scale-factor",this.scale*V.PDF_TO_CSS_UNITS),this.pageColors?.background&&e?.style.setProperty("--page-bg-color",this.pageColors.background);const{optionalContentConfigPromise:i}=t;i&&i.then((t=>{i===this._optionalContentConfigPromise&&(this.#rs.initialOptionalContent=t.hasInitialVisibility)})),t.l10n||this.l10n.translate(this.div)}}#ds(t,e){const i=fs.get(e),n=this.#os[i];if(this.#os[i]=t,n)n.replaceWith(t);else{for(let e=i-1;e>=0;e--){const i=this.#os[e];if(i)return void i.after(t)}this.div.prepend(t)}}#ls(){const{div:t,viewport:e}=this;if(e.userUnit!==this.#as&&(1!==e.userUnit?t.style.setProperty("--user-unit",e.userUnit):t.style.removeProperty("--user-unit"),this.#as=e.userUnit),this.pdfPage){if(this.#es===e.rotation)return;this.#es=e.rotation}F(t,e,!0,!1)}setPdfPage(t){!this._isStandalone||"CanvasText"!==this.pageColors?.foreground&&"Canvas"!==this.pageColors?.background||(this._container?.style.setProperty("--hcm-highlight-filter",t.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",t.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=t,this.pdfPageRotate=t.rotate;const e=(this.rotation+this.pdfPageRotate)%360;this.viewport=t.getViewport({scale:this.scale*V.PDF_TO_CSS_UNITS,rotation:e}),this.#ls(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return R(this,"_textHighlighter",new ps({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#Qn.findController}))}#hs(t,e){this.eventBus.dispatch(t,{source:this,pageNumber:this.id,error:e})}async#cs(){let t=null;try{await this.annotationLayer.render({viewport:this.viewport,intent:"display",structTreeLayer:this.structTreeLayer})}catch(e){t=e}finally{this.#hs("annotationlayerrendered",t)}}async#us(){let t=null;try{await this.annotationEditorLayer.render({viewport:this.viewport,intent:"display"})}catch(e){t=e}finally{this.#hs("annotationeditorlayerrendered",t)}}async#gs(){try{await this.drawLayer.render({intent:"display"})}catch(t){}}async#ps(){let t=null;try{const t=await this.xfaLayer.render({viewport:this.viewport,intent:"display"});t?.textDivs&&this._textHighlighter&&this.#ms(t.textDivs)}catch(e){t=e}finally{this.xfaLayer?.div&&(this.l10n.pause(),this.#ds(this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),this.#hs("xfalayerrendered",t)}}async#fs(){if(!this.textLayer)return;let e=null;try{await this.textLayer.render({viewport:this.viewport})}catch(i){if(i instanceof t)return;e=i}this.#hs("textlayerrendered",e),this.#bs()}async#bs(){if(!this.textLayer)return;const t=await(this.structTreeLayer?.render());t&&(this.l10n.pause(),this.structTreeLayer?.addElementsToTextLayer(),this.canvas&&t.parentNode!==this.canvas&&this.canvas.append(t),this.l10n.resume()),this.structTreeLayer?.show()}async#ms(t){const e=await this.pdfPage.getTextContent(),i=[];for(const t of e.items)i.push(t.str);this._textHighlighter.setTextMapping(t,i),this._textHighlighter.enable()}async#vs(t){let e=null;try{if(await t,!this.annotationLayer)return;await this.annotationLayer.injectLinkAnnotations({inferredLinks:rs.processLinks(this),viewport:this.viewport,structTreeLayer:this.structTreeLayer})}catch(t){e=t}}_resetCanvas(){super._resetCanvas(),this.#ts=null}reset({keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:e=!1,keepXfaLayer:i=!1,keepTextLayer:n=!1,keepCanvasWrapper:s=!1,preserveDetailViewState:a=!1}={}){this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:e,keepXfaLayer:i,keepTextLayer:n}),this.renderingState=Q.INITIAL;const r=this.div,o=r.childNodes,l=t&&this.annotationLayer?.div||null,d=e&&this.annotationEditorLayer?.div||null,h=i&&this.xfaLayer?.div||null,c=n&&this.textLayer?.div||null,u=s&&this.#Kn||null;for(let t=o.length-1;t>=0;t--){const e=o[t];switch(e){case l:case d:case h:case c:case u:continue}e.remove();const i=this.#os.indexOf(e);i>=0&&(this.#os[i]=null)}r.removeAttribute("data-loaded"),l&&this.annotationLayer.hide(),d&&this.annotationEditorLayer.hide(),h&&this.xfaLayer.hide(),c&&this.textLayer.hide(),this.structTreeLayer?.hide(),!s&&this.#Kn&&(this.#Kn=null,this._resetCanvas()),a||(this.detailView?.reset({keepCanvas:s}),s||(this.detailView=null))}toggleEditingMode(t){this.#O=t,this.hasEditableAnnotations()&&this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0})}updateVisibleArea(t){this.enableDetailCanvas&&(this.#Jn&&this.maxCanvasPixels>0&&t?(this.detailView??=new ds({pageView:this}),this.detailView.update({visibleArea:t})):this.detailView&&(this.detailView.reset(),this.detailView=null))}update({scale:t=0,rotation:e=null,optionalContentConfigPromise:i=null,drawingDelay:n=-1}){this.scale=t||this.scale,"number"==typeof e&&(this.rotation=e),i instanceof Promise&&(this._optionalContentConfigPromise=i,i.then((t=>{i===this._optionalContentConfigPromise&&(this.#rs.initialOptionalContent=t.hasInitialVisibility)}))),this.#rs.directDrawing=!0;const s=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*V.PDF_TO_CSS_UNITS,rotation:s}),this.#ls(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.#ws(),this.canvas){const t=this.#Yn&&this.#Jn,e=n>=0&&n<1e3;if(e||t)return e&&!t&&this.renderingState!==Q.FINISHED&&(this.cancelRendering({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:n}),this.renderingState=Q.FINISHED,this.#rs.directDrawing=!1),this.cssTransform({redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!e,hideTextLayer:e}),void(e||(this.detailView?.update({underlyingViewUpdated:!0}),this.dispatchPageRendered(!0,!1)))}this.cssTransform({}),this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0,preserveDetailViewState:!0}),this.detailView?.update({underlyingViewUpdated:!0})}#ws(){const{width:t,height:e}=this.viewport,i=this.outputScale=new I;if(0===this.maxCanvasPixels){const t=1/this.scale;i.sx*=t,i.sy*=t,this.#Jn=!0}else this.#Jn=i.limitCanvas(t,e,this.maxCanvasPixels,this.maxCanvasDim,this.capCanvasAreaFactor)}cancelRendering({keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:e=!1,keepXfaLayer:i=!1,keepTextLayer:n=!1,cancelExtraDelay:s=0}={}){super.cancelRendering({cancelExtraDelay:s}),!this.textLayer||n&&this.textLayer.div||(this.textLayer.cancel(),this.textLayer=null),!this.annotationLayer||t&&this.annotationLayer.div||(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),!this.annotationEditorLayer||e&&this.annotationEditorLayer.div||(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),!this.xfaLayer||i&&this.xfaLayer.div||(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({redrawAnnotationLayer:t=!1,redrawAnnotationEditorLayer:e=!1,redrawXfaLayer:i=!1,redrawTextLayer:n=!1,hideTextLayer:s=!1}){const{canvas:a}=this;if(!a)return;const r=this.#ts;if(this.viewport!==r){const t=(360+this.viewport.rotation-r.rotation)%360;if(90===t||270===t){const{width:e,height:i}=this.viewport,n=i/e,s=e/i;a.style.transform=`rotate(${t}deg) scale(${n},${s})`}else a.style.transform=0===t?"":`rotate(${t}deg)`}t&&this.annotationLayer&&this.#cs(),e&&this.annotationEditorLayer&&(this.drawLayer&&this.#gs(),this.#us()),i&&this.xfaLayer&&this.#ps(),this.textLayer&&(s?(this.textLayer.hide(),this.structTreeLayer?.hide()):n&&this.#fs())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(t,e){return this.viewport.convertToPdfPoint(t,e)}_ensureCanvasWrapper(){let t=this.#Kn;return t||(t=this.#Kn=document.createElement("div"),t.classList.add("canvasWrapper"),this.#ds(t,"canvasWrapper")),t}_getRenderingContext(t,e){return{canvasContext:t,transform:e,viewport:this.viewport,annotationMode:this.#Zn,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors,isEditing:this.#O}}async draw(){this.renderingState!==Q.INITIAL&&this.reset();const{div:t,l10n:e,pdfPage:i,viewport:n}=this;if(!i)throw this.renderingState=Q.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Q.RUNNING;const s=this._ensureCanvasWrapper();if(this.textLayer||this.#ss===dt||i.isPureXfa||(this._accessibilityManager||=new gs,this.textLayer=new ms({pdfPage:i,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:this.#ss===ct,onAppend:t=>{this.l10n.pause(),this.#ds(t,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&this.#Zn!==r.DISABLE){const{annotationStorage:t,annotationEditorUIManager:e,downloadManager:n,enableScripting:s,fieldObjectsPromise:a,hasJSActionsPromise:o,linkService:l}=this.#Qn;this._annotationCanvasMap||=new Map,this.annotationLayer=new is({pdfPage:i,annotationStorage:t,imageResourcesPath:this.imageResourcesPath,renderForms:this.#Zn===r.ENABLE_FORMS,linkService:l,downloadManager:n,enableScripting:s,hasJSActionsPromise:o,fieldObjectsPromise:a,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:e,onAppend:t=>{this.#ds(t,"annotationLayer")}})}const{width:a,height:o}=n;this.#ts=n;const{canvas:l,prevCanvas:d,ctx:h}=this._createCanvas((t=>{s.prepend(t)}));l.setAttribute("role","presentation"),this.outputScale||this.#ws();const{outputScale:c}=this;this.#Yn=this.#Jn;const u=St(c.sx),g=St(c.sy),p=l.width=Et(Ft(a*c.sx),u[0]),m=l.height=Et(Ft(o*c.sy),g[0]),f=Et(Ft(a),u[1]),b=Et(Ft(o),g[1]);c.sx=p/f,c.sy=m/b,this.#is!==u[1]&&(t.style.setProperty("--scale-round-x",`${u[1]}px`),this.#is=u[1]),this.#ns!==g[1]&&(t.style.setProperty("--scale-round-y",`${g[1]}px`),this.#ns=g[1]);const v=c.scaled?[c.sx,0,0,c.sy,0,0]:null,w=this._drawCanvas(this._getRenderingContext(h,v),(()=>{d?.remove(),this._resetCanvas()}),(t=>{this.#rs.regularAnnotations=!t.separateAnnots,this.dispatchPageRendered(!1,!1)})).then((async()=>{this.structTreeLayer||=new us(i,n.rawDims);const t=this.#fs();this.annotationLayer&&(await this.#cs(),this.#qn&&this.annotationLayer&&this.textLayer&&await this.#vs(t));const{annotationEditorUIManager:a}=this.#Qn;a&&(this.drawLayer||=new ls({pageIndex:this.id}),await this.#gs(),this.drawLayer.setParent(s),this.annotationEditorLayer||=new es({uiManager:a,pdfPage:i,l10n:e,structTreeLayer:this.structTreeLayer,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:t=>{this.#ds(t,"annotationEditorLayer")}}),this.#us())}));if(i.isPureXfa){if(!this.xfaLayer){const{annotationStorage:t,linkService:e}=this.#Qn;this.xfaLayer=new kn({pdfPage:i,annotationStorage:t,linkService:e})}this.#ps()}return t.setAttribute("data-loaded",!0),this.dispatchPageRender(),w}setPageLabel(t){this.pageLabel="string"==typeof t?t:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:t,initialOptionalContent:e,regularAnnotations:i}=this.#rs;return t&&e&&i?this.canvas:null}}const vs=1e4,ws=5e3,ys=250;function Cs(t){return Object.values(n).includes(t)&&t!==n.DISABLE}class Ps{#ys=new Set;#Cs=0;constructor(t){this.#Cs=t}push(t){const e=this.#ys;e.has(t)&&e.delete(t),e.add(t),e.size>this.#Cs&&this.#Ps()}resize(t,e=null){this.#Cs=t;const i=this.#ys;if(e){const t=i.size;let n=1;for(const s of i)if(e.has(s.id)&&(i.delete(s),i.add(s)),++n>t)break}for(;i.size>this.#Cs;)this.#Ps()}has(t){return this.#ys.has(t)}[Symbol.iterator](){return this.#ys.keys()}#Ps(){const t=this.#ys.keys().next().value;t?.destroy(),this.#ys.delete(t)}}class Ss{#Ss=null;#Es=null;#_s=null;#xs=n.NONE;#Ts=null;#Zn=r.ENABLE_FORMS;#As=null;#Ls=null;#mn=!1;#Is=!1;#Un=!1;#Ms=!1;#ks=!1;#qn=!0;#We=null;#bn=0;#ht=null;#Bs=null;#Ds=null;#Ns=null;#Vs=!1;#Os=null;#js=!1;#Fs=0;#He=new ResizeObserver(this.#ze.bind(this));#Rs=null;#Us=null;#Hs=null;#zs=!0;#ss=ht;constructor(t){const e="5.3.51";if(K!==e)throw new Error(`The API version "${K}" does not match the Viewer version "${e}".`);if(this.container=t.container,this.viewer=t.viewer||t.container.firstElementChild,"DIV"!==this.container?.tagName||"DIV"!==this.viewer?.tagName)throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&"absolute"!==getComputedStyle(this.container).position)throw new Error("The `container` must be absolutely positioned.");this.#He.observe(this.container),this.eventBus=t.eventBus,this.linkService=t.linkService||new Qt,this.downloadManager=t.downloadManager||null,this.findController=t.findController||null,this.#Es=t.altTextManager||null,this.#Hs=t.signatureManager||null,this.#Ls=t.editorUndoBar||null,this.findController&&(this.findController.onIsPageVisible=t=>this._getVisiblePages().ids.has(t)),this._scriptingManager=t.scriptingManager||null,this.#ss=t.textLayerMode??ht,this.#Zn=t.annotationMode??r.ENABLE_FORMS,this.#xs=t.annotationEditorMode??n.NONE,this.#_s=t.annotationEditorHighlightColors||null,this.#Is=!0===t.enableHighlightFloatingButton,this.#Ms=!0===t.enableUpdatedAddImage,this.#ks=!0===t.enableNewAltTextWhenAddingImage,this.imageResourcesPath=t.imageResourcesPath||"",this.enablePrintAutoRotate=t.enablePrintAutoRotate||!1,this.removePageBorders=t.removePageBorders||!1,this.maxCanvasPixels=t.maxCanvasPixels,this.maxCanvasDim=t.maxCanvasDim,this.capCanvasAreaFactor=t.capCanvasAreaFactor,this.enableDetailCanvas=t.enableDetailCanvas??!0,this.l10n=t.l10n,this.l10n||=new yi,this.#Un=t.enablePermissions||!1,this.pageColors=t.pageColors||null,this.#ht=t.mlManager||null,this.#mn=t.enableHWA||!1,this.#zs=!1!==t.supportsPinchToZoom,this.#qn=!1!==t.enableAutoLinking,this.#bn=t.minDurationToUpdateCanvas??500,this.defaultRenderingQueue=!t.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new $n,this.renderingQueue.setViewer(this)):this.renderingQueue=t.renderingQueue;const{abortSignal:i}=t;i?.addEventListener("abort",(()=>{this.#He.disconnect(),this.#He=null}),{once:!0}),this.scroll=vt(this.container,this._scrollUpdate.bind(this),i),this.presentationModeState=J,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#Ws(),this.eventBus._on("thumbnailrendered",(({pageNumber:t,pdfPage:e})=>{const i=this._pages[t-1];this.#Ss.has(i)||e?.cleanup()})),t.l10n||this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(t){return this._pages[t]}getCachedPageViews(){return new Set(this.#Ss)}get pageViewsReady(){return this._pages.every((t=>t?.pdfPage))}get renderForms(){return this.#Zn===r.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(t){if(!Number.isInteger(t))throw new Error("Invalid page number.");this.pdfDocument&&this._setCurrentPageNumber(t,!0)}_setCurrentPageNumber(t,e=!1){if(this._currentPageNumber===t)return e&&this.#$s(),!0;if(!(0<t&&t<=this.pagesCount))return!1;const i=this._currentPageNumber;return this._currentPageNumber=t,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:t,pageLabel:this._pageLabels?.[t-1]??null,previous:i}),e&&this.#$s(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(t){if(!this.pdfDocument)return;let e=0|t;if(this._pageLabels){const i=this._pageLabels.indexOf(t);i>=0&&(e=i+1)}this._setCurrentPageNumber(e,!0)}get currentScale(){return 0!==this._currentScale?this._currentScale:1}set currentScale(t){if(isNaN(t))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#Gs(t,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(t){this.pdfDocument&&this.#Gs(t,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!At(t))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument)return;if((t%=360)<0&&(t+=360),this._pagesRotation===t)return;this._pagesRotation=t;const e=this._currentPageNumber;this.refresh(!0,{rotation:t}),this._currentScaleValue&&this.#Gs(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:t,pageNumber:e}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){const t=this;return R(this,"_layerProperties",{get annotationEditorUIManager(){return t.#Ts},get annotationStorage(){return t.pdfDocument?.annotationStorage},get downloadManager(){return t.downloadManager},get enableScripting(){return!!t._scriptingManager},get fieldObjectsPromise(){return t.pdfDocument?.getFieldObjects()},get findController(){return t.findController},get hasJSActionsPromise(){return t.pdfDocument?.hasJSActions()},get linkService(){return t.linkService}})}#Xs(t){const e={annotationEditorMode:this.#xs,annotationMode:this.#Zn,textLayerMode:this.#ss};return t?(t.includes(N.COPY)||this.#ss!==ht||(e.textLayerMode=ct),t.includes(N.MODIFY_CONTENTS)||(e.annotationEditorMode=n.DISABLE),t.includes(N.MODIFY_ANNOTATIONS)||t.includes(N.FILL_INTERACTIVE_FORMS)||this.#Zn!==r.ENABLE_FORMS||(e.annotationMode=r.ENABLE),e):e}async#Zs(t){if("hidden"===document.visibilityState||!this.container.offsetParent||0===this._getVisiblePages().views.length)return;const e=Promise.withResolvers(),i=new AbortController;document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&e.resolve()}),{signal:AbortSignal.any([t,i.signal])}),await Promise.race([this._onePageRenderedCapability.promise,e.promise]),i.abort()}async getAllText(){const t=[],e=[];for(let i=1,n=this.pdfDocument.numPages;i<=n;++i){if(this.#js)return null;e.length=0;const n=await this.pdfDocument.getPage(i),{items:s}=await n.getTextContent();for(const t of s)t.str&&e.push(t.str),t.hasEOL&&e.push("\n");t.push(Ct(e.join("")))}return t.join("\n")}#Ks(t,e){const i=document.getSelection(),{focusNode:n,anchorNode:s}=i;if(s&&n&&i.containsNode(this.#Os)){if(this.#Vs||t===ct)return void H(e);this.#Vs=!0;const{classList:i}=this.viewer;i.add("copyAll");const n=new AbortController;window.addEventListener("keydown",(t=>this.#js="Escape"===t.key),{signal:n.signal}),this.getAllText().then((async t=>{null!==t&&await navigator.clipboard.writeText(t)})).catch((t=>{})).finally((()=>{this.#Vs=!1,this.#js=!1,n.abort(),i.remove("copyAll")})),H(e)}}setDocument(t){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#Ts?.destroy(),this.#Ts=null),this.pdfDocument=t,!t)return;const e=t.numPages,i=t.getPage(1),a=t.getOptionalContentConfig({intent:"display"}),r=this.#Un?t.getPermissions():Promise.resolve(),{eventBus:o,pageColors:l,viewer:d}=this;this.#We=new AbortController;const{signal:h}=this.#We;if(e>vs){const t=this._scrollMode=ut.PAGE;o.dispatch("scrollmodechanged",{source:this,mode:t})}this._pagesCapability.promise.then((()=>{o.dispatch("pagesloaded",{source:this,pagesCount:e})}),(()=>{}));o._on("pagerender",(t=>{const e=this._pages[t.pageNumber-1];e&&this.#Ss.push(e)}),{signal:h});const c=t=>{t.cssTransform||t.isDetailView||(this._onePageRenderedCapability.resolve({timestamp:t.timestamp}),o._off("pagerendered",c))};o._on("pagerendered",c,{signal:h}),Promise.all([i,r]).then((([i,r])=>{if(t!==this.pdfDocument)return;this._firstPageCapability.resolve(i),this._optionalContentConfigPromise=a;const{annotationEditorMode:c,annotationMode:u,textLayerMode:g}=this.#Xs(r);if(g!==dt){const t=this.#Os=document.createElement("div");t.id="hiddenCopyElement",d.before(t)}if(c!==n.DISABLE){const e=c;t.isPureXfa||Cs(e)&&(this.#Ts=new s(this.container,d,this.#Es,this.#Hs,o,t,l,this.#_s,this.#Is,this.#Ms,this.#ks,this.#ht,this.#Ls,this.#zs),o.dispatch("annotationeditoruimanager",{source:this,uiManager:this.#Ts}),e!==n.NONE&&(this.#qs(e),this.#Ts.updateMode(e)))}const p=this._scrollMode===ut.PAGE?null:d,m=this.currentScale,f=i.getViewport({scale:m*V.PDF_TO_CSS_UNITS});d.style.setProperty("--scale-factor",f.scale),l?.background&&d.style.setProperty("--page-bg-color",l.background),"CanvasText"!==l?.foreground&&"Canvas"!==l?.background||(d.style.setProperty("--hcm-highlight-filter",t.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),d.style.setProperty("--hcm-highlight-selected-filter",t.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let t=1;t<=e;++t){const e=new bs({container:p,eventBus:o,id:t,scale:m,defaultViewport:f.clone(),optionalContentConfigPromise:a,renderingQueue:this.renderingQueue,textLayerMode:g,annotationMode:u,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,maxCanvasDim:this.maxCanvasDim,capCanvasAreaFactor:this.capCanvasAreaFactor,enableDetailCanvas:this.enableDetailCanvas,pageColors:l,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:this.#mn,enableAutoLinking:this.#qn,minDurationToUpdateCanvas:this.#bn});this._pages.push(e)}this._pages[0]?.setPdfPage(i),this._scrollMode===ut.PAGE?this.#Ys():this._spreadMode!==gt.NONE&&this._updateSpreadMode(),this.#Zs(h).then((async()=>{if(t!==this.pdfDocument)return;if(this.findController?.setDocument(t),this._scriptingManager?.setDocument(t),this.#Os&&document.addEventListener("copy",this.#Ks.bind(this,g),{signal:h}),this.#Ts&&o.dispatch("annotationeditormodechanged",{source:this,mode:this.#xs}),t.loadingParams.disableAutoFetch||e>ws)return void this._pagesCapability.resolve();let i=e-1;if(i<=0)this._pagesCapability.resolve();else for(let n=2;n<=e;++n){const e=t.getPage(n).then((t=>{const e=this._pages[n-1];e.pdfPage||e.setPdfPage(t),0==--i&&this._pagesCapability.resolve()}),(t=>{0==--i&&this._pagesCapability.resolve()}));n%ys==0&&await e}})),o.dispatch("pagesinit",{source:this}),t.getMetadata().then((({info:e})=>{t===this.pdfDocument&&e.Language&&(d.lang=e.Language)})),this.defaultRenderingQueue&&this.update()})).catch((t=>{this._pagesCapability.reject(t)}))}setPageLabels(t){if(this.pdfDocument){t&&Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:this._pageLabels=null;for(let t=0,e=this._pages.length;t<e;t++)this._pages[t].setPageLabel(this._pageLabels?.[t]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=0,this._currentScaleValue=null,this._pageLabels=null,this.#Ss=new Ps(10),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=ut.VERTICAL,this._previousScrollMode=ut.UNKNOWN,this._spreadMode=gt.NONE,this.#Rs={previousPageNumber:1,scrollDown:!0,pages:[]},this.#We?.abort(),this.#We=null,this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#Os?.remove(),this.#Os=null,this.#Qs(),this.#Js()}#Ys(){if(this._scrollMode!==ut.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const t=this._currentPageNumber,e=this.#Rs,i=this.viewer;if(i.textContent="",e.pages.length=0,this._spreadMode!==gt.NONE||this.isInPresentationMode){const n=new Set,s=this._spreadMode-1;-1===s?n.add(t-1):t%2!==s?(n.add(t-1),n.add(t)):(n.add(t-2),n.add(t-1));const a=document.createElement("div");if(a.className="spread",this.isInPresentationMode){const t=document.createElement("div");t.className="dummyPage",a.append(t)}for(const t of n){const i=this._pages[t];i&&(a.append(i.div),e.pages.push(i))}i.append(a)}else{const n=this._pages[t-1];i.append(n.div),e.pages.push(n)}e.scrollDown=t>=e.previousPageNumber,e.previousPageNumber=t}_scrollUpdate(){0!==this.pagesCount&&(this.#Bs&&clearTimeout(this.#Bs),this.#Bs=setTimeout((()=>{this.#Bs=null,this.update()}),100),this.update())}#ta(t,e=null){const{div:i,id:n}=t;if(this._currentPageNumber!==n&&this._setCurrentPageNumber(n),this._scrollMode===ut.PAGE&&(this.#Ys(),this.update()),!e&&!this.isInPresentationMode){const t=i.offsetLeft+i.clientLeft,n=t+i.clientWidth,{scrollLeft:s,clientWidth:a}=this.container;(this._scrollMode===ut.HORIZONTAL||t<s||n>s+a)&&(e={left:0,top:0})}bt(i,e),!this._currentScaleValue&&this._location&&(this._location=null)}#ea(t){return t===this._currentScale||Math.abs(t-this._currentScale)<1e-15}#ia(t,e,{noScroll:i=!1,preset:n=!1,drawingDelay:s=-1,origin:a=null}){if(this._currentScaleValue=e.toString(),this.#ea(t))return void(n&&this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:e}));this.viewer.style.setProperty("--scale-factor",t*V.PDF_TO_CSS_UNITS);const r=s>=0&&s<1e3;this.refresh(!0,{scale:t,drawingDelay:r?s:-1}),r&&(this.#Us=setTimeout((()=>{this.#Us=null,this.refresh()}),s));const o=this._currentScale;if(this._currentScale=t,!i){let e,i=this._currentPageNumber;if(!this._location||this.isInPresentationMode||this.isChangingPresentationMode||(i=this._location.pageNumber,e=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:i,destArray:e,allowNegativeOffset:!0}),Array.isArray(a)){const e=t/o-1,[i,n]=this.containerTopLeft;this.container.scrollLeft+=(a[0]-n)*e,this.container.scrollTop+=(a[1]-i)*e}}this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:n?e:void 0}),this.defaultRenderingQueue&&this.update()}get#na(){return this._spreadMode!==gt.NONE&&this._scrollMode!==ut.HORIZONTAL?2:1}#Gs(t,e){let i=parseFloat(t);if(i>0)e.preset=!1,this.#ia(i,t,e);else{const n=this._pages[this._currentPageNumber-1];if(!n)return;let s=40,a=5;this.isInPresentationMode?(s=a=4,this._spreadMode!==gt.NONE&&(s*=2)):this.removePageBorders?s=a=0:this._scrollMode===ut.HORIZONTAL&&([s,a]=[a,s]);const r=(this.container.clientWidth-s)/n.width*n.scale/this.#na,o=(this.container.clientHeight-a)/n.height*n.scale;switch(t){case"page-actual":i=1;break;case"page-width":i=r;break;case"page-height":i=o;break;case"page-fit":i=Math.min(r,o);break;case"auto":const t=Mt(n)?r:Math.min(o,r);i=Math.min(1.25,t);break;default:return}e.preset=!0,this.#ia(i,t,e)}}#$s(){const t=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#Gs(this._currentScaleValue,{noScroll:!0}),this.#ta(t)}pageLabelToPageNumber(t){if(!this._pageLabels)return null;const e=this._pageLabels.indexOf(t);return e<0?null:e+1}scrollPageIntoView({pageNumber:t,destArray:e=null,allowNegativeOffset:i=!1,ignoreDestinationZoom:n=!1}){if(!this.pdfDocument)return;const s=Number.isInteger(t)&&this._pages[t-1];if(!s)return;if(this.isInPresentationMode||!e)return void this._setCurrentPageNumber(t,!0);let a,r,o=0,l=0,d=0,h=0;const c=s.rotation%180!=0,u=(c?s.height:s.width)/s.scale/V.PDF_TO_CSS_UNITS,g=(c?s.width:s.height)/s.scale/V.PDF_TO_CSS_UNITS;let p=0;switch(e[1].name){case"XYZ":o=e[2],l=e[3],p=e[4],o=null!==o?o:0,l=null!==l?l:g;break;case"Fit":case"FitB":p="page-fit";break;case"FitH":case"FitBH":l=e[2],p="page-width",null===l&&this._location?(o=this._location.left,l=this._location.top):("number"!=typeof l||l<0)&&(l=g);break;case"FitV":case"FitBV":o=e[2],d=u,h=g,p="page-height";break;case"FitR":o=e[2],l=e[3],d=e[4]-o,h=e[5]-l;let t=40,i=5;this.removePageBorders&&(t=i=0),a=(this.container.clientWidth-t)/d/V.PDF_TO_CSS_UNITS,r=(this.container.clientHeight-i)/h/V.PDF_TO_CSS_UNITS,p=Math.min(Math.abs(a),Math.abs(r));break;default:return}if(n||(p&&p!==this._currentScale?this.currentScaleValue=p:0===this._currentScale&&(this.currentScaleValue=Y)),"page-fit"===p&&!e[4])return void this.#ta(s);const m=[s.viewport.convertToViewportPoint(o,l),s.viewport.convertToViewportPoint(o+d,l+h)];let f=Math.min(m[0][0],m[1][0]),b=Math.min(m[0][1],m[1][1]);i||(f=Math.max(f,0),b=Math.max(b,0)),this.#ta(s,{left:f,top:b})}_updateLocation(t){const e=this._currentScale,i=this._currentScaleValue,n=parseFloat(i)===e?Math.round(1e4*e)/100:i,s=t.id,a=this._pages[s-1],r=this.container,o=a.getPagePoint(r.scrollLeft-t.x,r.scrollTop-t.y),l=Math.round(o[0]),d=Math.round(o[1]);let h=`#page=${s}`;this.isInPresentationMode||(h+=`&zoom=${n},${l},${d}`),this._location={pageNumber:s,scale:n,top:d,left:l,rotation:this._pagesRotation,pdfOpenParams:h}}update(){const t=this._getVisiblePages(),e=t.views,i=e.length;if(0===i)return;const n=Math.max(10,2*i+1);this.#Ss.resize(n,t.ids);for(const{view:t,visibleArea:i}of e)t.updateVisibleArea(i);for(const e of this.#Ss)t.ids.has(e.id)||e.updateVisibleArea(null);this.renderingQueue.renderHighestPriority(t);const s=this._spreadMode===gt.NONE&&(this._scrollMode===ut.PAGE||this._scrollMode===ut.VERTICAL),a=this._currentPageNumber;let r=!1;for(const t of e){if(t.percent<100)break;if(t.id===a&&s){r=!0;break}}this._setCurrentPageNumber(r?a:e[0].id),this._updateLocation(t.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}#sa(){const t=this._getVisiblePages(),e=[],{ids:i,views:n}=t;for(const t of n){const{view:n}=t;n.hasEditableAnnotations()?e.push(t):i.delete(n.id)}return 0===e.length?null:(this.renderingQueue.renderHighestPriority({first:e[0],last:e.at(-1),views:e,ids:i}),i)}containsElement(t){return this.container.contains(t)}focus(){this.container.focus()}get _isContainerRtl(){return"rtl"===getComputedStyle(this.container).direction}get isInPresentationMode(){return this.presentationModeState===it}get isChangingPresentationMode(){return this.presentationModeState===et}get isHorizontalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const t=this._scrollMode===ut.PAGE?this.#Rs.pages:this._pages,e=this._scrollMode===ut.HORIZONTAL,i=e&&this._isContainerRtl;return xt({scrollEl:this.container,views:t,sortByVisibility:!0,horizontal:e,rtl:i})}cleanup(){for(const t of this._pages)t.renderingState!==Q.FINISHED&&t.reset()}_cancelRendering(){for(const t of this._pages)t.cancelRendering()}async#tn(t){if(t.pdfPage)return t.pdfPage;try{const e=await this.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(e),e}catch(t){return null}}#en(t){if(1===t.first?.id)return!0;if(t.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case ut.PAGE:return this.#Rs.scrollDown;case ut.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(t){const e=t||this._getVisiblePages(),i=this.#en(e),n=this._spreadMode!==gt.NONE&&this._scrollMode!==ut.HORIZONTAL,s=null!==this.#Us||null!==this.#Bs&&e.views.some((t=>t.detailView?.renderingCancelled)),a=this.renderingQueue.getHighestPriority(e,this._pages,i,n,s);return!!a&&(this.#tn(a).then((()=>{this.renderingQueue.renderView(a)})),!0)}get hasEqualPageSizes(){const t=this._pages[0];for(let e=1,i=this._pages.length;e<i;++e){const i=this._pages[e];if(i.width!==t.width||i.height!==t.height)return!1}return!0}getPagesOverview(){let t;return this._pages.map((e=>{const i=e.pdfPage.getViewport({scale:1}),n=Mt(i);if(void 0===t)t=n;else if(this.enablePrintAutoRotate&&n!==t)return{width:i.height,height:i.width,rotation:(i.rotation-90)%360};return{width:i.width,height:i.height,rotation:i.rotation}}))}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:this.pdfDocument.getOptionalContentConfig({intent:"display"}):Promise.resolve(null)}set optionalContentConfigPromise(t){if(!(t instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${t}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=t,this.refresh(!1,{optionalContentConfigPromise:t}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:t}))}get scrollMode(){return this._scrollMode}set scrollMode(t){if(this._scrollMode!==t){if(!Lt(t))throw new Error(`Invalid scroll mode: ${t}`);this.pagesCount>vs||(this._previousScrollMode=this._scrollMode,this._scrollMode=t,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:t}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(t=null){const e=this._scrollMode,i=this.viewer;i.classList.toggle("scrollHorizontal",e===ut.HORIZONTAL),i.classList.toggle("scrollWrapped",e===ut.WRAPPED),this.pdfDocument&&t&&(e===ut.PAGE?this.#Ys():this._previousScrollMode===ut.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#Gs(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(t){if(this._spreadMode!==t){if(!It(t))throw new Error(`Invalid spread mode: ${t}`);this._spreadMode=t,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:t}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(t=null){if(!this.pdfDocument)return;const e=this.viewer,i=this._pages;if(this._scrollMode===ut.PAGE)this.#Ys();else if(e.textContent="",this._spreadMode===gt.NONE)for(const t of this._pages)e.append(t.div);else{const t=this._spreadMode-1;let n=null;for(let s=0,a=i.length;s<a;++s)null===n?(n=document.createElement("div"),n.className="spread",e.append(n)):s%2===t&&(n=n.cloneNode(!1),e.append(n)),n.append(i[s].div)}t&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#Gs(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}_getPageAdvance(t,e=!1){switch(this._scrollMode){case ut.WRAPPED:{const{views:i}=this._getVisiblePages(),n=new Map;for(const{id:t,y:e,percent:s,widthPercent:a}of i){if(0===s||a<100)continue;let i=n.get(e);i||n.set(e,i||=[]),i.push(t)}for(const i of n.values()){const n=i.indexOf(t);if(-1===n)continue;const s=i.length;if(1===s)break;if(e)for(let e=n-1,s=0;e>=s;e--){const n=i[e],s=i[e+1]-1;if(n<s)return t-s}else for(let e=n+1,a=s;e<a;e++){const n=i[e],s=i[e-1]+1;if(n>s)return s-t}if(e){const e=i[0];if(e<t)return t-e+1}else{const e=i[s-1];if(e>t)return e-t+1}break}break}case ut.HORIZONTAL:break;case ut.PAGE:case ut.VERTICAL:{if(this._spreadMode===gt.NONE)break;const i=this._spreadMode-1;if(e&&t%2!==i)break;if(!e&&t%2===i)break;const{views:n}=this._getVisiblePages(),s=e?t-1:t+1;for(const{id:t,percent:e,widthPercent:i}of n)if(t===s){if(e>0&&100===i)return 2;break}break}}return 1}nextPage(){const t=this._currentPageNumber,e=this.pagesCount;if(t>=e)return!1;const i=this._getPageAdvance(t,!1)||1;return this.currentPageNumber=Math.min(t+i,e),!0}previousPage(){const t=this._currentPageNumber;if(t<=1)return!1;const e=this._getPageAdvance(t,!0)||1;return this.currentPageNumber=Math.max(t-e,1),!0}updateScale({drawingDelay:t,scaleFactor:e=null,steps:i=null,origin:n}){if(null===i&&null===e)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let s=this._currentScale;if(e>0&&1!==e)s=Math.round(s*e*100)/100;else if(i){const t=i>0?1.1:1/1.1,e=i>0?Math.ceil:Math.floor;i=Math.abs(i);do{s=e(10*(s*t).toFixed(2))/10}while(--i>0)}s=x(s,.1,10),this.#Gs(s,{noScroll:!1,drawingDelay:t,origin:n})}increaseScale(t={}){this.updateScale({...t,steps:t.steps??1})}decreaseScale(t={}){this.updateScale({...t,steps:-(t.steps??1)})}#Ws(t=this.container.clientHeight){t!==this.#Fs&&(this.#Fs=t,Bt.setProperty("--viewer-container-height",`${t}px`))}#ze(t){for(const e of t)if(e.target===this.container){this.#Ws(Math.floor(e.borderBoxSize[0].blockSize)),this.#As=null;break}}get containerTopLeft(){return this.#As||=[this.container.offsetTop,this.container.offsetLeft]}#Qs(){null!==this.#Us&&(clearTimeout(this.#Us),this.#Us=null),null!==this.#Bs&&(clearTimeout(this.#Bs),this.#Bs=null)}#Js(){this.#Ds?.abort(),this.#Ds=null,null!==this.#Ns&&(clearTimeout(this.#Ns),this.#Ns=null)}#qs(t){switch(t){case n.STAMP:this.#ht?.loadModel("altText");break;case n.SIGNATURE:this.#Hs?.loadSignatures()}}get annotationEditorUIManager(){return this.#Ts}get annotationEditorMode(){return this.#Ts?this.#xs:n.DISABLE}set annotationEditorMode({mode:t,editId:e=null,isFromKeyboard:i=!1}){if(!this.#Ts)throw new Error("The AnnotationEditor is not enabled.");if(this.#xs===t)return;if(!Cs(t))throw new Error(`Invalid AnnotationEditor mode: ${t}`);if(!this.pdfDocument)return;this.#qs(t);const{eventBus:s,pdfDocument:a}=this,r=async()=>{this.#Js(),this.#xs=t,await this.#Ts.updateMode(t,e,i),t===this.#xs&&a===this.pdfDocument&&s.dispatch("annotationeditormodechanged",{source:this,mode:t})};if(t===n.NONE||this.#xs===n.NONE){const e=t!==n.NONE;e||this.pdfDocument.annotationStorage.resetModifiedIds();for(const t of this._pages)t.toggleEditingMode(e);const i=this.#sa();if(e&&i){this.#Js(),this.#Ds=new AbortController;const t=AbortSignal.any([this.#We.signal,this.#Ds.signal]);return void s._on("pagerendered",(({pageNumber:t})=>{i.delete(t),0===i.size&&(this.#Ns=setTimeout(r,0))}),{signal:t})}}r()}refresh(t=!1,e=Object.create(null)){if(this.pdfDocument){for(const t of this._pages)t.update(e);this.#Qs(),t||this.update()}}}class Es{#a;constructor(t,e){this.#a=t;const i=[{element:t.firstPageButton,eventName:"firstpage",close:!0},{element:t.lastPageButton,eventName:"lastpage",close:!0},{element:t.pageRotateCwButton,eventName:"rotatecw",close:!1},{element:t.pageRotateCcwButton,eventName:"rotateccw",close:!1},{element:t.cursorSelectToolButton,eventName:"switchcursortool",eventDetails:{tool:pt},close:!0},{element:t.cursorHandToolButton,eventName:"switchcursortool",eventDetails:{tool:mt},close:!0},{element:t.scrollPageButton,eventName:"switchscrollmode",eventDetails:{mode:ut.PAGE},close:!0},{element:t.scrollVerticalButton,eventName:"switchscrollmode",eventDetails:{mode:ut.VERTICAL},close:!0},{element:t.scrollHorizontalButton,eventName:"switchscrollmode",eventDetails:{mode:ut.HORIZONTAL},close:!0},{element:t.scrollWrappedButton,eventName:"switchscrollmode",eventDetails:{mode:ut.WRAPPED},close:!0},{element:t.spreadNoneButton,eventName:"switchspreadmode",eventDetails:{mode:gt.NONE},close:!0},{element:t.spreadOddButton,eventName:"switchspreadmode",eventDetails:{mode:gt.ODD},close:!0},{element:t.spreadEvenButton,eventName:"switchspreadmode",eventDetails:{mode:gt.EVEN},close:!0},{element:t.imageAltTextSettingsButton,eventName:"imagealttextsettings",close:!0},{element:t.documentPropertiesButton,eventName:"documentproperties",close:!0}];this.eventBus=e,this.opened=!1,this.#kt(i),this.reset()}get isOpen(){return this.opened}setPageNumber(t){this.pageNumber=t,this.#Tt()}setPagesCount(t){this.pagesCount=t,this.#Tt()}reset(){this.pageNumber=0,this.pagesCount=0,this.#Tt(),this.eventBus.dispatch("switchcursortool",{source:this,reset:!0}),this.#aa({mode:ut.VERTICAL}),this.#ra({mode:gt.NONE})}#Tt(){const{firstPageButton:t,lastPageButton:e,pageRotateCwButton:i,pageRotateCcwButton:n}=this.#a;t.disabled=this.pageNumber<=1,e.disabled=this.pageNumber>=this.pagesCount,i.disabled=0===this.pagesCount,n.disabled=0===this.pagesCount}#kt(t){const{eventBus:e}=this,{toggleButton:i}=this.#a;i.addEventListener("click",this.toggle.bind(this));for(const{element:i,eventName:n,close:s,eventDetails:a}of t)i.addEventListener("click",(t=>{null!==n&&e.dispatch(n,{source:this,...a}),s&&this.close(),e.dispatch("reporttelemetry",{source:this,details:{type:"buttons",data:{id:i.id}}})}));e._on("cursortoolchanged",this.#oa.bind(this)),e._on("scrollmodechanged",this.#aa.bind(this)),e._on("spreadmodechanged",this.#ra.bind(this))}#oa({tool:t,disabled:e}){const{cursorSelectToolButton:i,cursorHandToolButton:n}=this.#a;Ot(i,t===pt),Ot(n,t===mt),i.disabled=e,n.disabled=e}#aa({mode:t}){const{scrollPageButton:e,scrollVerticalButton:i,scrollHorizontalButton:n,scrollWrappedButton:s,spreadNoneButton:a,spreadOddButton:r,spreadEvenButton:o}=this.#a;Ot(e,t===ut.PAGE),Ot(i,t===ut.VERTICAL),Ot(n,t===ut.HORIZONTAL),Ot(s,t===ut.WRAPPED);const l=this.pagesCount>vs;e.disabled=l,i.disabled=l,n.disabled=l,s.disabled=l;const d=t===ut.HORIZONTAL;a.disabled=d,r.disabled=d,o.disabled=d}#ra({mode:t}){const{spreadNoneButton:e,spreadOddButton:i,spreadEvenButton:n}=this.#a;Ot(e,t===gt.NONE),Ot(i,t===gt.ODD),Ot(n,t===gt.EVEN)}open(){if(this.opened)return;this.opened=!0;const{toggleButton:t,toolbar:e}=this.#a;jt(t,!0,e)}close(){if(!this.opened)return;this.opened=!1;const{toggleButton:t,toolbar:e}=this.#a;jt(t,!1,e)}toggle(){this.opened?this.close():this.open()}}class _s{#la;#da=null;#ha;#ca;#T;#ua;#I;#ga=null;#pa;#ma=null;#fa="";#ba=null;#va;#wa;#ya;#Ca=null;#Pa=null;#Sa;#Ea;#_a;#xa;#Ta;#Aa;#La;#Ia;#Ma=null;#ka;#Ba=null;#Da=null;#Na=!1;#y;#u;#W;#Va;#Oa;#X=null;static#ja=null;constructor({dialog:t,panels:e,typeButton:i,typeInput:n,drawButton:s,drawPlaceholder:a,drawSVG:r,drawThickness:o,imageButton:l,imageSVG:d,imagePlaceholder:h,imagePicker:c,imagePickerLink:u,description:g,clearButton:p,cancelButton:m,addButton:f,errorCloseButton:b,errorBar:v,saveCheckbox:w,saveContainer:y},C,P,S,E,_,x){this.#la=f,this.#ha=p,this.#ca=g.lastElementChild,this.#ua=g.firstElementChild,this.#I=t,this.#va=r,this.#pa=a,this.#wa=o,this.#ya=v,this.#xa=d,this.#_a=h,this.#Sa=c,this.#Ea=u,this.#W=S,this.#Ta=w,this.#Aa=y,this.#Ia=P,this.#ka=n,this.#u=E,this.#Oa=_,this.#y=x,this.#Va=new xs(C,S),_s.#ja||=Object.freeze({signature:"pdfjs-editor-add-signature-description-default-when-drawing"}),t.addEventListener("close",this.#K.bind(this)),t.addEventListener("contextmenu",(t=>{const{target:e}=t;e!==this.#ka&&e!==this.#ua&&t.preventDefault()})),t.addEventListener("drop",(t=>{H(t)})),m.addEventListener("click",this.#_.bind(this)),f.addEventListener("click",this.#Fa.bind(this)),p.addEventListener("click",(()=>{this.#gt({type:"signature",action:"pdfjs.signature.clear",data:{type:this.#Ba}}),this.#Ra(null)}),{passive:!0}),this.#ua.addEventListener("input",(()=>{this.#ca.disabled=""===this.#ua.value}),{passive:!0}),this.#ca.addEventListener("click",(()=>{this.#ua.value="",this.#ca.disabled=!0}),{passive:!0}),b.addEventListener("click",(()=>{v.hidden=!0}),{passive:!0}),this.#Ua(i,s,l,e),c.accept=z.join(","),x._on("storedsignatureschanged",this.#Ha.bind(this)),S.register(t)}#Ua(t,e,i,n){const s=this.#La=new Map([["type",t],["draw",e],["image",i]]),a=t=>{for(const[e,i]of s)i===t.target?(i.setAttribute("aria-selected",!0),i.setAttribute("tabindex",0),n.setAttribute("data-selected",e),this.#Ra(e)):(i.setAttribute("aria-selected",!1),i.setAttribute("tabindex",-1))},r=Array.from(s.values());for(let t=0,e=r.length;t<e;t++){const e=r[t];e.addEventListener("click",a,{passive:!0}),e.addEventListener("keydown",(({key:e})=>{"ArrowLeft"!==e&&"ArrowRight"!==e||r[t+("ArrowLeft"===e?-1:1)]?.focus()}),{passive:!0})}}#za(){this.#Na=!1,this.#ua.value="",this.#Ba&&(this.#da.get(this.#Ba).value="")}#Wa(t){switch(t){case"type":this.#ka.value="";break;case"draw":this.#ga=null,this.#ba=null,this.#fa="",this.#ma?.remove(),this.#ma=null,this.#pa.hidden=!1,this.#wa.value=1;break;case"image":this.#_a.hidden=!1,this.#Pa?.remove(),this.#Pa=null}}#Ra(t){if(t&&this.#Ba===t)return;this.#Ba&&(this.#da.get(this.#Ba).value=this.#ua.value),t&&(this.#Ba=t),this.#ya.hidden=!0;const e=!t;switch(e?this.#za():this.#ua.value=this.#da.get(this.#Ba).value,this.#ca.disabled=""===this.#ua.value,this.#Da?.abort(),this.#Da=new AbortController,this.#Ba){case"type":this.#$a(e);break;case"draw":this.#Ga(e);break;case"image":this.#Xa(e)}}#Za(t){this.#Ta.disabled=this.#ha.disabled=this.#la.disabled=this.#ua.disabled=!t}#$a(t){t&&this.#Wa("type"),this.#Za(this.#ka.value);const{signal:e}=this.#Da,i={passive:!0,signal:e};this.#ka.addEventListener("input",(()=>{const{value:t}=this.#ka;this.#Na||(this.#da.get("type").default=this.#ua.value=t,this.#ca.disabled=""===t),this.#Za(t)}),i),this.#ua.addEventListener("input",(()=>{this.#Na=this.#ka.value!==this.#ua.value}),i)}#Ga(t){t&&this.#Wa("draw"),this.#Za(this.#ma);const{signal:e}=this.#Da,i={signal:e};let n=NaN;const s=t=>{const{pointerId:a}=t;if(!isNaN(n)&&n!==a)return;n=a,t.preventDefault(),this.#va.setPointerCapture(a);const{width:r,height:o}=this.#va.getBoundingClientRect();let{offsetX:l,offsetY:d}=t;if(l=Math.round(l),d=Math.round(d),t.target===this.#pa&&(this.#pa.hidden=!0),!this.#ga){this.#ga={width:r,height:o,thickness:parseInt(this.#wa.value),curves:[]},this.#Za(!0);const t=new c,e=this.#ma=t.createElement("path");e.setAttribute("stroke-width",this.#wa.value),this.#va.append(e),this.#va.addEventListener("pointerdown",s,i),this.#pa.removeEventListener("pointerdown",s),""===this.#ua.value&&this.#u.get(_s.#ja.signature).then((t=>{this.#da.get("draw").default=t,this.#ua.value||=t,this.#ca.disabled=""===this.#ua.value}))}this.#ba=[l,d],this.#ga.curves.push({points:this.#ba}),this.#fa+=`M ${l} ${d}`,this.#ma.setAttribute("d",this.#fa);const h=new AbortController,u={signal:AbortSignal.any([e,h.signal])};this.#va.addEventListener("contextmenu",T,u),this.#va.addEventListener("pointermove",(t=>{t.preventDefault();let{offsetX:e,offsetY:i}=t;e=Math.round(e),i=Math.round(i);const n=this.#ba;if(!(e<0||i<0||e>r||i>o||e===n.at(-2)&&i===n.at(-1))){if(n.length>=4){const[t,s,a,r]=n.slice(-4);this.#fa+=`C${(t+5*a)/6} ${(s+5*r)/6} ${(5*a+e)/6} ${(5*r+i)/6} ${(a+e)/2} ${(r+i)/2}`}else this.#fa+=`L${e} ${i}`;n.push(e,i),this.#ma.setAttribute("d",this.#fa)}}),u),this.#va.addEventListener("pointerup",(t=>{const{pointerId:e}=t;(isNaN(n)||n===e)&&(n=NaN,t.preventDefault(),this.#va.releasePointerCapture(e),h.abort(),2===this.#ba.length&&(this.#fa+=`L${this.#ba[0]} ${this.#ba[1]}`,this.#ma.setAttribute("d",this.#fa)))}),u)};this.#ga?this.#va.addEventListener("pointerdown",s,i):this.#pa.addEventListener("pointerdown",s,i),this.#wa.addEventListener("input",(()=>{const{value:t}=this.#wa;this.#wa.setAttribute("data-l10n-args",JSON.stringify({thickness:t})),this.#ga&&(this.#ma.setAttribute("stroke-width",t),this.#ga.thickness=t)}),i)}#Xa(t){t&&this.#Wa("image"),this.#Za(this.#Pa);const{signal:e}=this.#Da,i={signal:e},n={passive:!0,signal:e};this.#Ea.addEventListener("keydown",(t=>{const{key:e}=t;"Enter"!==e&&" "!==e||(H(t),this.#Sa.click())}),i),this.#Sa.addEventListener("click",(()=>{this.#I.classList.toggle("waiting",!0)}),n),this.#Sa.addEventListener("change",(async()=>{const t=this.#Sa.files?.[0];if(!t||!z.includes(t.type))return this.#ya.hidden=!1,void this.#I.classList.toggle("waiting",!1);await this.#Ka(t)}),n),this.#Sa.addEventListener("cancel",(()=>{this.#I.classList.toggle("waiting",!1)}),n),this.#_a.addEventListener("dragover",(t=>{const{dataTransfer:e}=t;for(const{type:i}of e.items)if(z.includes(i))return e.dropEffect="copy"===e.effectAllowed?"copy":"move",void H(t);e.dropEffect="none"}),i),this.#_a.addEventListener("drop",(t=>{const{dataTransfer:{files:e}}=t;if(e?.length){for(const t of e)if(z.includes(t.type)){this.#Ka(t);break}H(t),this.#I.classList.toggle("waiting",!0)}}),i)}async#Ka(t){let e;try{e=await this.#X.imageManager.getFromFile(t)}catch(t){}if(!e)return this.#ya.hidden=!1,void this.#I.classList.toggle("waiting",!1);const{outline:i}=this.#Ca=this.#T.getFromImage(e.bitmap);if(!i)return void this.#I.classList.toggle("waiting",!1);this.#_a.hidden=!0,this.#Za(!0);const n=new c,s=this.#Pa=n.createElement("path");this.#xa.setAttribute("viewBox",i.viewBox),this.#xa.setAttribute("preserveAspectRatio","xMidYMid meet"),this.#xa.append(s),s.setAttribute("d",i.toSVGPath()),this.#da.get("image").default=t.name,""===this.#ua.value&&(this.#ua.value=t.name||"",this.#ca.disabled=""===this.#ua.value),this.#I.classList.toggle("waiting",!1)}#qa(){return this.#T.getFromText(this.#ka.value,window.getComputedStyle(this.#ka))}#Ya(){const{width:t,height:e}=this.#va.getBoundingClientRect();return this.#T.getDrawnSignature(this.#ga,t,e)}#gt(t){this.#y.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}#Qa(t,e,n){const{curves:s,areContours:a,thickness:r,width:o,height:l}=t,d=Math.max(o,l),h=U.processDrawnLines({lines:{curves:s,thickness:r,width:o,height:l},pageWidth:d,pageHeight:d,rotation:0,innerMargin:0,mustSmooth:!1,areContours:a});if(!h)return;const{outline:u}=h,g=new c,p=document.createElement("div"),m=document.createElement("button");m.addEventListener("click",(()=>{this.#y.dispatch("switchannotationeditorparams",{source:this,type:i.CREATE,value:{signatureData:{lines:{curves:s,thickness:r,width:o,height:l},mustSmooth:!1,areContours:a,description:n,uuid:e,heightInPage:40}}})})),p.append(m),p.classList.add("toolbarAddSignatureButtonContainer");const f=g.create(1,1,!0);m.append(f);const b=document.createElement("span");b.ariaHidden=!0,m.append(b),m.classList.add("toolbarAddSignatureButton"),m.type="button",b.textContent=n,m.setAttribute("data-l10n-id","pdfjs-editor-add-saved-signature-button"),m.setAttribute("data-l10n-args",JSON.stringify({description:n})),m.tabIndex=0;const v=g.createElement("path");f.append(v),f.setAttribute("viewBox",u.viewBox),f.setAttribute("preserveAspectRatio","xMidYMid meet"),a&&v.classList.add("contours"),v.setAttribute("d",u.toSVGPath());const w=document.createElement("button");p.append(w),w.classList.add("toolbarButton","deleteButton"),w.setAttribute("data-l10n-id","pdfjs-editor-delete-signature-button1"),w.type="button",w.tabIndex=0,w.addEventListener("click",(async()=>{await this.#Oa.delete(e)&&(p.remove(),this.#gt({type:"signature",action:"pdfjs.signature.delete_saved",data:{savedCount:await this.#Oa.size()}}))}));const y=document.createElement("span");w.append(y),y.setAttribute("data-l10n-id","pdfjs-editor-delete-signature-button-label1"),this.#Ia.before(p)}async#Ha(){const t=this.#Ia.parentElement;for(;t.firstElementChild!==this.#Ia;)t.firstElementChild.remove();this.#Ma=null,await this.loadSignatures(!0)}getSignature(t){return this.open(t)}async loadSignatures(t=!1){if(!this.#Ia||!t&&this.#Ia.previousElementSibling||!this.#Oa)return;if(!this.#Ma&&(this.#Ma=this.#Oa.getAll().then((async t=>[t,await Promise.all(Array.from(t.values(),(({signatureData:t})=>U.decompressSignature(t))))])),!t))return;const[e,i]=await this.#Ma;this.#Ma=null;let n=0;for(const[t,{description:s}]of e){const e=i[n++];e&&(e.curves=e.outlines.map((t=>({points:t}))),delete e.outlines,this.#Qa(e,t,s))}}async renderEditButton(t){const e=document.createElement("button");e.classList.add("altText","editDescription"),e.tabIndex=0,e.title=t.description;const i=document.createElement("span");return e.append(i),i.setAttribute("data-l10n-id","pdfjs-editor-add-signature-edit-button-label"),e.addEventListener("click",(()=>{this.#Va.open(t)}),{passive:!0}),e}async open({uiManager:t,editor:e}){this.#da||=new Map(this.#La.keys().map((t=>[t,{value:"",default:""}]))),this.#X=t,this.#T=e,this.#X.removeEditListeners();const i=await this.#Oa.isFull();this.#Aa.classList.toggle("fullStorage",i),this.#Ta.checked=!i,await this.#W.open(this.#I);const n=this.#La.get("type");n.focus(),n.click()}#_(){this.#at()}#at(){this.#W.closeIfActive(this.#I)}#K(){null===this.#T._drawId&&this.#T.remove(),this.#X?.addEditListeners(),this.#Da?.abort(),this.#Da=null,this.#X=null,this.#T=null,this.#za();for(const[t]of this.#La)this.#Wa(t);this.#Za(!1),this.#Ba=null,this.#da=null}async#Fa(){let t;const e=this.#Ba;switch(e){case"type":t=this.#qa();break;case"draw":t=this.#Ya();break;case"image":t=this.#Ca}let i=null;const n=this.#ua.value;if(this.#Ta.checked){const{newCurves:e,areContours:s,thickness:a,width:r,height:o}=t,l=await U.compressSignature({outlines:e,areContours:s,thickness:a,width:r,height:o});i=await this.#Oa.create({description:n,signatureData:l}),i&&this.#Qa({curves:e.map((t=>({points:t}))),areContours:s,thickness:a,width:r,height:o},i,n)}const s=this.#da.get(e);this.#gt({type:"signature",action:"pdfjs.signature.created",data:{type:e,saved:!!i,savedCount:await this.#Oa.size(),descriptionChanged:n!==s.default}}),this.#T.addSignature(t,40,this.#ua.value,i),this.#at()}destroy(){this.#X=null,this.#at()}}class xs{#T;#Ja;#ua;#I;#W;#tr;#X;constructor({dialog:t,description:e,cancelButton:i,updateButton:n,editSignatureView:s},a){const r=this.#ua=e.firstElementChild;this.#tr=s,this.#I=t,this.#W=a,t.addEventListener("close",this.#K.bind(this)),t.addEventListener("contextmenu",(t=>{t.target!==this.#ua&&t.preventDefault()})),i.addEventListener("click",this.#_.bind(this)),n.addEventListener("click",this.#er.bind(this));const o=e.lastElementChild;o.addEventListener("click",(()=>{r.value="",o.disabled=!0,n.disabled=""===this.#Ja})),r.addEventListener("input",(()=>{const{value:t}=r;o.disabled=""===t,n.disabled=t===this.#Ja,s.setAttribute("aria-label",t)}),{passive:!0}),a.register(t)}async open(t){this.#X=t._uiManager,this.#T=t,this.#Ja=this.#ua.value=t.description,this.#ua.dispatchEvent(new Event("input")),this.#X.removeEditListeners();const{areContours:e,outline:i}=t.getSignaturePreview(),n=(new c).createElement("path");this.#tr.append(n),this.#tr.setAttribute("viewBox",i.viewBox),n.setAttribute("d",i.toSVGPath()),e&&n.classList.add("contours"),await this.#W.open(this.#I)}async#er(){this.#T._reportTelemetry({action:"pdfjs.signature.edit_description",data:{hasBeenChanged:!0}}),this.#T.description=this.#ua.value,this.#at()}#_(){this.#T._reportTelemetry({action:"pdfjs.signature.edit_description",data:{hasBeenChanged:!1}}),this.#at()}#at(){this.#W.closeIfActive(this.#I)}#K(){this.#X?.addEditListeners(),this.#X=null,this.#T=null,this.#tr.firstElementChild.remove()}}class Ts{#ir=null;#a;constructor(t,e,i=0){this.#a=t,this.eventBus=e;const s=[{element:t.previous,eventName:"previouspage"},{element:t.next,eventName:"nextpage"},{element:t.zoomIn,eventName:"zoomin"},{element:t.zoomOut,eventName:"zoomout"},{element:t.editorFreeTextButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:e}=t.editorFreeTextButton;return e.contains("toggled")?n.NONE:n.FREETEXT}}},{element:t.editorHighlightButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:e}=t.editorHighlightButton;return e.contains("toggled")?n.NONE:n.HIGHLIGHT}}},{element:t.editorInkButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:e}=t.editorInkButton;return e.contains("toggled")?n.NONE:n.INK}}},{element:t.editorStampButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:e}=t.editorStampButton;return e.contains("toggled")?n.NONE:n.STAMP}},telemetry:{type:"editing",data:{action:"pdfjs.image.icon_click"}}},{element:t.editorSignatureButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:e}=t.editorSignatureButton;return e.contains("toggled")?n.NONE:n.SIGNATURE}}}];this.#kt(s),this.#nr({value:i}),this.reset()}#nr({value:t}){let e="normal";switch(t){case 1:e="compact";break;case 2:e="touch"}document.documentElement.setAttribute("data-toolbar-density",e)}setPageNumber(t,e){this.pageNumber=t,this.pageLabel=e,this.#Tt(!1)}setPagesCount(t,e){this.pagesCount=t,this.hasPageLabels=e,this.#Tt(!0)}setPageScale(t,e){this.pageScaleValue=(t||e).toString(),this.pageScale=e,this.#Tt(!1)}reset(){this.#ir=null,this.pageNumber=0,this.pageLabel=null,this.hasPageLabels=!1,this.pagesCount=0,this.pageScaleValue=Y,this.pageScale=1,this.#Tt(!0),this.updateLoadingIndicatorState(),this.#sr({mode:n.DISABLE})}#kt(t){const{eventBus:e}=this,{editorHighlightColorPicker:i,editorHighlightButton:s,pageNumber:a,scaleSelect:r}=this.#a,o=this;for(const{element:i,eventName:n,eventDetails:s,telemetry:a}of t)i.addEventListener("click",(t=>{null!==n&&e.dispatch(n,{source:this,...s,isFromKeyboard:0===t.detail}),a&&e.dispatch("reporttelemetry",{source:this,details:a})}));a.addEventListener("click",(function(){this.select()})),a.addEventListener("change",(function(){e.dispatch("pagenumberchanged",{source:o,value:this.value})})),r.addEventListener("change",(function(){"custom"!==this.value&&e.dispatch("scalechanged",{source:o,value:this.value})})),r.addEventListener("click",(function({target:t}){this.value===o.pageScaleValue&&"OPTION"===t.tagName.toUpperCase()&&this.blur()})),r.oncontextmenu=T,e._on("annotationeditormodechanged",this.#sr.bind(this)),e._on("showannotationeditorui",(({mode:t})=>{if(t===n.HIGHLIGHT)s.click()})),e._on("toolbardensity",this.#nr.bind(this)),i&&(e._on("annotationeditoruimanager",(({uiManager:t})=>{const e=this.#ir=new d({uiManager:t});t.setMainHighlightColorPicker(e),i.append(e.renderMainDropdown())})),e._on("mainhighlightcolorpickerupdatecolor",(({value:t})=>{this.#ir?.updateColor(t)})))}#sr({mode:t}){const{editorFreeTextButton:e,editorFreeTextParamsToolbar:i,editorHighlightButton:s,editorHighlightParamsToolbar:a,editorInkButton:r,editorInkParamsToolbar:o,editorStampButton:l,editorStampParamsToolbar:d,editorSignatureButton:h,editorSignatureParamsToolbar:c}=this.#a;jt(e,t===n.FREETEXT,i),jt(s,t===n.HIGHLIGHT,a),jt(r,t===n.INK,o),jt(l,t===n.STAMP,d),jt(h,t===n.SIGNATURE,c);const u=t===n.DISABLE;e.disabled=u,s.disabled=u,r.disabled=u,l.disabled=u,h.disabled=u}#Tt(t=!1){const{pageNumber:e,pagesCount:i,pageScaleValue:n,pageScale:s}=this,a=this.#a;t&&(this.hasPageLabels?(a.pageNumber.type="text",a.numPages.setAttribute("data-l10n-id","pdfjs-page-of-pages")):(a.pageNumber.type="number",a.numPages.setAttribute("data-l10n-id","pdfjs-of-pages"),a.numPages.setAttribute("data-l10n-args",JSON.stringify({pagesCount:i}))),a.pageNumber.max=i),this.hasPageLabels?(a.pageNumber.value=this.pageLabel,a.numPages.setAttribute("data-l10n-args",JSON.stringify({pageNumber:e,pagesCount:i}))):a.pageNumber.value=e,a.previous.disabled=e<=1,a.next.disabled=e>=i,a.zoomOut.disabled=s<=.1,a.zoomIn.disabled=s>=10;let r=!1;for(const t of a.scaleSelect.options)t.value===n?(t.selected=!0,r=!0):t.selected=!1;r||(a.customScaleOption.selected=!0,a.customScaleOption.setAttribute("data-l10n-args",JSON.stringify({scale:Math.round(1e4*s)/100})))}updateLoadingIndicatorState(t=!1){const{pageNumber:e}=this.#a;e.classList.toggle("loading",t)}}class As{constructor(t,e=20){this.fingerprint=t,this.cacheSize=e,this._initializedPromise=this._readFromStorage().then((t=>{const e=JSON.parse(t||"{}");let i=-1;if(Array.isArray(e.files)){for(;e.files.length>=this.cacheSize;)e.files.shift();for(let t=0,n=e.files.length;t<n;t++){if(e.files[t].fingerprint===this.fingerprint){i=t;break}}}else e.files=[];-1===i&&(i=e.files.push({fingerprint:this.fingerprint})-1),this.file=e.files[i],this.database=e}))}async _writeToStorage(){const t=JSON.stringify(this.database);localStorage.setItem("pdfjs.history",t)}async _readFromStorage(){return localStorage.getItem("pdfjs.history")}async set(t,e){return await this._initializedPromise,this.file[t]=e,this._writeToStorage()}async setMultiple(t){await this._initializedPromise;for(const e in t)this.file[e]=t[e];return this._writeToStorage()}async get(t,e){await this._initializedPromise;const i=this.file[t];return void 0!==i?i:e}async getMultiple(t){await this._initializedPromise;const e=Object.create(null);for(const i in t){const n=this.file[i];e[i]=void 0!==n?n:t[i]}return e}}const Ls=-1,Is=1,Ms={initialBookmark:document.location.hash.substring(1),_initializedCapability:{...Promise.withResolvers(),settled:!1},appConfig:null,pdfDocument:null,pdfLoadingTask:null,printService:null,pdfViewer:null,pdfThumbnailViewer:null,pdfRenderingQueue:null,pdfPresentationMode:null,pdfDocumentProperties:null,pdfLinkService:null,pdfHistory:null,pdfSidebar:null,pdfOutlineViewer:null,pdfAttachmentViewer:null,pdfLayerViewer:null,pdfCursorTools:null,pdfScriptingManager:null,store:null,downloadManager:null,overlayManager:null,preferences:new class extends se{async _writeToStorage(t){localStorage.setItem("pdfjs.preferences",JSON.stringify(t))}async _readFromStorage(t){return{prefs:JSON.parse(localStorage.getItem("pdfjs.preferences"))}}},toolbar:null,secondaryToolbar:null,eventBus:null,l10n:null,annotationEditorParams:null,imageAltTextSettings:null,isInitialViewSet:!1,isViewerEmbedded:window.parent!==window,url:"",baseUrl:"",mlManager:null,_downloadUrl:"",_eventBusAbortController:null,_windowAbortController:null,_globalAbortController:new AbortController,documentInfo:null,metadata:null,_contentDispositionFilename:null,_contentLength:null,_saveInProgress:!1,_wheelUnusedTicks:0,_wheelUnusedFactor:1,_touchManager:null,_touchUnusedTicks:0,_touchUnusedFactor:1,_PDFBug:null,_hasAnnotationEditors:!1,_title:document.title,_printAnnotationStoragePromise:null,_isCtrlKeyDown:!1,_caretBrowsing:null,_isScrolling:!1,editorUndoBar:null,async initialize(t){this.appConfig=t;try{await this.preferences.initializedPromise}catch(t){}let e;switch(Kt.get("pdfBugEnabled")&&await this._parseHashParams(),Kt.get("viewerCssTheme")){case 1:e="light";break;case 2:e="dark"}e&&Bt.setProperty("color-scheme",e),this.l10n=await this.externalServices.createL10n(),document.getElementsByTagName("html")[0].dir=this.l10n.getDirection(),this.l10n.translate(t.appContainer||document.documentElement),this.isViewerEmbedded&&Kt.get("externalLinkTarget")===qt.NONE&&Kt.set("externalLinkTarget",qt.BLANK),await this._initializeViewerComponents(),this.bindEvents(),this.bindWindowEvents(),this._initializedCapability.settled=!0,this._initializedCapability.resolve()},async _parseHashParams(){const t=document.location.hash.substring(1);if(!t)return;const{mainContainer:e,viewerContainer:i}=this.appConfig,n=wt(t),s=async()=>{if(this._PDFBug)return;const{PDFBug:t}=await import(Kt.get("debuggerSrc"));this._PDFBug=t};if("true"===n.get("disableworker"))try{y.workerSrc||=Kt.get("workerSrc"),await import(D.workerSrc),Kt.set("workerPort",null)}catch(t){}if(n.has("textlayer"))switch(n.get("textlayer")){case"off":Kt.set("textLayerMode",dt);break;case"visible":case"shadow":case"hover":i.classList.add(`textLayer-${n.get("textlayer")}`);try{await s(),this._PDFBug.loadCSS()}catch(t){}}if(n.has("pdfbug")){const t=n.get("pdfbug").split(",");try{await s(),this._PDFBug.init(e,t)}catch(t){}const i={pdfBug:!0,fontExtraProperties:!0};globalThis.StepperManager?.enabled&&(i.minDurationToUpdateCanvas=0),Kt.setAll(i)}n.has("locale")&&Kt.set("localeProperties",{lang:n.get("locale")});const a={disableAutoFetch:t=>"true"===t,disableFontFace:t=>"true"===t,disableHistory:t=>"true"===t,disableRange:t=>"true"===t,disableStream:t=>"true"===t,verbosity:t=>0|t};for(const t in a){const e=a[t],i=t.toLowerCase();n.has(i)&&Kt.set(t,e(n.get(i)))}},async _initializeViewerComponents(){const{appConfig:t,externalServices:e,l10n:i,mlManager:s}=this,a=this._globalAbortController.signal,r=new ie;this.eventBus=Kt.eventBus=r,s?.setEventBus(r,a);const o=this.overlayManager=new Di,l=this.pdfRenderingQueue=new $n;l.onIdle=this._cleanup.bind(this);const d=this.pdfLinkService=new Yt({eventBus:r,externalLinkTarget:Kt.get("externalLinkTarget"),externalLinkRel:Kt.get("externalLinkRel"),ignoreDestinationZoom:Kt.get("ignoreDestinationZoom")}),h=this.downloadManager=new ki,c=this.findController=new Pn({linkService:d,eventBus:r,updateMatchesCountOnProgress:!0}),u=this.pdfScriptingManager=new Gn({eventBus:r,externalServices:e,docProperties:this._scriptingDocProperties.bind(this)}),g=t.mainContainer,p=t.viewerContainer,m=Kt.get("annotationEditorMode"),f=Kt.get("forcePageColors")||window.matchMedia("(forced-colors: active)").matches?{background:Kt.get("pageColorsBackground"),foreground:Kt.get("pageColorsForeground")}:null;let b;b=Kt.get("enableUpdatedAddImage")?t.newAltTextDialog?new _i(t.newAltTextDialog,o,r):null:t.altTextDialog?new Ti(t.altTextDialog,g,o,r):null,t.editorUndoBar&&(this.editorUndoBar=new Bi(t.editorUndoBar,r));const v=Kt.get("enableSignatureEditor")&&t.addSignatureDialog?new _s(t.addSignatureDialog,t.editSignatureDialog,t.annotationEditorParams?.editorSignatureAddSignature||null,o,i,e.createSignatureStorage(r,a),r):null,w=Kt.get("enableHWA"),y=Kt.get("maxCanvasPixels"),C=Kt.get("maxCanvasDim"),P=Kt.get("capCanvasAreaFactor"),S=this.pdfViewer=new Ss({container:g,viewer:p,eventBus:r,renderingQueue:l,linkService:d,downloadManager:h,altTextManager:b,signatureManager:v,editorUndoBar:this.editorUndoBar,findController:c,scriptingManager:Kt.get("enableScripting")&&u,l10n:i,textLayerMode:Kt.get("textLayerMode"),annotationMode:Kt.get("annotationMode"),annotationEditorMode:m,annotationEditorHighlightColors:Kt.get("highlightEditorColors"),enableHighlightFloatingButton:Kt.get("enableHighlightFloatingButton"),enableUpdatedAddImage:Kt.get("enableUpdatedAddImage"),enableNewAltTextWhenAddingImage:Kt.get("enableNewAltTextWhenAddingImage"),imageResourcesPath:Kt.get("imageResourcesPath"),enablePrintAutoRotate:Kt.get("enablePrintAutoRotate"),maxCanvasPixels:y,maxCanvasDim:C,capCanvasAreaFactor:P,enableDetailCanvas:Kt.get("enableDetailCanvas"),enablePermissions:Kt.get("enablePermissions"),pageColors:f,mlManager:s,abortSignal:a,enableHWA:w,supportsPinchToZoom:this.supportsPinchToZoom,enableAutoLinking:Kt.get("enableAutoLinking"),minDurationToUpdateCanvas:Kt.get("minDurationToUpdateCanvas")});if(l.setViewer(S),d.setViewer(S),u.setViewer(S),t.sidebar?.thumbnailView&&(this.pdfThumbnailViewer=new ts({container:t.sidebar.thumbnailView,eventBus:r,renderingQueue:l,linkService:d,maxCanvasPixels:y,maxCanvasDim:C,pageColors:f,abortSignal:a,enableHWA:w}),l.setThumbnailViewer(this.pdfThumbnailViewer)),this.isViewerEmbedded||Kt.get("disableHistory")||(this.pdfHistory=new _n({linkService:d,eventBus:r}),d.setHistory(this.pdfHistory)),!this.supportsIntegratedFind&&t.findBar&&(this.findBar=new Sn(t.findBar,t.principalContainer,r)),t.annotationEditorParams)if(m!==n.DISABLE){const e=t.toolbar?.editorSignatureButton;e&&Kt.get("enableSignatureEditor")&&(e.parentElement.hidden=!1),this.annotationEditorParams=new Ai(t.annotationEditorParams,r)}else for(const t of["editorModeButtons","editorModeSeparator"])document.getElementById(t)?.classList.add("hidden");s&&t.secondaryToolbar?.imageAltTextSettingsButton&&(this.imageAltTextSettings=new xi(t.altTextSettingsDialog,o,r,s)),t.documentProperties&&(this.pdfDocumentProperties=new Gi(t.documentProperties,o,r,i,(()=>this._docFilename),(()=>this._docTitle))),t.secondaryToolbar?.cursorHandToolButton&&(this.pdfCursorTools=new Ui({container:g,eventBus:r,cursorToolOnLoad:Kt.get("cursorToolOnLoad")})),t.toolbar&&(this.toolbar=new Ts(t.toolbar,r,Kt.get("toolbarDensity"))),t.secondaryToolbar&&(Kt.get("enableAltText")&&(t.secondaryToolbar.imageAltTextSettingsButton?.classList.remove("hidden"),t.secondaryToolbar.imageAltTextSettingsSeparator?.classList.remove("hidden")),this.secondaryToolbar=new Es(t.secondaryToolbar,r)),this.supportsFullscreen&&t.secondaryToolbar?.presentationModeButton&&(this.pdfPresentationMode=new Mn({container:g,pdfViewer:S,eventBus:r})),t.passwordOverlay&&(this.passwordPrompt=new Ni(t.passwordOverlay,o,this.isViewerEmbedded)),t.sidebar?.outlineView&&(this.pdfOutlineViewer=new Tn({container:t.sidebar.outlineView,eventBus:r,l10n:i,linkService:d,downloadManager:h})),t.sidebar?.attachmentsView&&(this.pdfAttachmentViewer=new ji({container:t.sidebar.attachmentsView,eventBus:r,l10n:i,downloadManager:h})),t.sidebar?.layersView&&(this.pdfLayerViewer=new xn({container:t.sidebar.layersView,eventBus:r,l10n:i})),t.sidebar&&(this.pdfSidebar=new Kn({elements:t.sidebar,eventBus:r,l10n:i}),this.pdfSidebar.onToggled=this.forceRendering.bind(this),this.pdfSidebar.onUpdateThumbnails=()=>{for(const t of S.getCachedPageViews())t.renderingState===Q.FINISHED&&this.pdfThumbnailViewer.getThumbnail(t.id-1)?.setImage(t);this.pdfThumbnailViewer.scrollThumbnailIntoView(S.currentPageNumber)})},async run(t){await this.initialize(t);const{appConfig:e,eventBus:i}=this;let n;n=wt(document.location.search.substring(1)).get("file")??Kt.get("defaultUrl"),ks(n);const s=this._openFileInput=document.createElement("input");s.id="fileInput",s.hidden=!0,s.type="file",s.value=null,document.body.append(s),s.addEventListener("change",(function(t){const{files:e}=t.target;e&&0!==e.length&&i.dispatch("fileinputchange",{source:this,fileInput:t.target})})),e.mainContainer.addEventListener("dragover",(function(t){for(const e of t.dataTransfer.items)if("application/pdf"===e.type)return t.dataTransfer.dropEffect="copy"===t.dataTransfer.effectAllowed?"copy":"move",void H(t)})),e.mainContainer.addEventListener("drop",(function(t){"application/pdf"===t.dataTransfer.files?.[0].type&&H(t)})),Kt.get("supportsDocumentFonts")||(Kt.set("disableFontFace",!0),this.l10n.get("pdfjs-web-fonts-disabled").then((t=>{}))),this.supportsPrinting||(e.toolbar?.print?.classList.add("hidden"),e.secondaryToolbar?.printButton.classList.add("hidden")),this.supportsFullscreen||e.secondaryToolbar?.presentationModeButton?.classList.add("hidden"),this.supportsIntegratedFind&&e.findBar?.toggleButton?.classList.add("hidden"),this._hideViewBookmark()},get externalServices(){return R(this,"externalServices",new Ei)},get initialized(){return this._initializedCapability.settled},get initializedPromise(){return this._initializedCapability.promise},updateZoom(t,e,i){this.pdfViewer.isInPresentationMode||this.pdfViewer.updateScale({drawingDelay:Kt.get("defaultZoomDelay"),steps:t,scaleFactor:e,origin:i})},zoomIn(){this.updateZoom(1)},zoomOut(){this.updateZoom(-1)},zoomReset(){this.pdfViewer.isInPresentationMode||(this.pdfViewer.currentScaleValue=Y)},touchPinchCallback(t,e,i){if(this.supportsPinchToZoom){const n=this._accumulateFactor(this.pdfViewer.currentScale,i/e,"_touchUnusedFactor");this.updateZoom(null,n,t)}else{const n=30,s=this._accumulateTicks((i-e)/n,"_touchUnusedTicks");this.updateZoom(s,null,t)}},touchPinchEndCallback(){this._touchUnusedTicks=0,this._touchUnusedFactor=1},get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0},get page(){return this.pdfViewer.currentPageNumber},set page(t){this.pdfViewer.currentPageNumber=t},get supportsPrinting(){return R(this,"supportsPrinting",Kt.get("supportsPrinting")&&Wn.supportsPrinting)},get supportsFullscreen(){return R(this,"supportsFullscreen",document.fullscreenEnabled)},get supportsPinchToZoom(){return R(this,"supportsPinchToZoom",Kt.get("supportsPinchToZoom"))},get supportsIntegratedFind(){return R(this,"supportsIntegratedFind",Kt.get("supportsIntegratedFind"))},get loadingBar(){const t=document.getElementById("loadingBar"),e=t?new Dt(t):null;return R(this,"loadingBar",e)},get supportsMouseWheelZoomCtrlKey(){return R(this,"supportsMouseWheelZoomCtrlKey",Kt.get("supportsMouseWheelZoomCtrlKey"))},get supportsMouseWheelZoomMetaKey(){return R(this,"supportsMouseWheelZoomMetaKey",Kt.get("supportsMouseWheelZoomMetaKey"))},get supportsCaretBrowsingMode(){return Kt.get("supportsCaretBrowsingMode")},moveCaret(t,e){this._caretBrowsing||=new Ii(this._globalAbortController.signal,this.appConfig.mainContainer,this.appConfig.viewerContainer,this.appConfig.toolbar?.container),this._caretBrowsing.moveCaret(t,e)},setTitleUsingUrl(t="",e=null){this.url=t,this.baseUrl=G(t,"",!0),e&&(this._downloadUrl=e===t?this.baseUrl:G(e,"",!0)),S(t)&&this._hideViewBookmark();let i=b(t,"");if(!i)try{i=decodeURIComponent(f(t))}catch{}this.setTitle(i||t)},setTitle(t=this._title){if(this._title=t,this.isViewerEmbedded)return;const e=this._hasAnnotationEditors&&!this.pdfRenderingQueue.printing;document.title=`${e?"* ":""}${t}`},get _docFilename(){return this._contentDispositionFilename||b(this.url)},get _docTitle(){const{documentInfo:t,metadata:e}=this,i=e?.get("dc:title");return i&&"Untitled"!==i&&!/[\uFFF0-\uFFFF]/g.test(i)?i:t.Title},_hideViewBookmark(){},async close(){if(this._unblockDocumentLoadEvent(),this._hideViewBookmark(),!this.pdfLoadingTask)return;this.pdfDocument?.annotationStorage.size>0&&this._annotationStorageModified;const t=[];t.push(this.pdfLoadingTask.destroy()),this.pdfLoadingTask=null,this.pdfDocument&&(this.pdfDocument=null,this.pdfThumbnailViewer?.setDocument(null),this.pdfViewer.setDocument(null),this.pdfLinkService.setDocument(null),this.pdfDocumentProperties?.setDocument(null)),this.pdfLinkService.externalLinkEnabled=!0,this.store=null,this.isInitialViewSet=!1,this.url="",this.baseUrl="",this._downloadUrl="",this.documentInfo=null,this.metadata=null,this._contentDispositionFilename=null,this._contentLength=null,this._saveInProgress=!1,this._hasAnnotationEditors=!1,t.push(this.pdfScriptingManager.destroyPromise,this.passwordPrompt.close()),this.setTitle(),this.pdfSidebar?.reset(),this.pdfOutlineViewer?.reset(),this.pdfAttachmentViewer?.reset(),this.pdfLayerViewer?.reset(),this.pdfHistory?.reset(),this.findBar?.reset(),this.toolbar?.reset(),this.secondaryToolbar?.reset(),this._PDFBug?.cleanup(),await Promise.all(t)},async open(t){this.pdfLoadingTask&&await this.close();const e=Kt.getAll(Wt);Object.assign(y,e),t.url&&this.setTitleUsingUrl(t.originalUrl||t.url,t.url);const i=Kt.getAll(zt),n=m({...i,...t});return this.pdfLoadingTask=n,n.onPassword=(t,e)=>{this.isViewerEmbedded&&this._unblockDocumentLoadEvent(),this.pdfLinkService.externalLinkEnabled=!1,this.passwordPrompt.setUpdateCallback(t,e),this.passwordPrompt.open()},n.onProgress=({loaded:t,total:e})=>{this.progress(t/e)},n.promise.then((t=>{this.load(t)}),(t=>{if(n!==this.pdfLoadingTask)return;let e="pdfjs-loading-error";return t instanceof P?e="pdfjs-invalid-file-error":t instanceof j&&(e=t.missing?"pdfjs-missing-file-error":"pdfjs-unexpected-response-error"),this._documentError(e,{message:t.message}).then((()=>{throw t}))}))},async download(){let t;try{t=await(this.pdfDocument?this.pdfDocument.getData():this.pdfLoadingTask.getData())}catch{}this.downloadManager.download(t,this._downloadUrl,this._docFilename)},async save(){if(!this._saveInProgress){this._saveInProgress=!0,await this.pdfScriptingManager.dispatchWillSave();try{const t=await this.pdfDocument.saveDocument();this.downloadManager.download(t,this._downloadUrl,this._docFilename)}catch(t){await this.download()}finally{await this.pdfScriptingManager.dispatchDidSave(),this._saveInProgress=!1}this._hasAnnotationEditors&&this.externalServices.reportTelemetry({type:"editing",data:{type:"save",stats:this.pdfDocument?.annotationStorage.editorStats}})}},async downloadOrSave(){const{classList:t}=this.appConfig.appContainer;t.add("wait"),await(this.pdfDocument?.annotationStorage.size>0?this.save():this.download()),t.remove("wait")},async _documentError(t,e=null){this._unblockDocumentLoadEvent();const i=await this._otherError(t||"pdfjs-loading-error",e);this.eventBus.dispatch("documenterror",{source:this,message:i,reason:e?.message??null})},async _otherError(t,e=null){const i=await this.l10n.get(t),n=[`PDF.js v${K||"?"} (build: ${l||"?"})`];return e&&(n.push(`Message: ${e.message}`),e.stack?n.push(`Stack: ${e.stack}`):(e.filename&&n.push(`File: ${e.filename}`),e.lineNumber&&n.push(`Line: ${e.lineNumber}`))),i},progress(t){const e=Math.round(100*t);!this.loadingBar||e<=this.loadingBar.percent||(this.loadingBar.percent=e,(this.pdfDocument?.loadingParams.disableAutoFetch??Kt.get("disableAutoFetch"))&&this.loadingBar.setDisableAutoFetch())},load(t){this.pdfDocument=t,t.getDownloadInfo().then((({length:t})=>{this._contentLength=t,this.loadingBar?.hide(),a.then((()=>{this.eventBus.dispatch("documentloaded",{source:this})}))}));const e=t.getPageLayout().catch((()=>{})),i=t.getPageMode().catch((()=>{})),n=t.getOpenAction().catch((()=>{}));this.toolbar?.setPagesCount(t.numPages,!1),this.secondaryToolbar?.setPagesCount(t.numPages),this.pdfLinkService.setDocument(t),this.pdfDocumentProperties?.setDocument(t);const s=this.pdfViewer;s.setDocument(t);const{firstPagePromise:a,onePageRendered:r,pagesPromise:o}=s;this.pdfThumbnailViewer?.setDocument(t);const l=(this.store=new As(t.fingerprints[0])).getMultiple({page:null,zoom:Y,scrollLeft:"0",scrollTop:"0",rotation:null,sidebarView:nt,scrollMode:ut.UNKNOWN,spreadMode:gt.UNKNOWN}).catch((()=>{}));a.then((a=>{this.loadingBar?.setWidth(this.appConfig.viewerContainer),this._initializeAnnotationStorageCallbacks(t),Promise.all([kt,l,e,i,n]).then((async([e,i,n,a,r])=>{const l=Kt.get("viewOnLoad");this._initializePdfHistory({fingerprint:t.fingerprints[0],viewOnLoad:l,initialDest:r?.dest});const d=this.initialBookmark,h=Kt.get("defaultZoomValue");let c=h?`zoom=${h}`:null,u=null,g=Kt.get("sidebarViewOnLoad"),p=Kt.get("scrollModeOnLoad"),m=Kt.get("spreadModeOnLoad");if(i?.page&&l!==Is&&(c=`page=${i.page}&zoom=${h||i.zoom},${i.scrollLeft},${i.scrollTop}`,u=parseInt(i.rotation,10),g===nt&&(g=0|i.sidebarView),p===ut.UNKNOWN&&(p=0|i.scrollMode),m===gt.UNKNOWN&&(m=0|i.spreadMode)),a&&g===nt&&(g=function(t){switch(t){case"UseNone":return st;case"UseThumbs":return at;case"UseOutlines":return rt;case"UseAttachments":return ot;case"UseOC":return lt}return st}(a)),n&&p===ut.UNKNOWN&&m===gt.UNKNOWN){m=Vt(n).spreadMode}this.setInitialView(c,{rotation:u,sidebarView:g,scrollMode:p,spreadMode:m}),this.eventBus.dispatch("documentinit",{source:this}),this.isViewerEmbedded||s.focus(),await Promise.race([o,new Promise((t=>{setTimeout(t,1e4)}))]),(d||c)&&(s.hasEqualPageSizes||(this.initialBookmark=d,s.currentScaleValue=s.currentScaleValue,this.setInitialView(c)))})).catch((()=>{this.setInitialView()})).then((function(){s.update()}))})),o.then((()=>{this._unblockDocumentLoadEvent(),this._initializeAutoPrint(t,n)}),(t=>{this._documentError("pdfjs-loading-error",{message:t.message})})),r.then((e=>{this.externalServices.reportTelemetry({type:"pageInfo",timestamp:e.timestamp}),this.pdfOutlineViewer&&t.getOutline().then((e=>{t===this.pdfDocument&&this.pdfOutlineViewer.render({outline:e,pdfDocument:t})})),this.pdfAttachmentViewer&&t.getAttachments().then((e=>{t===this.pdfDocument&&this.pdfAttachmentViewer.render({attachments:e})})),this.pdfLayerViewer&&s.optionalContentConfigPromise.then((e=>{t===this.pdfDocument&&this.pdfLayerViewer.render({optionalContentConfig:e,pdfDocument:t})}))})),this._initializePageLabels(t),this._initializeMetadata(t)},async _scriptingDocProperties(t){return(this.documentInfo||(await new Promise((t=>{this.eventBus._on("metadataloaded",t,{once:!0})})),t===this.pdfDocument))&&(this._contentLength||(await new Promise((t=>{this.eventBus._on("documentloaded",t,{once:!0})})),t===this.pdfDocument))?{...this.documentInfo,baseURL:this.baseUrl,filesize:this._contentLength,filename:this._docFilename,metadata:this.metadata?.getRaw(),authors:this.metadata?.get("dc:creator"),numPages:this.pagesCount,URL:this.url}:null},async _initializeAutoPrint(t,e){const[i,n]=await Promise.all([e,this.pdfViewer.enableScripting?null:t.getJSActions()]);if(t!==this.pdfDocument)return;let s="Print"===i?.action;if(n)for(const t in n){if(s)break;switch(t){case"WillClose":case"WillSave":case"DidSave":case"WillPrint":case"DidPrint":continue}s=n[t].some((t=>ft.test(t)))}s&&this.triggerPrinting()},async _initializeMetadata(t){const{info:e,metadata:i,contentDispositionFilename:n,contentLength:s}=await t.getMetadata();if(t!==this.pdfDocument)return;this.documentInfo=e,this.metadata=i,this._contentDispositionFilename??=n,this._contentLength??=s;const a=this._docTitle;a?this.setTitle(`${a} - ${this._contentDispositionFilename||this._title}`):this._contentDispositionFilename&&this.setTitle(this._contentDispositionFilename),!e.IsXFAPresent||e.IsAcroFormPresent||t.isPureXfa?(e.IsAcroFormPresent||e.IsXFAPresent)&&this.pdfViewer.renderForms:t.loadingParams.enableXfa,e.IsSignaturesPresent,this.eventBus.dispatch("metadataloaded",{source:this})},async _initializePageLabels(t){const e=await t.getPageLabels();if(t!==this.pdfDocument)return;if(!e||Kt.get("disablePageLabels"))return;const i=e.length;let n=0,s=0;for(let t=0;t<i;t++){const i=e[t];if(i===(t+1).toString())n++;else{if(""!==i)break;s++}}if(n>=i||s>=i)return;const{pdfViewer:a,pdfThumbnailViewer:r,toolbar:o}=this;a.setPageLabels(e),r?.setPageLabels(e),o?.setPagesCount(i,!0),o?.setPageNumber(a.currentPageNumber,a.currentPageLabel)},_initializePdfHistory({fingerprint:t,viewOnLoad:e,initialDest:i=null}){this.pdfHistory&&(this.pdfHistory.initialize({fingerprint:t,resetHistory:e===Is,updateUrl:Kt.get("historyUpdateUrl")}),this.pdfHistory.initialBookmark&&(this.initialBookmark=this.pdfHistory.initialBookmark,this.initialRotation=this.pdfHistory.initialRotation),i&&!this.initialBookmark&&e===Ls&&(this.initialBookmark=JSON.stringify(i),this.pdfHistory.push({explicitDest:i,pageNumber:null})))},_initializeAnnotationStorageCallbacks(t){if(t!==this.pdfDocument)return;const{annotationStorage:e}=t;e.onSetModified=()=>{window.addEventListener("beforeunload",sa),this._annotationStorageModified=!0},e.onResetModified=()=>{window.removeEventListener("beforeunload",sa),delete this._annotationStorageModified},e.onAnnotationEditor=t=>{this._hasAnnotationEditors=!!t,this.setTitle()}},setInitialView(t,{rotation:e,sidebarView:i,scrollMode:n,spreadMode:s}={}){const a=t=>{At(t)&&(this.pdfViewer.pagesRotation=t)};this.isInitialViewSet=!0,this.pdfSidebar?.setInitialView(i),((t,e)=>{Lt(t)&&(this.pdfViewer.scrollMode=t),It(e)&&(this.pdfViewer.spreadMode=e)})(n,s),this.initialBookmark?(a(this.initialRotation),delete this.initialRotation,this.pdfLinkService.setHash(this.initialBookmark),this.initialBookmark=null):t&&(a(e),this.pdfLinkService.setHash(t)),this.toolbar?.setPageNumber(this.pdfViewer.currentPageNumber,this.pdfViewer.currentPageLabel),this.secondaryToolbar?.setPageNumber(this.pdfViewer.currentPageNumber),this.pdfViewer.currentScaleValue||(this.pdfViewer.currentScaleValue=Y)},_cleanup(){this.pdfDocument&&(this.pdfViewer.cleanup(),this.pdfThumbnailViewer?.cleanup(),this.pdfDocument.cleanup(Kt.get("fontExtraProperties")))},forceRendering(){this.pdfRenderingQueue.printing=!!this.printService,this.pdfRenderingQueue.isThumbnailViewEnabled=this.pdfSidebar?.visibleView===at,this.pdfRenderingQueue.renderHighestPriority()},beforePrint(){this._printAnnotationStoragePromise=this.pdfScriptingManager.dispatchWillPrint().catch((()=>{})).then((()=>this.pdfDocument?.annotationStorage.print)),this.printService||(this.supportsPrinting?this.pdfViewer.pageViewsReady?(this.printService=Wn.createPrintService({pdfDocument:this.pdfDocument,pagesOverview:this.pdfViewer.getPagesOverview(),printContainer:this.appConfig.printContainer,printResolution:Kt.get("printResolution"),printAnnotationStoragePromise:this._printAnnotationStoragePromise}),this.forceRendering(),this.setTitle(),this.printService.layout(),this._hasAnnotationEditors&&this.externalServices.reportTelemetry({type:"editing",data:{type:"print",stats:this.pdfDocument?.annotationStorage.editorStats}})):this.l10n.get("pdfjs-printing-not-ready").then((t=>{window.alert(t)})):this._otherError("pdfjs-printing-not-supported"))},afterPrint(){this._printAnnotationStoragePromise&&(this._printAnnotationStoragePromise.then((()=>{this.pdfScriptingManager.dispatchDidPrint()})),this._printAnnotationStoragePromise=null),this.printService&&(this.printService.destroy(),this.printService=null,this.pdfDocument?.annotationStorage.resetModified()),this.forceRendering(),this.setTitle()},rotatePages(t){this.pdfViewer.pagesRotation+=t},requestPresentationMode(){this.pdfPresentationMode?.request()},triggerPrinting(){this.supportsPrinting&&window.print()},bindEvents(){if(this._eventBusAbortController)return;const t={signal:(this._eventBusAbortController=new AbortController).signal},{eventBus:e,externalServices:i,pdfDocumentProperties:n,pdfViewer:s,preferences:a}=this;e._on("resize",Hs.bind(this),t),e._on("hashchange",zs.bind(this),t),e._on("beforeprint",this.beforePrint.bind(this),t),e._on("afterprint",this.afterPrint.bind(this),t),e._on("pagerender",Ns.bind(this),t),e._on("pagerendered",Vs.bind(this),t),e._on("updateviewarea",Rs.bind(this),t),e._on("pagechanging",Ys.bind(this),t),e._on("scalechanging",Ks.bind(this),t),e._on("rotationchanging",qs.bind(this),t),e._on("sidebarviewchanged",Fs.bind(this),t),e._on("pagemode",Os.bind(this),t),e._on("namedaction",js.bind(this),t),e._on("presentationmodechanged",(t=>s.presentationModeState=t.state),t),e._on("presentationmode",this.requestPresentationMode.bind(this),t),e._on("switchannotationeditormode",(t=>s.annotationEditorMode=t),t),e._on("print",this.triggerPrinting.bind(this),t),e._on("download",this.downloadOrSave.bind(this),t),e._on("firstpage",(()=>this.page=1),t),e._on("lastpage",(()=>this.page=this.pagesCount),t),e._on("nextpage",(()=>s.nextPage()),t),e._on("previouspage",(()=>s.previousPage()),t),e._on("zoomin",this.zoomIn.bind(this),t),e._on("zoomout",this.zoomOut.bind(this),t),e._on("zoomreset",this.zoomReset.bind(this),t),e._on("pagenumberchanged",Ws.bind(this),t),e._on("scalechanged",(t=>s.currentScaleValue=t.value),t),e._on("rotatecw",this.rotatePages.bind(this,90),t),e._on("rotateccw",this.rotatePages.bind(this,-90),t),e._on("optionalcontentconfig",(t=>s.optionalContentConfigPromise=t.promise),t),e._on("switchscrollmode",(t=>s.scrollMode=t.mode),t),e._on("scrollmodechanged",Us.bind(this,"scrollMode"),t),e._on("switchspreadmode",(t=>s.spreadMode=t.mode),t),e._on("spreadmodechanged",Us.bind(this,"spreadMode"),t),e._on("imagealttextsettings",$s.bind(this),t),e._on("documentproperties",(()=>n?.open()),t),e._on("findfromurlhash",Gs.bind(this),t),e._on("updatefindmatchescount",Xs.bind(this),t),e._on("updatefindcontrolstate",Zs.bind(this),t),e._on("fileinputchange",Bs.bind(this),t),e._on("openfile",Ds.bind(this),t)},bindWindowEvents(){if(this._windowAbortController)return;this._windowAbortController=new AbortController;const{eventBus:t,appConfig:{mainContainer:e},pdfViewer:i,_windowAbortController:{signal:n}}=this;if(this._touchManager=new $({container:window,isPinchingDisabled:()=>i.isInPresentationMode,isPinchingStopped:()=>this.overlayManager?.active,onPinching:this.touchPinchCallback.bind(this),onPinchEnd:this.touchPinchEndCallback.bind(this),signal:n}),function t(e=null){e&&i.refresh(),window.matchMedia(`(resolution: ${I.pixelRatio}dppx)`).addEventListener("change",t,{once:!0,signal:n})}(),window.addEventListener("wheel",Qs.bind(this),{passive:!1,signal:n}),window.addEventListener("click",ea.bind(this),{signal:n}),window.addEventListener("keydown",na.bind(this),{signal:n}),window.addEventListener("keyup",ia.bind(this),{signal:n}),window.addEventListener("resize",(()=>t.dispatch("resize",{source:window})),{signal:n}),window.addEventListener("hashchange",(()=>{t.dispatch("hashchange",{source:window,hash:document.location.hash.substring(1)})}),{signal:n}),window.addEventListener("beforeprint",(()=>t.dispatch("beforeprint",{source:window})),{signal:n}),window.addEventListener("afterprint",(()=>t.dispatch("afterprint",{source:window})),{signal:n}),window.addEventListener("updatefromsandbox",(e=>{t.dispatch("updatefromsandbox",{source:window,detail:e.detail})}),{signal:n}),!("onscrollend"in document.documentElement))return;({scrollTop:this._lastScrollTop,scrollLeft:this._lastScrollLeft}=e);const s=()=>{({scrollTop:this._lastScrollTop,scrollLeft:this._lastScrollLeft}=e),this._isScrolling=!1,e.addEventListener("scroll",a,{passive:!0,signal:n}),e.removeEventListener("scrollend",s),e.removeEventListener("blur",s)},a=()=>{this._isCtrlKeyDown||this._lastScrollTop===e.scrollTop&&this._lastScrollLeft===e.scrollLeft||(e.removeEventListener("scroll",a),this._isScrolling=!0,e.addEventListener("scrollend",s,{signal:n}),e.addEventListener("blur",s,{signal:n}))};e.addEventListener("scroll",a,{passive:!0,signal:n})},unbindEvents(){this._eventBusAbortController?.abort(),this._eventBusAbortController=null},unbindWindowEvents(){this._windowAbortController?.abort(),this._windowAbortController=null,this._touchManager=null},async testingClose(){this.unbindEvents(),this.unbindWindowEvents(),this._globalAbortController?.abort(),this._globalAbortController=null,this.findBar?.close(),await Promise.all([this.l10n?.destroy(),this.close()])},_accumulateTicks(t,e){(this[e]>0&&t<0||this[e]<0&&t>0)&&(this[e]=0),this[e]+=t;const i=Math.trunc(this[e]);return this[e]-=i,i},_accumulateFactor(t,e,i){if(1===e)return 1;(this[i]>1&&e<1||this[i]<1&&e>1)&&(this[i]=1);const n=Math.floor(t*e*this[i]*100)/(100*t);return this[i]=e/n,n},_unblockDocumentLoadEvent(){document.blockUnblockOnload?.(!1),this._unblockDocumentLoadEvent=()=>{}},get scriptingReady(){return this.pdfScriptingManager.ready}};Wn.initGlobals(Ms);{const t=new Set(["null","http://mozilla.github.io","https://mozilla.github.io"]);var ks=function(e){if(!e)return;const i=URL.parse(window.location)?.origin||"null";if(t.has(i))return;const n=URL.parse(e,window.location)?.origin;if(n===i)return;const s=new Error("file origin does not match viewer's");throw Ms._documentError("pdfjs-loading-error",{message:s.message}),s},Bs=function(t){if(this.pdfViewer?.isInPresentationMode)return;const e=t.fileInput.files[0];this.open({url:URL.createObjectURL(e),originalUrl:e.name})},Ds=function(t){this._openFileInput?.click()}}function Ns({pageNumber:t}){t===this.page&&this.toolbar?.updateLoadingIndicatorState(!0)}function Vs({pageNumber:t,isDetailView:e,error:i}){if(t===this.page&&this.toolbar?.updateLoadingIndicatorState(!1),!e&&this.pdfSidebar?.visibleView===at){const e=this.pdfViewer.getPageView(t-1),i=this.pdfThumbnailViewer?.getThumbnail(t-1);e&&i?.setImage(e)}i&&this._otherError("pdfjs-rendering-error",i)}function Os({mode:t}){let e;switch(t){case"thumbs":e=at;break;case"bookmarks":case"outline":e=rt;break;case"attachments":e=ot;break;case"layers":e=lt;break;case"none":e=st;break;default:return}this.pdfSidebar?.switchView(e,!0)}function js(t){switch(t.action){case"GoToPage":this.appConfig.toolbar?.pageNumber.select();break;case"Find":this.supportsIntegratedFind||this.findBar?.toggle();break;case"Print":this.triggerPrinting();break;case"SaveAs":this.downloadOrSave()}}function Fs({view:t}){this.pdfRenderingQueue.isThumbnailViewEnabled=t===at,this.isInitialViewSet&&this.store?.set("sidebarView",t).catch((()=>{}))}function Rs({location:t}){this.isInitialViewSet&&this.store?.setMultiple({page:t.pageNumber,zoom:t.scale,scrollLeft:t.left,scrollTop:t.top,rotation:t.rotation}).catch((()=>{}))}function Us(t,e){this.isInitialViewSet&&!this.pdfViewer.isInPresentationMode&&this.store?.set(t,e.mode).catch((()=>{}))}function Hs(){const{pdfDocument:t,pdfViewer:e,pdfRenderingQueue:i}=this;if(i.printing&&window.matchMedia("print").matches)return;if(!t)return;const n=e.currentScaleValue;"auto"!==n&&"page-fit"!==n&&"page-width"!==n||(e.currentScaleValue=n),e.update()}function zs(t){const e=t.hash;e&&(this.isInitialViewSet?this.pdfHistory?.popStateInProgress||this.pdfLinkService.setHash(e):this.initialBookmark=e)}function Ws(t){const{pdfViewer:e}=this;""!==t.value&&this.pdfLinkService.goToPage(t.value),t.value!==e.currentPageNumber.toString()&&t.value!==e.currentPageLabel&&this.toolbar?.setPageNumber(e.currentPageNumber,e.currentPageLabel)}function $s(){this.imageAltTextSettings?.open({enableGuessAltText:Kt.get("enableGuessAltText"),enableNewAltTextWhenAddingImage:Kt.get("enableNewAltTextWhenAddingImage")})}function Gs(t){this.eventBus.dispatch("find",{source:t.source,type:"",query:t.query,caseSensitive:!1,entireWord:!1,highlightAll:!0,findPrevious:!1,matchDiacritics:!0})}function Xs({matchesCount:t}){this.supportsIntegratedFind?this.externalServices.updateFindMatchesCount(t):this.findBar?.updateResultsCount(t)}function Zs({state:t,previous:e,entireWord:i,matchesCount:n,rawQuery:s}){this.supportsIntegratedFind?this.externalServices.updateFindControlState({result:t,findPrevious:e,entireWord:i,matchesCount:n,rawQuery:s}):this.findBar?.updateUIState(t,e,n)}function Ks(t){this.toolbar?.setPageScale(t.presetValue,t.scale),this.pdfViewer.update()}function qs(t){this.pdfThumbnailViewer&&(this.pdfThumbnailViewer.pagesRotation=t.pagesRotation),this.forceRendering(),this.pdfViewer.currentPageNumber=t.pageNumber}function Ys({pageNumber:t,pageLabel:e}){this.toolbar?.setPageNumber(t,e),this.secondaryToolbar?.setPageNumber(t),this.pdfSidebar?.visibleView===at&&this.pdfThumbnailViewer?.scrollThumbnailIntoView(t);const i=this.pdfViewer.getPageView(t-1);this.toolbar?.updateLoadingIndicatorState(i?.renderingState===Q.RUNNING)}function Qs(t){const{pdfViewer:e,supportsMouseWheelZoomCtrlKey:i,supportsMouseWheelZoomMetaKey:n,supportsPinchToZoom:s}=this;if(e.isInPresentationMode)return;const a=t.deltaMode;let r=Math.exp(-t.deltaY/100);const o=t.ctrlKey&&!this._isCtrlKeyDown&&a===WheelEvent.DOM_DELTA_PIXEL&&0===t.deltaX&&(Math.abs(r-1)<.05||!1)&&0===t.deltaZ,l=[t.clientX,t.clientY];if(o||t.ctrlKey&&i||t.metaKey&&n){if(t.preventDefault(),this._isScrolling||"hidden"===document.visibilityState||this.overlayManager.active)return;if(o&&s)r=this._accumulateFactor(e.currentScale,r,"_wheelUnusedFactor"),this.updateZoom(null,r,l);else{const e=Tt(t);let i=0;if(a===WheelEvent.DOM_DELTA_LINE||a===WheelEvent.DOM_DELTA_PAGE)i=Math.abs(e)>=1?Math.sign(e):this._accumulateTicks(e,"_wheelUnusedTicks");else{const t=30;i=this._accumulateTicks(e/t,"_wheelUnusedTicks")}this.updateZoom(i,null,l)}}}function Js({target:t}){if(!this.secondaryToolbar?.isOpen)return;const{toolbar:e,secondaryToolbar:i}=this.appConfig;(this.pdfViewer.containsElement(t)||e?.container.contains(t)&&!i?.toolbar.contains(t)&&!i?.toggleButton.contains(t))&&this.secondaryToolbar.close()}function ta(t){this.editorUndoBar?.isOpen&&this.appConfig.secondaryToolbar?.toolbar.contains(t.target)&&this.editorUndoBar.hide()}function ea(t){Js.call(this,t),ta.call(this,t)}function ia(t){"Control"===t.key&&(this._isCtrlKeyDown=!1)}function na(t){if(this._isCtrlKeyDown="Control"===t.key,this.editorUndoBar?.isOpen&&9!==t.keyCode&&16!==t.keyCode&&(13!==t.keyCode&&32!==t.keyCode||Nt()!==this.appConfig.editorUndoBar.undoButton)&&this.editorUndoBar.hide(),this.overlayManager.active)return;const{eventBus:e,pdfViewer:i}=this,n=i.isInPresentationMode;let s=!1,a=!1;const r=(t.ctrlKey?1:0)|(t.altKey?2:0)|(t.shiftKey?4:0)|(t.metaKey?8:0);if(1===r||8===r||5===r||12===r)switch(t.keyCode){case 70:this.supportsIntegratedFind||t.shiftKey||(this.findBar?.open(),s=!0);break;case 71:if(!this.supportsIntegratedFind){const{state:t}=this.findController;if(t){const i={source:window,type:"again",findPrevious:5===r||12===r};e.dispatch("find",{...t,...i})}s=!0}break;case 61:case 107:case 187:case 171:this.zoomIn(),s=!0;break;case 173:case 109:case 189:this.zoomOut(),s=!0;break;case 48:case 96:n||(setTimeout((()=>{this.zoomReset()})),s=!1);break;case 38:(n||this.page>1)&&(this.page=1,s=!0,a=!0);break;case 40:(n||this.page<this.pagesCount)&&(this.page=this.pagesCount,s=!0,a=!0)}if((3===r||10===r)&&71===t.keyCode)this.appConfig.toolbar&&(this.appConfig.toolbar.pageNumber.select(),s=!0);if(s)return a&&!n&&i.focus(),void t.preventDefault();const o=Nt(),l=o?.tagName.toUpperCase();if("INPUT"!==l&&"TEXTAREA"!==l&&"SELECT"!==l&&("BUTTON"!==l||13!==t.keyCode&&32!==t.keyCode)&&!o?.isContentEditable||27===t.keyCode){if(0===r){let e=0,r=!1;switch(t.keyCode){case 38:if(this.supportsCaretBrowsingMode){this.moveCaret(!0,!1),s=!0;break}case 33:i.isVerticalScrollbarEnabled&&(r=!0),e=-1;break;case 8:n||(r=!0),e=-1;break;case 37:if(this.supportsCaretBrowsingMode)return;i.isHorizontalScrollbarEnabled&&(r=!0);case 75:case 80:e=-1;break;case 27:this.secondaryToolbar?.isOpen&&(this.secondaryToolbar.close(),s=!0),!this.supportsIntegratedFind&&this.findBar?.opened&&(this.findBar.close(),s=!0);break;case 40:if(this.supportsCaretBrowsingMode){this.moveCaret(!1,!1),s=!0;break}case 34:i.isVerticalScrollbarEnabled&&(r=!0),e=1;break;case 13:case 32:n||(r=!0),e=1;break;case 39:if(this.supportsCaretBrowsingMode)return;i.isHorizontalScrollbarEnabled&&(r=!0);case 74:case 78:e=1;break;case 36:(n||this.page>1)&&(this.page=1,s=!0,a=!0);break;case 35:(n||this.page<this.pagesCount)&&(this.page=this.pagesCount,s=!0,a=!0);break;case 83:this.pdfCursorTools?.switchTool(pt);break;case 72:this.pdfCursorTools?.switchTool(mt);break;case 82:this.rotatePages(90);break;case 115:this.pdfSidebar?.toggle()}0===e||r&&"page-fit"!==i.currentScaleValue||(e>0?i.nextPage():i.previousPage(),s=!0)}if(4===r)switch(t.keyCode){case 13:case 32:if(!n&&"page-fit"!==i.currentScaleValue)break;i.previousPage(),s=!0;break;case 38:this.moveCaret(!0,!0),s=!0;break;case 40:this.moveCaret(!1,!0),s=!0;break;case 82:this.rotatePages(-90)}s||n||(t.keyCode>=33&&t.keyCode<=40||32===t.keyCode&&"BUTTON"!==l)&&(a=!0),a&&!i.containsElement(o)&&i.focus(),s&&t.preventDefault()}}function sa(t){return t.preventDefault(),t.returnValue="",!1}const aa={LinkTarget:qt,RenderingStates:Q,ScrollMode:ut,SpreadMode:gt};async function ra(){const t={appContainer:document.body,principalContainer:document.getElementById("mainContainer"),mainContainer:document.getElementById("viewerContainer"),viewerContainer:document.getElementById("viewer"),toolbar:{container:document.getElementById("toolbarContainer"),numPages:document.getElementById("numPages"),pageNumber:document.getElementById("pageNumber"),scaleSelect:document.getElementById("scaleSelect"),customScaleOption:document.getElementById("customScaleOption"),previous:document.getElementById("previous"),next:document.getElementById("next"),zoomIn:document.getElementById("zoomInButton"),zoomOut:document.getElementById("zoomOutButton"),print:document.getElementById("printButton"),editorFreeTextButton:document.getElementById("editorFreeTextButton"),editorFreeTextParamsToolbar:document.getElementById("editorFreeTextParamsToolbar"),editorHighlightButton:document.getElementById("editorHighlightButton"),editorHighlightParamsToolbar:document.getElementById("editorHighlightParamsToolbar"),editorHighlightColorPicker:document.getElementById("editorHighlightColorPicker"),editorInkButton:document.getElementById("editorInkButton"),editorInkParamsToolbar:document.getElementById("editorInkParamsToolbar"),editorStampButton:document.getElementById("editorStampButton"),editorStampParamsToolbar:document.getElementById("editorStampParamsToolbar"),editorSignatureButton:document.getElementById("editorSignatureButton"),editorSignatureParamsToolbar:document.getElementById("editorSignatureParamsToolbar"),download:document.getElementById("downloadButton")},secondaryToolbar:{toolbar:document.getElementById("secondaryToolbar"),toggleButton:document.getElementById("secondaryToolbarToggleButton"),presentationModeButton:document.getElementById("presentationMode"),openFileButton:document.getElementById("secondaryOpenFile"),printButton:document.getElementById("secondaryPrint"),downloadButton:document.getElementById("secondaryDownload"),viewBookmarkButton:document.getElementById("viewBookmark"),firstPageButton:document.getElementById("firstPage"),lastPageButton:document.getElementById("lastPage"),pageRotateCwButton:document.getElementById("pageRotateCw"),pageRotateCcwButton:document.getElementById("pageRotateCcw"),cursorSelectToolButton:document.getElementById("cursorSelectTool"),cursorHandToolButton:document.getElementById("cursorHandTool"),scrollPageButton:document.getElementById("scrollPage"),scrollVerticalButton:document.getElementById("scrollVertical"),scrollHorizontalButton:document.getElementById("scrollHorizontal"),scrollWrappedButton:document.getElementById("scrollWrapped"),spreadNoneButton:document.getElementById("spreadNone"),spreadOddButton:document.getElementById("spreadOdd"),spreadEvenButton:document.getElementById("spreadEven"),imageAltTextSettingsButton:document.getElementById("imageAltTextSettings"),imageAltTextSettingsSeparator:document.getElementById("imageAltTextSettingsSeparator"),documentPropertiesButton:document.getElementById("documentProperties")},sidebar:{outerContainer:document.getElementById("outerContainer"),sidebarContainer:document.getElementById("sidebarContainer"),toggleButton:document.getElementById("sidebarToggleButton"),resizer:document.getElementById("sidebarResizer"),thumbnailButton:document.getElementById("viewThumbnail"),outlineButton:document.getElementById("viewOutline"),attachmentsButton:document.getElementById("viewAttachments"),layersButton:document.getElementById("viewLayers"),thumbnailView:document.getElementById("thumbnailView"),outlineView:document.getElementById("outlineView"),attachmentsView:document.getElementById("attachmentsView"),layersView:document.getElementById("layersView"),currentOutlineItemButton:document.getElementById("currentOutlineItem")},findBar:{bar:document.getElementById("findbar"),toggleButton:document.getElementById("viewFindButton"),findField:document.getElementById("findInput"),highlightAllCheckbox:document.getElementById("findHighlightAll"),caseSensitiveCheckbox:document.getElementById("findMatchCase"),matchDiacriticsCheckbox:document.getElementById("findMatchDiacritics"),entireWordCheckbox:document.getElementById("findEntireWord"),findMsg:document.getElementById("findMsg"),findResultsCount:document.getElementById("findResultsCount"),findPreviousButton:document.getElementById("findPreviousButton"),findNextButton:document.getElementById("findNextButton")},passwordOverlay:{dialog:document.getElementById("passwordDialog"),label:document.getElementById("passwordText"),input:document.getElementById("password"),submitButton:document.getElementById("passwordSubmit"),cancelButton:document.getElementById("passwordCancel")},documentProperties:{dialog:document.getElementById("documentPropertiesDialog"),closeButton:document.getElementById("documentPropertiesClose"),fields:{fileName:document.getElementById("fileNameField"),fileSize:document.getElementById("fileSizeField"),title:document.getElementById("titleField"),author:document.getElementById("authorField"),subject:document.getElementById("subjectField"),keywords:document.getElementById("keywordsField"),creationDate:document.getElementById("creationDateField"),modificationDate:document.getElementById("modificationDateField"),creator:document.getElementById("creatorField"),producer:document.getElementById("producerField"),version:document.getElementById("versionField"),pageCount:document.getElementById("pageCountField"),pageSize:document.getElementById("pageSizeField"),linearized:document.getElementById("linearizedField")}},altTextDialog:{dialog:document.getElementById("altTextDialog"),optionDescription:document.getElementById("descriptionButton"),optionDecorative:document.getElementById("decorativeButton"),textarea:document.getElementById("descriptionTextarea"),cancelButton:document.getElementById("altTextCancel"),saveButton:document.getElementById("altTextSave")},newAltTextDialog:{dialog:document.getElementById("newAltTextDialog"),title:document.getElementById("newAltTextTitle"),descriptionContainer:document.getElementById("newAltTextDescriptionContainer"),textarea:document.getElementById("newAltTextDescriptionTextarea"),disclaimer:document.getElementById("newAltTextDisclaimer"),learnMore:document.getElementById("newAltTextLearnMore"),imagePreview:document.getElementById("newAltTextImagePreview"),createAutomatically:document.getElementById("newAltTextCreateAutomatically"),createAutomaticallyButton:document.getElementById("newAltTextCreateAutomaticallyButton"),downloadModel:document.getElementById("newAltTextDownloadModel"),downloadModelDescription:document.getElementById("newAltTextDownloadModelDescription"),error:document.getElementById("newAltTextError"),errorCloseButton:document.getElementById("newAltTextCloseButton"),cancelButton:document.getElementById("newAltTextCancel"),notNowButton:document.getElementById("newAltTextNotNow"),saveButton:document.getElementById("newAltTextSave")},altTextSettingsDialog:{dialog:document.getElementById("altTextSettingsDialog"),createModelButton:document.getElementById("createModelButton"),aiModelSettings:document.getElementById("aiModelSettings"),learnMore:document.getElementById("altTextSettingsLearnMore"),deleteModelButton:document.getElementById("deleteModelButton"),downloadModelButton:document.getElementById("downloadModelButton"),showAltTextDialogButton:document.getElementById("showAltTextDialogButton"),altTextSettingsCloseButton:document.getElementById("altTextSettingsCloseButton"),closeButton:document.getElementById("altTextSettingsCloseButton")},addSignatureDialog:{dialog:document.getElementById("addSignatureDialog"),panels:document.getElementById("addSignatureActionContainer"),typeButton:document.getElementById("addSignatureTypeButton"),typeInput:document.getElementById("addSignatureTypeInput"),drawButton:document.getElementById("addSignatureDrawButton"),drawSVG:document.getElementById("addSignatureDraw"),drawPlaceholder:document.getElementById("addSignatureDrawPlaceholder"),drawThickness:document.getElementById("addSignatureDrawThickness"),imageButton:document.getElementById("addSignatureImageButton"),imageSVG:document.getElementById("addSignatureImage"),imagePlaceholder:document.getElementById("addSignatureImagePlaceholder"),imagePicker:document.getElementById("addSignatureFilePicker"),imagePickerLink:document.getElementById("addSignatureImageBrowse"),description:document.getElementById("addSignatureDescription"),clearButton:document.getElementById("clearSignatureButton"),saveContainer:document.getElementById("addSignatureSaveContainer"),saveCheckbox:document.getElementById("addSignatureSaveCheckbox"),errorBar:document.getElementById("addSignatureError"),errorCloseButton:document.getElementById("addSignatureErrorCloseButton"),cancelButton:document.getElementById("addSignatureCancelButton"),addButton:document.getElementById("addSignatureAddButton")},editSignatureDialog:{dialog:document.getElementById("editSignatureDescriptionDialog"),description:document.getElementById("editSignatureDescription"),editSignatureView:document.getElementById("editSignatureView"),cancelButton:document.getElementById("editSignatureCancelButton"),updateButton:document.getElementById("editSignatureUpdateButton")},annotationEditorParams:{editorFreeTextFontSize:document.getElementById("editorFreeTextFontSize"),editorFreeTextColor:document.getElementById("editorFreeTextColor"),editorInkColor:document.getElementById("editorInkColor"),editorInkThickness:document.getElementById("editorInkThickness"),editorInkOpacity:document.getElementById("editorInkOpacity"),editorStampAddImage:document.getElementById("editorStampAddImage"),editorSignatureAddSignature:document.getElementById("editorSignatureAddSignature"),editorFreeHighlightThickness:document.getElementById("editorFreeHighlightThickness"),editorHighlightShowAll:document.getElementById("editorHighlightShowAll")},printContainer:document.getElementById("printContainer"),editorUndoBar:{container:document.getElementById("editorUndoBar"),message:document.getElementById("editorUndoBarMessage"),undoButton:document.getElementById("editorUndoBarUndoButton"),closeButton:document.getElementById("editorUndoBarCloseButton")}},e=new CustomEvent("webviewerloaded",{bubbles:!0,cancelable:!0,detail:{source:window}});try{parent.document.dispatchEvent(e)}catch(t){document.dispatchEvent(e)}await Ms.run(t)}window.PDFViewerApplication=Ms,window.PDFViewerApplicationConstants=aa,window.PDFViewerApplicationOptions=Kt,document.blockUnblockOnload?.(!0);let oa=null;async function la(){if(await ra(),window.parent==window)return;const t=document.location.hash?document.location.hash.substring(1):"",e=new URLSearchParams(t).get("uniqueid")+"";window.parent.postMessage({type:e+".init",uniqueId:e},"*");window.addEventListener("message",(t=>{if(t.source===window)return;const i=t.data||{};if(i.uniqueId+""===e)switch(i.type){case"init":{const{certification:n,pdfInfo:s,title:a}=i.data;oa=t,t.source.postMessage({type:e+".inited",uniqueId:e},t.origin);break}case"open":{const{certification:t,pdfInfo:e,title:n}=i.data;Ms.open({url:window.URL.createObjectURL(e.data)});break}case"getFile":{Ms.pdfViewer.annotationEditorUIManager?.currentLayer?.commitOrRemove();const i=Ms.pdfDocument,n=i=>{t.source.postMessage({type:e+".file",uniqueId:e,data:i},t.origin)};if(i.annotationStorage.size>0){const{map:t,transfer:e}=i.annotationStorage.serializable;i.saveDocument().then((e=>{const i=new Blob([e],{type:"application/pdf"});n({data:i,annotationStorage:t})})).catch((t=>{n()}))}else n();break}}}))}"interactive"===document.readyState||"complete"===document.readyState?la():document.addEventListener("DOMContentLoaded",la,!0);export{Ms as PDFViewerApplication,aa as PDFViewerApplicationConstants,Kt as PDFViewerApplicationOptions};