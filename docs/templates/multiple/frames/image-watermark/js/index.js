import{demoData}from"../../demo-data.js";import{defaultWatermarkOptions,getOptionsFn,getImageURLFn}from"./options.js";window.joppInit=async(e=demoData)=>{const{pdfInfo:t,documentInfo:r,templateInfo:o={}}=e,{pages:n,width:a,height:i,margin:s}=t,p=n.filter((e=>"toc"===e.type)),c=n.filter((e=>"content"===e.type)),l=(p.length,c.length),d=document.documentElement;d.style.setProperty("--marginTop",s.top+"px"),d.style.setProperty("--marginRight",s.right+"px"),d.style.setProperty("--marginBottom",s.bottom+"px"),d.style.setProperty("--marginLeft",s.left+"px"),d.style.setProperty("--width",a+"px"),d.style.setProperty("--height",i+"px");const y=Object.assign({},defaultWatermarkOptions,getOptionsFn(),o.options),m=await getImageURLFn(y.id);document.querySelectorAll(".pages-container").forEach((e=>e.remove()));const g=document.querySelector(".template");g.style.display="none";const h=document.createElement("div");h.classList.add("pages-container");const u=new Date;let f=0;n.forEach(((e,t)=>{const o=g.cloneNode(!0);switch(o.style.removeProperty("display"),o.className="page-container",e.type){case"toc":o.innerHTML="",o.classList.add("toc-page-container"),h.append(o);break;case"content":{f++,o.classList.add("content-page-container");o.querySelector(".header .section").innerText=e?.section1||"";const t=o.querySelector(".footer .hostname a");t.innerText=r.hostname,t.href=r.url;o.querySelector(".footer .page-num").innerText=`${f}/${l}`;o.querySelector(".footer .date").innerText=u.toString();o.querySelector(".created-with").style.visibility=y.hideSaveDate?"hidden":"visible";o.querySelector(".header").style.visibility=y.hideHeader?"hidden":"visible";o.querySelector(".footer").style.visibility=y.hideFooter?"hidden":"visible",h.append(o);const n=o.querySelector(".image-watermark");n.style.setProperty("--watermarkSize",y.size+"px"),n.style.setProperty("--watermarkOpacity",y.opacity),n.style.setProperty("--watermarkAngle",y.angle+"deg"),n.style.setProperty("--watermarkX",y.x+"%"),n.style.setProperty("--watermarkY",y.y+"%"),n.src=m||"./jopp.svg";break}default:o.classList.add("other-page-container"),o.innerHTML="",h.append(o)}})),document.body.append(h)};const url=new URL(document.location.href),joppPreview=url.searchParams.get("joppPreview");joppPreview&&import("./preview/index.js");