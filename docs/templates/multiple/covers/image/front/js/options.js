import*as idbKey from"../../../../../libs/idb-keyval.js";const imageStore=idbKey.createStore("front-cover-image-store","image"),prefix="jopp://",createId=()=>prefix+Date.now();export const uploadImageFn=e=>{const t=document.createElement("input");t.setAttribute("type","file"),t.style.display="none",document.body.append(t),t.onchange=async()=>{const o=t.files[0],r=o.type;if(!/^image\//i.test(r))return void alert("Only image files can be uploaded.");const a=createId();(await idbKey.keys(imageStore)).length>20&&await idbKey.clear(imageStore),await idbKey.set(a,{file:o},imageStore),e(a)},t.click()};export const getImageURLFn=async(e="")=>{if(!e)return"";if(!e.startsWith(prefix))return e;const t=await idbKey.get(e,imageStore);if(t){return window.URL.createObjectURL(t.file)}return""};const STORAGEKEY="front-cover-image-storage-key";export const defaultImageOptions={id:"",url:"",title:"{{title}}",strokeTitle:!0,subtitle:"{{hostname}}",author:"{{author}}",color:"black"};export const saveOptionsFn=e=>{localStorage.setItem(STORAGEKEY,JSON.stringify(e))};export const getOptionsFn=()=>{const e=localStorage.getItem(STORAGEKEY)||"";try{return JSON.parse(e)}catch(e){return null}};